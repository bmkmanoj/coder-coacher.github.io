<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>JUnit 5: New Opportunities for Testing on the JVM | Coder Coacher - Coaching Coders</title><meta content="JUnit 5: New Opportunities for Testing on the JVM - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java/">Java</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>JUnit 5: New Opportunities for Testing on the JVM</b></h2><h5 class="post__date">2017-10-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/-mIrA5cVfZ4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so I think it's time to get the
show on the road
thanks for showing up when to load up
testing today's topic is of course Jane
at five and new opportunities were
testing on the JVM my name is Sam
Brannan I'm a spring and Java
consultants at a company called Swift
mine in Zurich Switzerland trainer coach
etc but a hard co-developer at heart
I've been a job developer for about
twenty years
course spring vagrant commuter since
2007 which when I originally I'm rewrote
Springs testing support of the whole
annotation based stuff support for
testing GJ and for etc and I've been a
core committer for j25 since October
2015 so Swift mine experts in spring and
Java you can find us online if you want
some consulting on how to use deign to
five better perhaps spring etc so the
agenda for us to talk about impetus for
change like why we did it
then I'll talk about Jane at five in
detail a little bit about spring five
and then time permitting Q&amp;amp;A though if
you're unhappy with the 45-minute format
as I've heard other speakers say then
feel free to complain it would be nice
if we had an hour unfortunately we got
to rush it through for 45 minutes but no
fear we have AB off tonight on Jane of
five so if they're more questions and
stuff like that if you want to see me
live code some more stuff here answers
more questions then please come to the
to the buff as well that would be great
so first up show of hands who writes
tests all right
who uses a J unit anyone okay anyone use
anything other than Janet yes
testing G maybe 2% a Spock something
like that a few more any kind of other
like scholar tests or anything else I
have no one guy okay so everyone Java
Java Jane it I didn't ask the Virgin
Jane it for I suppose right anyone still
using Jane at three oh you sorry sorry
Souls or so as well we've got we've got
you covered actually so why do we have a
new version of Jane it if your
experience with Jane it and you've tried
implement stuff on you and you might
know some of the reasons but just over
you for those who don't know
so Jane for was released over a decade
ago a lot has changed since then our
testing needs as the community have
mature
and our expectations have grown from we
expect from her framework so I often say
J dude is a horrible name because it has
the word unit baked into it and people
think it's only about unit testing but
obviously that's not the case anymore
right integration testing system testing
intends testing all sorts of stuff
another thing with Jana four terms of
modularity they're really um wasn't much
right kind of a big ball of mud there
was only the Janet jar right and disk on
test discovery and execution those
issues were tightly coupled
extensibility a lot of room for
improvement there and we hopefully have
achieved that and last but not least
let's not forget about modern versions
of the JVM right so we have Java 8 and
even Java 9 and of course Jana for only
theoretically supports Java 5 so to
speak in terms of the API so in Jana 4
there's this main concept of a
runner-runner api it's very powerful in
fact you can do anything can do name
with it but you can't combine runners so
for example if you ever try to use the
parameterize runner from jane unit and
the spring runner from spring it's a
no-go doesn't work right something in
the next slide we have here is a bit of
a joke so um you might think je given
for rules like super cool or you might
read it as rules are meant to be broken
and I would say for rules are meant to
be broken and in fact always were
unfortunately so in Jaden 47 there was
this method rule you can annotates up
with that rule and have that registered
then they came up with an idea for a
class level support with test drill and
Jana 4/9 you could have it at the kind
of like the method level or the class
level and that's great for simple use
cases they can even be combined which is
which is nice but it's single rule can't
to be used for both method level and
class level callbacks plus there's zero
support for what I call instance level
callbacks so case in point if you've
ever used the spring support with rules
I had to implement this as two rules
unfortunately so it's pretty ugly
boilerplate code you have to say you
want the spring class rule and the
spring method rule where you really just
want to say I just want spring right so
what happened how did this all come
about that we got to Jane to five first
we had a crowdfunding campaign called
Jane at lambda
people - listed here as one of the main
sponsors they're initiated by some some
German guys previous committers on Jane
at four joined by some other German guys
and and
yours truly we all happen to speak
German which is just kind of a
coincidence I don't know maybe it's just
because Germans like to test perhaps I
don't know and our latest committer is
also from Germany so yeah we need some
people from like the states in other
countries maybe anyway so this ran from
July to October 2015
raised a fair amount of money and for
companies located donated six weeks of
full-time developer time including a
pill - who also contributed more so
pivotal not just spring also supporting
the the June 5 initiative so if your
names up here or your company then thank
you very much for helping us get started
what that helps us do it helped us have
a kickoff meeting we have some big names
in the community developer from Gradle
Ellijay and clips as well as these core
committers coming together we started
off and kicked off J and 5 so first off
we had a prototype we did back released
in December 2015 then we had an alpha a
few months later and then huge big step
to the m1 couple milestones in between
over a course of a year couple releases
to Canada is I say 2 to 3 because the
first one was kind of snafu didn't
really exist so we really had to that
you could use and then 5 that Ogier so
hopefully you heard about that
September 10th 2017 and as of today a
few hours ago we released 501 so with a
few small bug fixes in case you're ready
on on 5 oh so that's where we are
chained to 5 in a nutshell it's modular
right so we have lots of modules you'll
see that it's very extensible and we
like to think it's modern right it silly
string in Java 8 and has some modern
features like land expressions and stuff
like that another really crucial thing
that we put a lot of consideration to is
is compatibility being both forward and
backward compatible at the same time so
what that means is that the junior
platform which I'll talk about in a
minute that supports on Jana 3/8 and and
at the same time as what we would call
Jana 5 or the new Jupiter programming
model in addition new testing frameworks
that are based on the platform can be
run with Jana port infrastructure so
that means you can use your old IDs and
your old bill tools if you want to but
we'll see we're getting support for
build tools and ideas along the way so
the way this is done with fuel every
chain of on a particular runner for the
platform
called Jane to platform so you just say
I run with Jane a platform you can run
that in an old version of Eclipse old
version NetBeans IntelliJ etc so in
terms of um version support obviously
job eight right otherwise it wouldn't be
modern that's the baseline right so it's
all compiled in Java 8 using lemon
expressions stuff like that but you
could of course use it to test the
application code compiled against the
previous version right a different
target version Java 9 version also
supported all right you might have seen
in keynote Mark had all those open
source projects in set up there and on
Jane of 5 is in fact one of them works
fine on JDK 9 and if each of the
artifacts has a stable automatic module
name our unit so you can already use it
on the module path if you choose to and
we'll support for scanning the module
path for your test classes and stuff
like that in 5.1 that's the plan so
right now we have class path scan and
support and we'll add module path and
skin and support as well so this this is
very key I'll say a few times there is
no spoon right ok there is no J unit 5
you can't say I have Jane at 4 and
change the version to 5 it's not going
to work because we actually rewrote
everything and we actually in the
process ended up inventing three kind of
projects together we didn't realize at
the start but after a while we realized
and split it up and we gave them names
so we have the Jaina platform released
at version 1.0 that's the foundation for
launching your testing framework on the
JVM and I say any testing framerate
doesn't mean it has to be in Java
doesn't mean it has to be from the JV
team
it could be Scala groovy Kotlin whatever
you can own so for that we have what are
known as the launcher and test engine
API is we have them built in a console
launcher built-in support for Gradle and
maven and then the next part is what you
might actually consider to be J unit 5
it's the new programming model and
extension model that you'll be using
mainly if you're you're focusing on on J
units right so this is called Jana
Jupiter a lot of people ask why Jupiter
what's the fifth planet from the Sun
Jupiter it happens to also start with J
you like J unit so that's kind of cool
too all right
you could say j-unit Jupiter if you want
to pronounce it like that okay so next
part we toss it on some ideas out legacy
um the people we thought may be filled
feel insulted so I said maybe maybe
retro when they decide the vintage is a
support for what came before and that
means we have a test engine that will
support running Jane III if you're so
unfortunate but also Jane at four at the
same time and actually we didn't aim to
support Jane you three just happens to
be the Jane at four supports two three
so we couldn't not support any three in
that regard so so it is and then some
some points here very important so the
first part is is revolutionary right
this is never really existed before the
platform really is a new platform to
write any kind of testing framework that
runs on the JVM and everyone can benefit
from that you can put in testing framers
and stuff the next one is evolutionary
right so there was genuine for and now
there's this Jane at Jupiter kind of
Jane to five but similar program models
just just kind of evolutionary and the
last part I would say is necessary just
to support existing uh testing code
bases so this launcher API like Jane at
core and Jane Fortran or that it's used
by IDs and tools to launch the framework
so you wouldn't probably use it yourself
but you could if you wanted to play
around with it and it's essential API
for discovering and executing tests via
one or more registered test engines and
for that there's what's known as a
launcher discovery request has support
for what we call selectors and filters
selectors you can select things like
select this uh from the class path this
class path routes you can select
packages to scan you can select tests
classes for example you can also select
individual test methods these kind of
things and filtering you can filter
based on like um test engine IDs or
filter based on class names like that
you know like a pattern for the class or
tags and stuff like that so a lot
Beacher's actually aren't supported ed
in the IDE but we think that will come
with time terms of getting feedback if
you want to have your own tie into the
reporting infrastructure you could
implement a text execution listener and
get get feedback on all the events that
are occurring as the test plan execute
and then again this console launcher
allows you to actually run on the test
suite from the console if you wanted to
or run it from a Java main or something
else like that
so test engine API you might consider
this someone analogous to the runner API
from Jane for accepted the test engine
API is generic and not limited to Java
per se so a test engine discovers and
executes tests key here for a particular
programming model and these things can
be automatically registered with the
Java service layer mechanism so as long
as they have the right information there
in the jar and they're on the class path
and they get automatically registered
which is cool right and for Jana Jupiter
we have a Jupiter test engine then to
vintage we have one as well and you can
implement your own which people have
actually done so this is taken straight
from this page we have a wiki page we
allow people to publish their posts
third-party extensions they've written
for the giant platform or Gianna Jupiter
and we can see at least five that I know
of existing test engines outside of the
two I mentioned that come from the giant
team itself so for example like this
specs one at the top some guy grid is on
a little testing framework based on
closures and stuff like that and it
works in Scala Java and groovy the spec
one is for Kotlin and yep you can check
out the others if you want as well so
here's the the big picture because
people like big pictures right so here
we have the platform in the middle right
and some inter for the IDs and build
tools we use that and what you do you're
up at the top you're gonna writing your
old test change of core stuff like that
it will use the vintage infrastructure
if you're using Jaina Jupiter we using
that infrastructure or one of these
third-party test engines like I mention
on the previous slide or if you write
your own and then everything else is the
platform the middle so if you look
behind the scenes there we'll see the
old test is just using JUnit 4 12 right
and we have this Jane at vintage engine
that knows how to adapt from Jane at 4
to the platform test engine API and then
we have the new stuff the Jupiter API
that's what you code against and the
engine is what supports it and then
every other third-party would have their
own API in their own engine invitation
as well and then and then internally
right so the IDs they're gonna work with
this this launcher and we have different
things that run that so that runner I've
talked about for Jana for that's in
there we got the Surefire support the
Gradle support and the console launcher
all talking to the same API so this is
what I'm saying that it's new
opportunities for the JVM and we talked
about Jane at 5 if we would focus on
that right that's just just this little
green part
up here and everything else is more like
the platform right and anyone else can
implement their own stuff so that's why
I say it's a it's a game changer
so terms of ID and build support
IntelliJ has been supporting us for
quite a long time so as I mentioned we
had one of the core developers that came
to our kickoff meeting and we've been
communicating with her ever since then
so ever since idea 2016 2 and above
they've had support and they have
support for a ga recently as well
Eclipse joined the game a little bit
later but they have actually very good
support eclipse auction 4.7 that one a
is supposed to be released next week on
the 11th I think or something like that
and it's actually I'm using the release
candidate one for that in the demos
today
NetBeans I think the the monkeys tell
the story I'll leave it at that
Gradle we have an interim solution from
the data team we've written ourselves we
are not experts in Gradle or in writing
Gradle plugins we wrote one and it works
and we use it ourselves and the Gradle
team is going to be taking that over
time permitting hopefully by the end of
this year they've claimed recently on
issue tracker
there's also third-party support for
Android the nice gentleman from the
community has written so you can check
that out if you need to work with Jane
at 5:00 and Android maven we also have
an interim solution there that we've
used an implanted and that's currently
being taken over by the maven a surefire
team so we donated the code that we have
in there take forward from there that's
the idea and we have no ant support we
have an open issue grabs if you want to
implement it feel free in terms of how
to set the stuff up I'm not going to
time to show it today so if you want to
see how just take out the user guide for
documentation we also some sample sample
apps that show you how to get Gradle and
maven up and running with the platform
itself and with Jana Jupiter or with
Jana advantage as well so now we're
going to jump into Jana I'm gonna give
you an overview of the extension model
and if you have more questions we can
talk about that during the Boff tonight
so we have an extension that's marker
interface it word Jane at Jupiter API
extension packages are different from we
had in Jane at Fort Wright so there are
any conflicts that was also a design
decision there and yep limit as many as
you like right so I said you couldn't
combine rules
or you couldn't have a class level than
a method level rule Jana 4 and Jana
Jupiter you can combine them as you wish
and the way you register one of those
instead of run with in j2 40s at extend
with and they specify one or more who
sent you to be registered at the class
level method level or the first we're
there even on interfaces right so that's
kind of cool
even on interface default methods and
stuff like that as well so or right ok
who's ever used spring anyone yep and
you know meta annotation support cool
annotation support so in Jana five I put
really hard to convince the team that so
we support
it's a meta annotation this working
about anything am i doing something
wrong
no flailing I'll stop flailing extension
API is so here we have before all before
each we have befores and afters for
various levels so all is a class level
that we like before class before each
would be like kind of before in Gen 4
and before test execution this is
immediately before the test methods
executed or mealy afterwards and these
are what's known as lifecycle callbacks
but these are the extensions right so
the extensions map on to the user
extension points as well beyond that we
have something comes kinda in the middle
there right after the methods executed
there is a test execution exception
handler which allows you to handle
exceptions if you wanted to implement
something like an expected ception or
logging exceptions and stuff like that
another thing we have it's called
execution condition talk about more in
detail in a bit test instance post
processor and parameter resolver very
cool and this is the support for
dependency injection in j-unit Jupiter
so much better than what we had in Jade
for and the last one a bit more complex
we have a test template invocation
context provider and that's we're doing
cool stuff like repeated test
parametrize test test matrices and stuff
like that so now the programming model
what you'll use the most all these
things are located in the org Jane
Jupiter API package so they're not in
org Jane it right don't get confused and
pick the wrong test annotation and if
you're using the parameter support
that's in a prams package if using the
jane to for Migration support we'll see
you later that's also in a different
pack but most of the stuff is in this
api package so roll
feature-set we support annotations and
swear there was a net annotations we
have assertions and assumptions custom
display names visibility not everything
has to be public anymore so you can type
plus we have built-in support for
tagging conditional test execution
dependency injection both for
constructors and methods we support
lambda expressions and methods in
various places for example in assertions
and stuff like that we allow you to use
the fault methods job eight things like
that new nested tests class support and
then also repeated tests permanence
chests and dynamic tests so in terms of
annotations these are the main ones at
test we couldn't come up with a better
name so we left it the same for dynamic
tests we we have test factory and in
gray here is that testable so if you're
writing a test engine you would actually
want to use that annotation
next up variations of tests so we have
repeated tests and parameterize tests
and these are specializations or what's
known as a test template as I mentioned
previously before nested tests classes
at tes instance so I'm going to make a
statement and you can see who actually
knows this
so in JUnit one through four Jane it
always reinstates your test class
between every test method who knew that
so maybe 10% right and intestine G its
exact opposite it keeps your testing
since the entire time so I've often been
a fan of the weight testing G does it
and I had this in the prototype and then
got voted out but I got it voted back in
and reimplemented it for TA
so in Janet Jupiter you can pick the
model you want you can say I want to
have pistons as per class or per method
and one of the reasons that I was able
to convince the team is because it's
actually pre good cause it for
supporting things like scenario tests
which we want to support in a later
release so we have before all after all
that's like before class and after class
before each and after each that's like
before and after display name
that's where customs play name tags that
kind of replaces categories in Jana for
and now disabled replaces at ignore
people say why didn't you keep it well
it'll make more sense when I talk about
the execution stuff in a bit but
basically I couldn't come up with an
opposite of ignore because we do not
ignore it is not ignored and it makes
more sense to say a test is either
enabled or disabled and that comes
through and the API will see later on so
if you want to migrate we have some
experimental limited support for a
few of the rule types with Janet for you
can this is kind of like spring boot but
it's not at a naval rural migration
support so if you annotated class with
that you get three extensions on the fly
external resource support which is
support for like temporary folder and
chain for a verifier support things like
air collectors in giant for and expected
exception support for well expected
exception right so you can actually use
these kind of rules with Jane and
Jupiter because they map on to the UM
the new extension API do we have yes and
there wasn't mind a bug but it got
released and fixed today and five and
one so assertions yet we have a limited
corset I copied some of the basics from
Jane at 4 and then we rework some stuff
and expanded everything so we still got
stuff like the sword equals of certain
unknown etcetera but every time you see
a green lambda can is that even green I
don't know these are the laminate things
that means you can use a lambda
expression or a method reference with J
and Jupiter so assert throws is the cool
new way to do expect exceptions assert
timeout and assert panel timeout
preemptively there's to assert timeouts
like you might have timeout rule
previously the difference is timeout
will execute in the same thread and then
stop after the test stops and tell you
whether or not it finished in time the
third time on primitive you will run
your code and a new thread and they'll
kill it early preemptively right if it
needs to I note on that is uh if using
something like a framework like spring
that has transactional support where the
transaction context is tied to a thread
local for the current thread and you say
excerpt timeout primitively then Springs
transaction support would be broken and
if you have other frameworks doing
similar stuff you just need to keep that
in mind so again time on potentially
will end faster but it might break your
other framework code using I start all
this is what's known as inter assertions
or grouped assertions or something like
what are they called
soft assertions and sha right so you can
combine a bunch bunch together with end
expressions and then Jana will report
back all the failures instead of having
to rerun those tests another thing to
point out is um the mess at the end now
so your message for why it failed since
this should be an optional parameter
comes it in in addition you can supply
your failure message as a supplier of
string with the lambda expression which
means that if it takes a long time to
compute it or maybe a long time but
there's no
to generate error messages if the
surgeons don't fail right so that's why
we did that and if you want more power
we're not forcing you to use our
assertions if you don't want them feel
free to use a sergej hamcrest truth
whatever right as long as those things
you're throwing assertion areas it's
gonna work fine with Jane and Jupiter
and with the platform as well so
assumptions has anyone ever used those
in Jena for a few people right so you
can say I assume this to be true and
otherwise don't execute the rest of the
test so we have a limited set of those
taking over from J and 4 and that's for
aborting the test mid-flight it means
the test already started right the test
method is executing but you can say I
check something in whoops I don't want
to continue and it won't market has
failed I'll just say that it was skipped
otherwise if you want to actually skip
it the whole thing I'm not even started
then you could implement your own
execution condition as we'll talk about
later on so we have stuff like assumed
true assumed false to take boolean or
boolean suppliers suppliers the strings
for the messages etc and we have another
thing called assuming that it's kind of
a glorified if if you have an assumption
that passes the next few this code
otherwise don't and continue on with the
execution of the test method so this is
where I hope the demo gods are with me
all right all right so we have a
wonderful calculator class it adds some
tracks multiplies divides and calculates
Fibonacci Fibonacci could take a while
hint maybe time outs you could divide by
0 here right so you could have some kind
of errors the font
basic text font edit 24 is gonna be huge
it knit so better yep okay cool
and yeah we have some cats people and
stringy tools for calculating
palindromes so we have a test based on
Janet for the instantiates the
calculated substantive test uses the
expected exception rule and the time
mount rule from JUnit 4 has some
assertions I hope these are the right
ones yep they're all from Jane it for
assert and then for exception testing
right so it starts off saying none for
the expected exception and then for this
particular case divided by zero says
what it type it expects in the message
and then does the thing that's supposed
to blow up and for timeouts absence I've
commented out here so you could have
done the old-school way like that where
you gonna done it with the global
timeout milliseconds a thousand so one
second and then you execute the thing
and see if it blows up so let's just run
this test and see if it runs it does
that's not too exciting what if we were
to pick something bigger like that right
42 then that should hopefully blow up it
does and it gives us some kind of error
something like test timed out after
thousand milliseconds so in January that
does it preemptively there's no non
pre-emptive mode for timeouts in jenefor
and for the exception if we expected or
if we didn't
and run that one then that would blow up
with the exception right so it through
the exception and now what we want to do
is you want to see how we can achieve
the same stuff in Jane at five so this
is where the demo gods really might not
be with me we'll give it a shot I'm
gonna even typed the view big pide or
okay so now we have a new class right
and what we're gonna do we're gonna say
get rid of the J and for stuff except
the rules we'll leave those those there
for a second alright so now it's
complaining I'm gonna pick the test API
annotation from J and Jupiter right
I said things don't have to be public
she'll be able to delete all that clean
it up a little bit
no the assertions aren't there let me
pick one of those from the right package
is that the right one it did from a
junior API surgeons so right now we've
just converted the AHA so why is this
failing anyone paying attention
the message is at the beginning that's
what I'm saying right no longer at the
beginning so he put them at the end you
do it like that and if this were some
kind of complex thing and you wanted to
build it up well that's easy just make
it a supplier like that so use a lambda
expression and that works nicely so if
we run this now what you're going to do
that's divided by zero failed right we
expected that to happen and I mentioned
there's this rural migration support
which supports the expected exception so
if I run it again now it's still divided
by zero let's see what's going on here
2905 a neighborhood migration you know
expect exception none it should be in
here right here with this expected
exception support let me give that a
shot gun this is running right space
right to particular party oh that might
have yes it's nice to have a an audience
paying attention
thank you very much see that that crowd
Juna for why does everything have to be
public yes so that's that's right but
let's get rid of that right we don't we
don't want to do that we're on a really
migrate so now this thing doesn't exist
this is the air as well let you start
like this assert throws and the type is
that one and the thing we want to
execute is this so how do we surprise
named expression like that alright so
far so good
if you run it now and save then that
works alright and what if we haven't
checked the message well that's not too
difficult equals a lot equals expected
who thinks that's going to work yep that
works so this is how you do expected
exceptions now in Jayne at 5 J and
Jupiter and the last part to get rid of
is this this timeout thing so it was 42
when it ended up being longer than we
wanted and the timeouts not supported
this in any way so we can just delete
this and now if we run this this should
uh well it'll take a little bit of time
and we'll see how long it takes took
over a second right so you want to make
sure that it doesn't take over a second
right and the way we do that is timeout
of Millie's for example a thousand
so who thinks that's going to work it's
going to say people can read this it
says execution see the time out of 1,000
milliseconds by 390 so that was the
non-preemptive one it let it run you can
see the whole the entire running time
and what if we wanted to finish that we
do that preemptively we could just say
print of Lee and then we'll stop
immediately after a second and give us
an error similar to what we saw in
jigging it for right so execution time
dot after 1000 milliseconds so that was
instantaneous and by by the way if
you're wanting what this is this is just
Java time duration of milliseconds of
seconds and stuff like that so nice
little kind of linear path yep if you do
oh you mean do we kill it properly maybe
it attempts to it it might not do it in
all cases if it's a really kind of
rampant kind of thing we'll use an
executor service and we we do get the
question was if it's going to run on
forever with the preemptively one of the
non one the non one no it will it will
keep running it will run ever forever
yes so if you know that it's something
so if you want to time it you know it's
going to finish you just want to make
sure it's not taking too long then you
could use a normal time on if you wanna
make sure that it's it might have some
kind of infinite loop whatever you want
to avoid that and kill it off you want
to do it preemptively but again the
point there is you have to know if your
other framework code like spring or
something he's using thread locals then
that wouldn't work so you'd have to
figure out something but that's that's a
threading issue you have to to deal with
anyway so I think that's it for the the
basics on that okay all right so tagging
mm-hmm we've been going right so we have
an out tagging tation you can clear on
interface class or method something like
this add tag fast on a test method my
fast test and by default all the tags
are enabled so it doesn't actually have
any
any input or any impact on the running
test plan you'd have to actually specify
to include tags or explicitly exclude
tags otherwise the tags or are ignored
so you can come up with custom tags
because we support mid annotations right
just declare add tag adds a meta
annotation so meta annotation means
annotation declared on top of another
annotation in the source code so here we
have our own annotation named fast and
it is annotated with that tag fast and
it can be used on methods and it's
retained at runtime so then we could
rewrite the previous slide like this
fast test and you agreed reuse the fast
tag across your codebase if you want to
go one step further you can compose tags
a very cool feature very popular in
spring and now possible with with j-unit
so you can Eclair tag is meditation with
other annotations they could be other
annotations from Jaina or as I do in the
spring testing sport I combined spring
annotations and Jade annotations to
really simplify the configuration so
here we see a combination of tag fast
and test from Jane and Jupiter and this
is a fast test so we can just rewrite
that last one as at fast test and you
might have integration test smoke tests
different kind of things like that and
again you can also combine this with
spring support for transactional SQL
scripts and stuff like that so pretty
powerful stuff test names so by default
defaults to the class name or the method
name is you're familiar with with things
like testing G&amp;amp;J and it for etc so the
characters not limited on the Java
syntax but we have at display name and J
and Jupiter laws you have a custom
display name can contain spaces special
characters and even emoji yes so some
guy complained on the internet and the
Twittersphere that it was stupid that we
have support from oh geez and I had to
say well we didn't actually aim to
support support emojis we wanted to
support the first two special characters
and spaces and stuff like that and then
one day I was like when if we can
actually use an emoji in there that's a
character right and it works we didn't
aim to but it works I'll show you so
anyway
dependency injection this is where the
extension model meets the programming
model also like to say so we have a
parameter resolver extension API this is
somewhat analogous to spring MVC support
for argument resolvers and stuff like
that resolves a parameter as you might
guess either for a constructor or a
method
and not just for test methods and
lifecycle methods but also yeah for
constructors so you can register
multiple simultaneously they compete but
only one wins because ask you if they
support it and use cases stuff like
injecting a server URL a data source if
you have connection to a database a
spring application context to example
stuff like that so or mocs has another
another popular one test invoke this out
of the box you can inject this into
constructor test before each etc from J
and Jupiter gives you access to the
display name tags class meth and stuff
like that we have our own parameters all
were registered automatically behind the
scenes that's what we say eating our own
dog food that was actually a design
principle we had for the whole the whole
Jane 2:5 effort is that if we have an
extension point or something we want to
implement then we create an essential
point for it we have to bend it lift
that and other people can also implement
the same extension point so see also for
using your PT test you can use on have
repetition info injected you can have a
test reporter injected to create some
additional test reporting information
the maketo extension is something we've
implemented as a sample and Makua teams
taken over I wrote the spring extension
and that's been released in spring 5
we'll see that that later on so next up
live coding tags display names in a pin
see injection what do we have here so I
have a junior 5 tests you know I'd like
to make this a test it's a test
I would like to tag it with fast now
it's a fast test
licky call this slow or normal or
doesn't really matter so now if I just
run this they're both going to run two
tests one normally fast that's because
we didn't specify any tags right I said
by default everything's included so if
in Eclipse I go to the run
configurations and arguments Eclipse
four seven one eight that's support for
this you can say include tag fast like
that and run and then we should see ha
ha now it only ran one test which was in
fact the fast test right so you can come
do this within Eclipse I'm not sure if
you can get IntelliJ yet so you can do
this from your your Gradle build and
from your maven build and also with the
console launcher so that stuff works
like that
now again I mentioned you might want to
create something like fast test I've
already written it for you here's this
has tag tag ves fast and tests can be
used on methods retaining runtime so I
should be able to replace that get rid
of that
rerun the tests and we see that again
that one was actually run the fast test
so this is this cool custom annotation
combining tag and test and I mentioned
you can also get information like the
dependency injection so you can say I'd
like that please give it to me and just
for fun I'll just print it out all right
so what kind of nope small team right so
now if we run that lets you see some
stuff the console we see the display
name was this fast test tags yep that's
there this is the class that we're
running in here's the test method that
we were in right so we get his kind
information but the display name was
what was that it was the name of the
method with the parameter list so what
if we wanted to have something custom
display name fast tests with some
special characters now we see that's
included here in the information but
also more importantly here fast test
so right see that fast test yes cool and
now this is where I have to go back and
copy from somewhere you cannot type
emoji in Eclipse I don't know why but
you can copy and paste them in so what's
gonna happen now this is where I get the
biggest applause I guarantee it
there it's in the reporting whoo-hoo but
you didn't even see it in the display
yet okay now that's the cool part Oh yep
there it is and if we were to run it
from the command line nope what am i
doing
where am i this is not the fun I had
before I have a Gradle build with the
plug-in it's gonna output a tree of the
results in theory there it was and Wow
so very very cool stuff there okay
that's what you all came for emoji so
yeah you're welcome
oh no I hit that favor the wrong place
somewhere oh my goodness
pretty good okay we saw that stuff all
right moving on I got to go fast now so
if you have more questions and stuff
we'll covered it in the buff tonight so
conditional test execution heights this
is a game-changer right this is inspired
by like the fact there was ignoring Jada
for and then on spring we had support
for if profile value and spring out
support for things like conditions and
profiles and stuff like that so that'd
be really cool without also exists in
Janet we have an execution addition
condition without you can implement at
disable is the first one I implemented
for that and there's a disabled
condition that actually supports that
you can check out the code for it and
like I said this is a game changer
because it's not only something we do
and Jana you can write your own and
people do and I really think that's
gonna be a very popular feature so why
might you want to do that you might want
to do it based on the current OS with a
current Java version or the current day
or something like that different
different ideas system property
environment variable these kind of
things you can just write your own
conditions and then share that across
your codebase and there will be some
other projects that are implementing
stuff like that I've done some cool
support and spring for that as well
so you can deactivate these things if
you want to see maybe maybe our tests
are still working or working now that
we're disabled maybe they were broken
maybe they work now you can disable that
by saying June conditions to activate
and the name of the condition where the
package and a pattern is so like that so
you mix this here run all the tests that
maybe we're broken before cool features
like that so next up default methods
mm-hmm so eight right introduce the
concept of test interface basically an
NJ and Jupiter so you can have basically
multiple inheritance and tests aka
testing traits you can use bunch of the
annotations in on default methods like
before all in after all but caveat here
only if you're using this at test
instance lifecycle per class otherwise
those methods have to be static before
each after each test these different
variations tags extend with all this
kind of stuff can be included in those
test interfaces so to speak so we have
one I'll quickly show you string tests
if I were to run that there are no test
methods here do you see any tests no but
it has tests so where do they come from
well we can double click they come from
default methods and interfaces so here
we have a comfortable contract and
equals contract and stuff like that so
you can have reusable contracts or
testing traits and implement them
implement them in your test classes
that's kind of the point there okay next
up Nessun test classes so in j and
afford there are two runners than you
know of custom runners in the world that
allowed support for this basically
enables on logical hierarchical grouping
of your test classes with sheridan's
initialization state from outer
instances and you do this without
clearing that nested on a non-static
nested class also known as an inner
class right and you can even combine on
nested classes and in test interfaces we
can see the testing a stack example
which is a cool one in the user guide as
well testing a stock demo so if we look
in here we see it makes use of um
display name and it has this nested
class class here right and then it has
its own tests in there and then wait oh
there's even more nesting so what is
this going to look like when we run it
it's kind of a BDD style right so now if
I look on this expand all and zoom in
then we see cool stuff like that right
so you have the very various levels
there the various test methods and the
classes and with use of that display
name you can have custom names having
more kind of BDD style so that's a cool
new feature as well
okay repeated tests you just say at
repeated tests specify the number you
can have the repetition info injected if
you want override the custom display now
if you want it would look something like
this I repeat it has five do it five
times you can even change the name as I
mentioned so if your here's an example
in German if you wanted to change it to
say instead of repetition one of two you
could say Peter Hold'em eins quince why
if you speak German something like that
so different languages change stuff like
that priming our chests much better than
what we had in Jay at four so you just
use a parametrized test instead of test
specify the source of arguments sources
we have lots of things there check out
the user guide for that so we have value
source for just straight values strings
etc enum source for getting enum
constants method source so you can
actually delegate to a method static
method that serves as a factory for your
arguments also support for CSV inline in
the annotation also from the file system
or you can have our argument source and
clincher and custom arguments provider
so for conversion implicit conversion
for most basic types genomes Java x
stuff like that you can also have
explicit conversion if you implement
these API is here premier HSN actually
would look something like this so add
parameterize test value source list of
strings here an array so these things
are palindromes read them forward and
backward they work and this test passes
it's in the example code which I can
show more tonight or you can check out
online I have a link later so dynamic
tests this is a normally static write
known at compile time with that test but
a dynamic test is registered at runtime
with a lambda expression an attendent
method with that test Factory and we
have some different ways to do that so
basically as you say is at test Factory
and you return a stream of a dynamic
test or a collection list something like
that and then you just create to your
stream you build it all up dynamically
however you want to programmatically
conditionally etc here we're saying
first ten even integers so start with
zero n equals n plus two get the first
ten take each number and create a
dynamic test out of that so that's a
static factory from the dynamic test
class and we're giving it a name so test
in that be tested zero blah blah blah
and then assert true performance urgent
so you can do super dynamic stuff you
can also have containers and si
containers as well if you want
so I will probably demo that tonight
what's missing scenario tests we like to
bring that in and one of the future
releases ordering you can't currently
order the test methods or stuff like
that knows no support yet for parallel
execution within the framework itself
there might be support for example in
and may even surefire but that's outside
the platform execution and user-defined
thread maybe for GUI based stuff we
don't have that in yet and declared of
test suites for the Jaina platform we
have the support for test Suites using
the Jain it for platform runner if you
want to do that but not for the platform
itself
that's a generic way and as I mentioned
before it's a Java 9 module path
scanning we'll be adding in soon as well
so I'm gonna just briefly talk about
this their support in spring since
Spring Framework 500 released when who
knows the back of that guy I'm sure he
knows last week right
so supports all the core testing
integration support in spring plus
support for dependency injection for
constructors and methods also super cool
conditional test execution via spell
expressions so dynamic load expressions
also works with spring for just a
project in my github repository if you
want to try out Jaina 5 on spring 4 and
you're not on on spring 5 yet so there's
a spring extension for that
simplification with med annotations
spring Jane and config and spring Jane
it web.config and then these enabled if
and disabled if annotations so I will
have to show those during the buff I
think I just want to point out as well
spring boot also works with Jane at 5 so
you just say at spring be test and
extend with the spring annotation so we
have an example here
please use Jane and Jupiter with spring
and you spring boot test other stuff
from spring boot stuff from spring
create a custom annotation and then I
can use it super short like this this
comes from an example app I have all
that configuration one annotation my
events controller tests custom display
name auto wiring in the mock MVC that's
automatically created by spring boot and
then using spring mocking me see for
testing so in closing lots information
on the web start off at JDI org check
out the user guide check out the
reference manual
Javadoc etc feedback get ur github Stack
Overflow spring resources
as I mentioned please come tonight to
the Boff and there's also another talk
tomorrow more about extensibility and
this is the demo so that was that was it
for the roving tour I'll be out
afterwards for questions and also at the
off tonight so thanks for coming</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>