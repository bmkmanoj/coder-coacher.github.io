<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>All the Nodes That Are Fit to Print (Part 2) | Coder Coacher - Coaching Coders</title><meta content="All the Nodes That Are Fit to Print (Part 2) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java/">Java</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>All the Nodes That Are Fit to Print (Part 2)</b></h2><h5 class="post__date">2013-09-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/-fEOt7L0v-8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay okay we're back after a technical
interruption not quite sure where we
left off but I'll start at the top of
this slide and just quickly recap the
next design goal was to enable
enterprise printing which in many cases
means server-side UI less printing right
so printing of images and and sorry Oh
operating on images and printing or two
things that actually very commonly
happen in server-side applications which
have no no UI they're just literally
running on a server in the data center
somewhere except you know maybe they
then and then they spit something out to
a printer or in the case of Imaging's or
something they spit it out over the
network or into a database but you know
so there's graphics stuff going on on
servers and in order to be able to
control that properly as as a
server-side application to be able to
direct the output to the correct printer
for this report or whatever you need to
have some API so you can't just rely on
a user dialog so although our FX doesn't
have that right now you know eventually
it will then should should and will ok
so but you know enterprise's often want
big reporting packages so this is just a
good point to say you know our
architects would like us to not kind of
go out in that space and do too much of
that in the core platform so you know I
mean we've learned that in you know in
the Java space thrilled you know there
are great reporting packages out there
and you know somebody will eventually
fill that gap
other goals so there's some sort of
technical issues coming as a surface
here we want to be able to print the
content that's on on the screen as well
as off the screen by which I mean you
know often you want to be able to print
exactly what's there you've got some
chart or some table or whatever and you
want to be able to just tell it to print
you know that that that tableview elven
in other cases you know what you really
want to do is just sort of have a you
don't want to print exactly what's on
the screen and this is actually in some
ways much more common you want to be
able to format the output correctly for
the printer right so most report
printing and so forth what actually ends
up when the printer was never actually
anything that was on the screen right
it's formatted differently and you know
maybe it doesn't use the same colors and
so forth and doesn't have all the same
stuff in FX as well there are you know
pretty strict threading requirements as
well about what you can do on different
threads so you know there are some
challenges in making all of that work
but the goal is that you know as much as
possible you know we want to make it
easy for the developer right so if you
want to you know if you want to print
something that's on the screen we'll
we'll make it work we'll we'll print it
out for you and if you want to create
printer some node hierarchy that you
never actually display and you never
attach to a scene and a display in a
stage will will do that for you too and
you know we'll run it if you if you are
on the FX application thread you know
you know and you tried to do something
like that's where you display user
dialogue or something like that or
anything like that we'll try to or
you're trying to print pages on there
we'll try to actually schedule that
somewhere else and not block for you and
also since printing is a pretty long
lived kind of thing right there is you
know no requirement you know that you do
stuff on the UI thread right you can
create your you can create nodes and
actually call print and something like
that on any thread that you want right
now there are you know as I was doing
this throughout there are a number of
implementation bugs and deficiencies in
the scene graph right that that seems to
manifest as layout not working quite
correctly and that certain things have
to happen
on a on the FX application thread even
though you're not attached to a to to a
scene or else you get some exception
which you should really not have got oh
that layout or something doesn't apply
correctly so you know try and work
around those you know even if you right
now even if you sort of print on on you
know your own you sport you know it's
more some worker thread you try to print
if to work around those you should be
able to do all of that I'm not thread
where we find that it's necessary we'll
just sort of you know have things that
need to run on the on the FX thread run
on that thread for you try to make it
all as transparent as possible and you
know keep the API simple and use FX
properties which is sort of something
that's pretty common through the API so
what are the sort of key parts of a
printing API anything about it this way
well you want to UM you want to be able
to at least if you're doing server-side
printing right you certainly want to be
able to find all the printers because
you may want to select from them and
choose the one that's most appropriate
and actually this is all can equally
apply if you're doing GUI in a user
doing a user interface where you may
want to sort of pick you know you you
you you want to also look through the
printers and just make sure that you
know the printer that they start with as
a color printing on a black and white
printer or something like that you got
to create creates something you know
that encapsulates the notion of the the
printing job you've got to be able to
configure that and the way that you want
based on the capabilities of the printer
and you potentially want to be able to
control and monitor that job you want to
be able to configure you know the page
on which the user prints and then sorry
the implement a PII prints and you want
to be able to have you on something
which actually will handle the rendering
of a node or a node hierarchy ie seeing
graph so these are the the concepts here
talk about these or concretely okay so
at an API level everything's just in one
simple package JavaFX print so it's not
a very complicated API at all tool to
learn but you know when you sort of look
at you know look at it you know he can
go what's important here well there if
there are five important classes and
I'll go through each of these and then
there are some other interesting classes
as well
most of these are you know sort of
printing configuration or attributes or
settings and I'll go through those two
puts the list I won't bore you with it
okay so the printer job class is the is
the one you want to really look at first
if you just want to you know get started
with printing all you've got to do is go
find job effects print printer job it
has everything you need to print the
most basic kind of job it has method
methods to display that you know any of
the user dialog so you want to let the
user have a go at configuring the page
setup or configuring the which printer
to use and stuff like that and you know
it has the methods you need to initiate
printing and pretty much it's all you
really need to know about in the most
simple case yes I mean I think a
moderate number of you know printing
applications could get by with just that
class this there's a couple of other
things you do need to do really but
that's the key one so what does it look
like well it's actually really really
simple I mean this you cannot get much
simpler than this there's a static
method you just create a printer job you
print your node this is enough to be a
single node say right this is could be a
group or something else some node
hierarchy which basically represents an
entire scene graph which basically then
is drawn to the page and so the concept
is that essentially each page is like a
scene graph right and then you call em
job of course you know it's um that was
sort of assuming everything worked
really if you're writing production code
it would look more like that so the the
static factory method could return null
if you're on a system with didn't have
any printers installed so you should
check from that if for some obscure
reason there was an error occurred while
you were printing a particular page we'd
return
you know false from that method and you
could say oops problem Bale and then
when we you're finally done with the job
we also returned the statuses of what
happened when we actually pushed it to
the to the schooling system so it's very
simple right you know you you've just
got to just check that succeed that
succeed that succeed okay so there you
know I hadn't actually um done anything
there to to bring the user into the
picture in the previous slides it didn't
ask them the user saw nothing it just
something just came out on the printer
right but if you want to bring the user
into the picture
very simply you call show print dialog
method and the null parameter there is
just is though is a window which is
meant to be the owner of the dialog such
that you know you you will block input
to that window so it's what you want to
be modal with respect to and that me you
know that will it also should not go
behind and so forth so you should not be
able to lose your your print dialog
behind your application there's a
companion method which I'll show here
called show page setup dialog and so
these are pretty typical on you know
most platforms right I mean and map well
to what's there
yes that that what were you
if we oh the idea is that if it returns
false that's basically the user cancel
the dialog is that we meant oh yes it
does oh oh I'm sorry thank you yeah you
know what I guess I said that in and
didn't yes thank you I will fix that
well I disclaimer I mean you know I've
tried to make this as thorough as
possible but I haven't actually reviewed
these slides with anyone else yet so so
you guys okay oh yeah so okay then
there's the printer class so you know
very simply this represents you know
what's that usually the printer you see
in your menu or it could represent
something that some kind of print
service depending on how anything that
the platform basically wants to connect
exposed to us as if it's a printer will
appear you know in our list of printers
so for example I mean you know and in
you know it's a standard thing on on
Windows Vista and 7 you have this
Microsoft document writer which puts
their XPS sort of PDF competitive format
and it's always always there on the
print menu you know we we will when you
ask us what are the printers we'll list
that just like the API does with
anything else to us it looks like a
printer you know why would we do
anything else so the printer class
basically has two somewhat interesting
methods you can get the default printer
and you can get
all the printers on the system and this
is an observable set which might you
know in wonder why well you know
theoretically right somebody could add a
new printer while you were running the
application so it can change and so so
means theoretically the values of these
both both the values of both of these
methods can change from time to time
unlikely realistically but possible
printer attributes so this describes the
needles from water the different
capabilities of a printer and you know
for each of the attributes we generally
will have a value that says what is the
default or initial value of a method
which is what's the default or initial
value on a method which says what are
the possible supported values so you
know when a concrete example would be
that very typically the default paper
size and you know printers here in the
US is is letter right
but you know most printers support like
10 15 20 different you know so you could
get all of them and these are of course
sort of this whole thing is read-only so
so this this pretty much just has
getting methods there's no property or
anything like that to listen to or
anything this this is basically static
now as a general comment printer
attributes not everything is visible
even to platform you API so you know you
can you know if you go into you know you
know a Windows dialog and then you bring
up printer dialog and then you bring up
the printer properties sheet and you
kind of go down and you select some
option and you know you may I know
whatever it is something to do with you
know column you know color quality or
something depending on how they express
it but you know there there are a ton of
possibility
and they aren't necessarily even
expressed through API right all that
happens on say on Windows is there's a
completely opaque data structure which
lives within which is managed by the
printer driver and nothing to do with
API windows doesn't know what's in there
it's just between you know HP just
entirely within the context of the HP
driver or whatever else our Canon driver
so you know what we're exposing in the
printer attributes class is basically
the most common things that you can
usually depend upon and that most
applications will want but you know more
could be added I mean it's possible you
know you know this is probably more
target what we've chosen is probably you
know the ones that I've seen that people
tend to use right so in in Java in Java
expert we have more of them and they
aren't all even used ok oops
duplicate comments I think that was
because I realized those dick comments
didn't fit on the bottom and I forgot to
remove that now then there's the the
other the next class is job settings so
this is the current configuration of the
job and pretty much a you know I I think
probably everything that's a printer
attribute has a companion value or
property in the in the job settings and
there are a couple of others besides so
you know trying to be as consistent as
possible with with native api's and or
native behavior and so forth is the goal
and you know what you see it populated
with is pretty much you know what we see
when we basically create you know go to
that printer and somebody would create a
job from that printer and okay what are
all the default settings for that just
as something of an aside it's you know
if you're ever wondering what exactly
native behavior is you know it's it's
actually really hard to figure out
though because you know went through an
exercise where you know looking at
things like word and notepad and and
right and so forth
what they do and if you go and do
something like configure your printers
say
okay the default number of copies for
everything which you can do is going to
be - I want this printer to always print
two copies so you bring out right and it
says to you bring up notepad it says one
you know so you know there are many
things that you know applications can
override just you know maybe not even
consciously just in the way they happen
to use the the platform api's and so
forth so you know we try to accept those
printer defaults and things so you get
as much of what's supposed to be the way
that the system is configured but you
know it's not impossible it'll be
wrinkles and things that are like well I
don't understand right does something
different than what you're doing in FX
well right probably wrote some some hard
coded something in there so you know
anyway once the end user starts to
modify these or you start to go through
platform dialogues and so forth they end
up getting beit's into data structures
and you know it all gets very very messy
in terms of what they they actually they
are but we try to reflect back you know
when you come back from the native
dialogue will reflect back what the
dialogues say the value is now you know
so one printer driver might decide to go
and hard-code something in another knot
and you know it's to large extent
outside of our control but you know you
know once it comes back from the from
the user dialogue so if you display you
can call show page setup dialog show
print dialogue you know you can then
inspect things in these job settings
right and you can see oh I see it's been
changed from portrait to landscape why
did the user do that no this has got to
be printed in portrait you can go and
slap it straight back and make it
portrait again so you get the final say
that's so you know if we didn't provide
these api's you would pretty much have
to accept whatever it came back as you
would actually have probably no way to
inspect it you have nowhere to change it
but you know because there are job
settings you know you've got the and
printer attribute so you can do two
things you can find out what are the
things that you could use to set up this
job and then you can actually you know
and force the one you want even if the
dialogue has been displayed afterwards
you can go and set it back so each of
these attributes is basically the usual
sort of FX pattern as a get through
method as set foo method and a food
property method food property so
something about the philosophy in the
sense of the API here job settings in
sort of implies is meant you know maybe
the names don't completely do this but I
you know they sort of him the first one
is sort of meant to imply mutability
those are the way it's currently set up
and the attributes were more sort of
like well this is just how you know this
printer is right you can't sort of add
you can't sort of magically a you know
cause a printer to support you know a
zero paper right it's just not going to
happen right so but you know if if it's
available in the list of possible values
then you can certainly put it on the job
so you obtain a printer attributes for a
printer and then you obtain a job
settings from a printer job and it's
basically spelling mistake and they're
pretty much based on those initial
attributes now you can't create you so
you can't create a job settings you
can't create a printer attributes right
you you ask the printer for the printer
attributes and then you ask the job for
the job settings and I think I have
something about the life cycle of those
at some point yeah so so those are the
same for the life of the prints or the
job right that's particularly important
for the job settings you know so imagine
you know you can do something like if
you want you could you know you know
using FX properties you could listen for
a value in the change a change in the
value of a property like you want to
know just you know if the user did
change paper size right
if basically we said well there's a job
and then you can set a job settings
object and then
job settings object can actually have
its own properties which are like the
paper and or the or the the orientation
or something right
and a new way okay I want to listen to
the changes on the on the job on the on
the paper or orientation and somebody
installs a new job settings which is in
the one that you were listening on that
was then the job settings that was that
how the particular property instance
that you'd been listening on is no
longer attached to the job you're
wasting your time right so the basic
idea is that the job settings is created
with the job it sort of lives there it
could almost see we could almost have
just basically bundled it into the job
as being a bunch of the a bunch of
attributes on the job but it was sort of
delegated off to a separate object just
for to keep the API cleaner and you know
you go to that job settings and then you
can see the way the job is configured
you can't bind job setting properties to
some random application property even
though I effects you know generally if I
almost always you know does do this
there are a couple of other places in
the implementation or the API if we put
it that this is also disallowed so what
this means what I mean by this is that
you you know if you had your property
you know I don't already want to call it
my copies or something and you know you
wanted to force the cotton number of
copies of a job to be bound to yours so
that you had control over that that
would cause us a real problem because we
you know we are going through to some
platform native resource right we are
you know bringing up a native platform
dialog or Windows dialog the user can
say oh I want this value I want that
value whatever they press okay and they
say I set this job up with two copies
and landscape and I want it in color and
you know if you've tried to tie it so
that we can't actually have two copies
you know can't actually change the value
of that property value the value of that
property one of those you know we're in
a bit of a bind we can't even report to
you what the end user requested so you
if you try to bind it you'll just get an
exception alright quick walk through
really quick walk through of the
different attributes copies as an
integer property very simple that's just
how many instances of the job string job
name this is really just fees as a for
the Banat page typically we support
collation so you can if you have more
than one copy they can be collated or in
collated I'm presuming that you know
that P that means you know page 1 page 1
page 1 page 2 pitch 2 pitch 2 is
unrelated and page 1 2 1 2 1 2 is
callate it
we you can choose whether you want the
printing to come out in gray or color
quite common if you swatch a lot of
saving cups I should have gone so fast
we will support you lighting you can
configure um you know how many whether
you want to print one-sided or two-sided
quality draft low high normal I think
there's one brizl resolution should be
on here somewhere
low print quality and resolution very
confusingly overlap in many AP eyes yes
well here's the thing right it's what I
was just saying about resolution and I
actually need to go and look at what
remember what the actual underlying so
platform api's on Mac on IPP I think IPP
I think what we we support is what IPP
supports right and I think GDI right
when Windows has a slightly different
range but then when you see print
quality on on some printers particularly
on Windows the way that GDI is actually
implemented under the covers it's kind
of weird in that the there are two
there's a the field for quality is
actually the same as the field for
either X or Y resolution and if the that
resolution is negative it means quality
so you can't actually you can't actually
have quality and resolution on Windows
for in GDI at the same time but also I
have seen and I know because I think
that that the some you know printers
specific property sheets they they they
actually have little settings for
resolution and quality and they're lying
only one of these really applies right
but you know many cases they they just
want to give users the OP
or in some cases they may actually mean
resolution and they manifested as as you
know they actually displayed as quality
so there's a bunch of you know issues
behind that and but I I think that you
are right in maybe your very initial
point in that I think there are five
settings actually in the windows
GDI API but we are only reporting the
four IPP ones and that's something maybe
I should think about but you know the
trouble all the reason for it being
Daliah
right now is we were layered on top of
the Java 2d API which was based on IPP
which just supported those so I can't
actually from where I am see what's in
the driver at this point yeah I mean you
know yeah maybe maybe we should actually
add more settings and just sort of like
map two of them together and then you
know we can then you know have the map
one-to-one later on it might be better
than never being able to map exactly but
you know I should think about that paper
very simple with tightener name
many of these classes were in ohms you
know nothing you can add to them right
there's nothing to add to most of them
you could talk about the the the quality
one but you know it in API level we can
add in nine if we want to do add more
but you know you can't add more but
paper well paper can't be an enum you
know well as they for there's a three
there's a to whatever a letter
um well printers have an enormous set of
almost you know IPP defines gazillion
sizes GDI defines like 30 or 40 years
actually depends which version of
Windows you look at and then printers
out there own and so forth so really
this is an infant number you just need
to call
all get supported papers but we do
define predefined a whole bunch of
things like a4 and lesser and so forth
just for convenience so that if you just
want to sort of setup your job with you
know with with with that you know what
you're talking about because if you the
the the downside right I guess of the
fact that the printer supports so many
different versions as if you if we
didn't provide and just let you say oh a
for right and you're looking for a4 and
and I don't really have a good answer
for this and it you know if if we only
basically just provide a completely
custom instances of paper the only way
you never figure out what was a for was
by going through all of the papers
looking for the one that was 297 by 210
or as millimeters but here we you know
we provide provide a bunch of standard
paper so you can just say for how do you
plug it sorry yeah that's got the point
on I'd like to learn how in PowerPoint
to do that nice thing that people do
with sort of like adding new lines and
bullets but I haven't actually figured
it it's not good yeah okay and the other
sort of I think the only other
orientation get copious orientation got
covered so we also have a notion of a
page range very simple right start page
end page with values starting from one
and there is a page ranges property on
job settings right which is an array of
these things so the idea is that you can
actually have multiple ranges so you
could be printing page 1 2 3 &amp;amp; 7 to 7 to
10
okay I probably should have covered this
one earlier and this one is sort of one
of the other important classes this
isn't a singer and attribute as such but
this sort of gets into how do you go
about sort of organizing your content on
the page that's why it's it's
interesting so a page layout is an
encapsulation of the paper that you're
using its orientation and whatever the
margins are I really should sticker it's
probably obvious but I should put a
little I should do a diagram slide I
think and so within that the resulting
area is what you've got to print on so
if you know you've got a four actually I
think I have some comments on that in
the next slide but basically anyway so
within that eight that you know piece of
paper you've got the the margins and
it's within that there's essentially the
piece of piece of paper that you're
printing on anything that's outside of
that is is clipped so it's not the sides
of the paper that matters to you is the
size of the printable area and we'll
come on I have some slides on this
somewhere maybe it's in the example okay
now you can create oh yeah I thought it
was by now okay you can create your own
page layout instance right so and this
is obtained from a printer right again
one of the things I think I'll mention
later on is that there's a there's a
paucity of new this new that in the API
most things you actually get from the
implementation for various reasons so
you just say I want this paper in a four
or landscape orientation and margin type
default and there's a predefined set of
margins and what we try to do is just
sort of make it really easy for you to
you know configure your paper the way
you want so margin type default you know
after a bit of thinking about it you
know decided that about 0.75 of an inch
was a sort of reasonable
default so if you if you actually
typically you know don't do anything and
just you know get a you know print to a
don't don't even look at the page layout
don't you know what's with the page let
you know you'll get up a page which has
you know three quarters of an inch
margins around we looked at sort of one
inch was what was used a long time we
going to date was too big so there are
half finished now that just looks too
small so you know this is just right but
it can depend on paper size so and then
there were things that were really hard
for people to figure out if they wanted
to do this in the old api's you know I
want to use absolutely as much as
possible the paper so there are api's
you know the the PPD's and and junior
you know so you know cups PPD's and as
you would get on on linux and mac OS and
you know GDI will actually tell us what
is the real you know hardware limitation
because most about all printers comprar
to the border right so if you just said
hardware minimum you know we would give
you the biggest possible piece of paper
if you say equal what we're gonna do
there is say well you know the hardware
minimum can be different on different
edges so if it's you know we're going to
basically try to pick will basically
take through what's the largest of them
and so we can give you a nice uniform
thing rather than having your content
kind of shift in just a little bit but
you know maybe you also really want to
you don't mind that you you just want to
sort of Center it horizont Sun centered
horizontally and center it vertically so
equal opposite so if it was like you
know five mill here and eight mill there
you know would be eight mill margins and
if it was seven here and six here it
would be seven on the sides so you know
we try to make a few of those things
pretty easy so you can you know I think
those are the all the common use cases
and if you want something completely
random and shown the variant here but
you just pass in you know four values
and it'll you know use those values as
the margins and you know the printer
validates the request so you can't ask
for negative mark well you can't ask for
margins which would cause the paper to
just not be bad
you can't you know if you ask for a
paper that's not supported we'll just go
and we'll give you the best you know it
by some algorithm you know a reasonable
default I mean something that's as close
as possible to satisfying the requester
so how I should have said it
okay so page low-key methods you want to
use get printable wit get printable
height there's a few other methods on
you know you can query for the margins
and whatever else right on the page
layout that you've constructed or that
was constructed by the implementation
but really most the time all you ever
want to do is just go and get the the
printable width in printable height and
and why because this basically
represents the size of the window you've
got to draw into right and you know it's
it's you know try to make it you know
what seems to be the natural way for you
to think about it right when we give you
the width we're telling you you know
what's the width and the orientation of
the you know that the user has selected
so eight and a half by eleven standard
letter paper you know is six hundred
twelve by 792 so if it's in portrait
mode that's what you'll get but if you
switch it to landscape mode will report
the printable width as being 792 and the
printable height has been 612 so you'd
have to go saying oh what's the is it in
portrait or what I don't know you just
don't worry just you just get the width
get the height that's basically what
I've got to format my output - sorry
duplicate again I need to tidy this up
so you know you know I was just really
trying to point out with these last
couple of with this last one line that I
added is that the typical you know if if
there were say one-inch margins right
that would actually reduce the amount of
the printable width so it's you know you
don't just look at the paper size
remember it's the printable width in
printable height that counts
so example get the job settings from the
job then from the settings get the page
layer firewall is off you get the page
layout from the settings and then you
get the printable width printable height
and this example is just trying to show
you how you would simply you know center
a circle within the within the page and
actually trying to make it be as large
as would fit on the page so the the
radius is going to be whichever is the
lesser value and the the circle will be
centered at half the page width by and
half the page height so that's what it
tells you you know it's fairly obvious
okay so the yeah something on me I seen
things on mailing lists you know people
want you know thing you want to be able
to do sub classing a lot right and a lot
of things are our final I mean I think
that's probably more true in the
controls and so forth but the a lot of
things in this API are indeed final in
fact and it doesn't actually make sense
to subclass them in my view anyway
because what we're not we're not trying
to give you something that you can
extend it just doesn't make any sense to
extend it we are we're reflecting and
giving to you some something represents
platform properties right you can't
conjure up a printer there was no sense
in you be able to say new printer what
do you mean new printer whether that
what it is what's that got to do with
any printer on this
so and you can't you know sort of you
know have it be able to do the two-sided
if it can't so the usual pattern is you
know we you get you you can query all of
these and you know and we know how to
actually map these and create them based
on what's in the platform so you know
since you can't you know you can't
subclass print you know you can't you
know you can't create a printer so you
know sub classing makes no sense there's
so you know printer and whatever a final
write what would you what would you do
with a subclass how would you create an
instance right you can't so all the
classes are a final unless we have a
find a good reason to to to to remove
final which is a compatible thing to do
so final classes hidden constructors
okay job lifecycle briefly hope so when
you create a printer job you're in is in
the new initial State you can display
and redisplay the dialogues to your
heart's content you can you know go off
and you know just week job settings and
whatever else and it all stays like that
until you call the first time you call
print page at that point you can no
longer do anything printing is active
you can't call you can call print page
again right but you can't you know
redisplay the user dialog and change
settings we're already in the middle of
the job too late yeah the you know so
you know I wanted that even if they turn
out to be very very good arguments you
know to the contrary maybe at some point
you know it's that's a better place to
be and then sort of trying to work
around well this used to work I used to
be able to you know show the dialog
print page one and show the dialog and
change something and it used to work
okay
I don't want to be dealing with that so
without having thought it through so
this is the the job lifecycle and then
there are various terminal states you
can actually call explicitly cancel the
job bail on it so that we know that that
it's done you can you know there could
be an error reported or you when you
successfully call end job then the job
is done
how about suspend or pause arm no there
isn't but there isn't any I'm not sure
what it would even mean I mean once so
once you enter print page we're in the
middle of rendering a set of nodes to
the printer right to to the you know to
whatever represents the printer graphics
should we say under the covers and then
we come back and we finished with that
page and then nothing happens until you
call print page again so you know you
can essentially put the job into a
paused state by not calling anything
else right I mean unless you call end
job it never actually comes out of the
printer I mean there might be some thing
like you know the application gets quit
and something in there a various signal
sent and just under the covers windows
might say oh I'll spoil what's what was
there or something but um you're um you
know you you would have to cut you know
until you call print page everything's
stopped just waiting yeah actually one
interesting topic which I don't talk
about anywhere and maybe as you this you
know there's you know because this is
the scene graph model you know this this
this is sort of written as an immediate
mode kind of a well maybe that's not
quite the right word but you know in if
anybody who sort of looked at the
different job of printing API is in the
past right so in in the first API for
JDK 1-0
you basically you know would draw to a
graphics and when you were done you were
disposing or whatever it was and it
would throw the page in the job of two
api's what would happen is you know you
would implement a method that an
interface that would print a particular
page and you would pass that off into
the implementation and it would be the
thing that would print page 1 or page 2
or whatever and you know we because it
was a essentially to us a callback we
could the implementation could call it
as many times as it liked this you know
has its pluses for sure but also you
know was much more difficult for people
doing you know some kind of some you
know longer document because the
contractors to when we were done with it
wasn't clear right you know in fact the
contract didn't even say that you know
if we print page three and we print page
four we haven't actually promised we
won't come back and ask for page 3 again
so the way but the way this API was done
was just trying to make it a bit clearer
to people that you know you can print
you know you say print this page and
when it's returned that's it we're done
with whatever was on that we've printed
it we're really done with it and you
know under the covers you know because
it's a scene graph though if we need to
within that page while sprinting that
page you know essentially render the
scene graph three times we can so okay
so you can if you really want to monitor
the job status you can you can just call
the job status so you can monitor the
job status property okay so I wanted to
kind of just show some basic examples
this point is it okay so I mean this is
not a very pretty application because
Jasper didn't write it I wrote it I I am
I want to pretty up and add a few more
little demo kind of things here but I
didn't have time by job or one help to
do so so all this is showing you try it
what this is trying to show you here is
um probably could show you the source
code I mean what you know the kinds of
attributes that we see exposed and what
this application is doing is you can
just pop up a print dialog and that
should be modal with respect to it but I
best didn't know I can change to the
printer to whatever I only have one
printer physically attached here but
Windows remembers the rest of them and
you know over over kind of covering it
up there but you know it's got the Canon
printer which I got here attached and
you know that should then just change my
Oh what while was doing here is I just
had a listener on the printer property
on the job and also if I you know kind
of go in here and I go into the printer
properties and I do things like change
you know set it to be double-sided to be
landscape grayscale whatever all of
those things were being recorded over
here color and so forth and whatever
these should all change this has changed
to updating still and why is it being so
slow
oh the printer isn't physically attached
this is this printer is in my office and
so it's actually currently trying to
talk to the printer so that's not
working so well maybe I should go back
to the Canon look why that's hanging but
I think that's just sort of a
windows is unfortunately that it tends
to hang if the printer isn't available
so just change the few of these things
actually
this one here might be interesting see
quality is normal if I change this to
fast I don't know what it'll actually do
here yeah you see and which one of these
will change its being slow its printers
powered itself off to see if powers
still having the same problem
yeah yeah we'd do it again since the
printers no on this doesn't work it's
the demo gods
yeah so the quality is draft so I was
just curious wasn't sure this printer
actually really does support quality and
not resolution anyway so you know
there's only one tray on this but again
you know if I go off and select
something like a five it should show the
paper size here is now in a five so not
you know very pretty but I'm just trying
to show here that you know as as you you
know as these things are changed by the
user once the user okay's the dialog all
of these things update the value and the
job and if you want to listen in on
those properties you can write so you
don't you know it's up to you how to
handle you can actually just call that
you could ignore this entirely if your
application doesn't care you could call
the getters or you could just listen in
on the on the properties that you're
interested in so that you get called
back if the user changes anything rather
than you having to to proactively go
ahead and find the value okay some of
the printing examples I don't know I
come on to this very shortly but I think
we're view and I'll show the code but
web view is a bit interesting
I'm not sizing this thing right but this
is um you know just bringing up um I
should really bring up this one
configured to bring up a different URL
this one does seem to generate some
nasty exceptions but um webview this
this is basically webview just running
displaying some Oracle website and web
view is interesting in that you know you
you wouldn't know how to actually go
about laying out the content for that so
there's a very you know simple method
that's been added to to to web view all
you've got to do is basically pass in
the printer job to it to web views print
method and it will grow itself to the
printer this one you know this
I think will generate yeah I knew this
one generates some exceptions but this
then so so add paper go again Java comm
was the one that printed out most nicely
so you know I literally two prints out
you know webview the code is you know
basically trivial so you can print out
you know anything it's how you want to
print out webview from your from your
job you just go ahead and a favorite
application just go ahead and call this
one method and the way it's actually
been implemented because you call you
know you pass the the the the printer
job to webview right it basically
internally just you know calls print
page for each page that the web engine
wants to print and you know that doesn't
and then when it's done it doesn't
terminate the job or anything right so
you know here what I basically did is I
printed you know called webview to print
itself and then just randomly you know I
through I flew another page is just
printed a circle whatever just anything
so you could embed you know it is not a
separate job you can embed that webview
printing within the context of a larger
job and one thing we're going to do just
to hope people you know play around with
what prints and so forth is so there's a
print button here that you know will be
a nicer one I think at some point just
added to ensemble so I was going to try
to find charts charts are usually kind
of good
yeah we I need to shrink this down just
for now because well the implementation
isn't scaling that and I just press
print on that well well what it's
basically going to do is print out
whatever is the I'm assuming a certain
familiarity with ensemble which is sort
of like the application which
demonstrates all the different features
of the UI controls and so forth and you
can just it'll just print that out so
this is very doesn't you know we can add
you know header and footer to this and
so FloorMate know pretty but if you want
to print a chart or anything it's that
easy you just basically pass the node to
to print page bump and it comes if you
want to you know where was that graphics
so you know we obviously can have
effects on what that one is
okay so the goal is right you know we
have you know John earlier on when
before the recording was started was
asking about printing 3d which won't
work yet for reasons I'll go into but
hello like that got clipped but
basically in theory you know this is
coming out on the page here with you
know the same shadow effect as we had on
the screen so anything that you know or
anything you can print write anything
that you can draw on the screen
eventually should be capable to be
printing 3d maybe the the one case that
just doesn't that I know will not work
right now others or cannot work right
now the others are basically bugs so is
anything that anybody wants to see me
try to print just out of curiosity I'm
honest I know what I mean
ah damn you I'm actually I've got a fix
but canvas doesn't work right now we we
there's an exception thrown I was trying
to fix that last Thursday and then I got
this email that said apparently I had to
give a talk on Wednesday and and I
didn't quite get around to fixing it so
yeah I know canvas will throw an
exception I mean I could prove it to you
yeah hey guys yeah there's some
exception there no I don't know why this
one is actually it was supposed to spit
out all of that stuff unless there was a
young bug build and then whine anyway
let's hope I haven't completely hosed
ensemble there but you know the UI
controls if you want to print a damn it
I mean term table I don't know if the
table in here is all that pretty to be
honest but why is it clipped right
where's non-blood doing that okay I just
see what happens
I've got a little portable printer here
cuz a 60 pound behemoth in my office was
not going to come with me so so you know
basically all I do there is a DOS game a
skit and sambala to print I mean
literally all we're doing all it's been
done to ensemble at this point he's just
trivially just you know it's printing
whatever is this group node here or
region print to an image oh can I print
images at full resolution is that we
meant there's no that would be more
there's no way to do that no is the
short answer
the the if we were to do something like
that well yeah I mean you know that
would be more like you know that would
that would might be something that's
done kind of outside of printing really
because all you really to do yeah it's
something like canvas and then just a
snapshot of it so it's that's sort of
outside of printing but yeah yeah but
I'm you know what I've thought you were
maybe asking was about how we would
print images and you know certainly
there are things you know if you gave us
like a very I I tried this many months
ago and to prove that it works you know
you can go out and get a really really
high resolution you know twelve thousand
by ten thousand pixel image or something
in and print it through this API and it
prints it you know full resolution so we
don't pixelated or anything okay we try
to wrap up and we're not really done yet
so that was the webview slide so you
know the basic you know the basic method
you want to look for or the only method
you really need to know about is this
where you get engine print and then with
a well this is actually a mixture of a
Peoria declaration and actually usage I
should clean that up
but um basically you you pass in the job
to do it's print method so you set up
the job pass it to the web engine it
prints as many pages that is it needs it
seems to have problems right now with
margins but I think there was a blog on
that and then you know it just returns
control to you and I don't if I actually
up that up into a full example but I
meant to but I didn't get around to it
so okay so pretty much everything you
know I think real points I was trying to
get over there is just that you know any
any you know everything in FX is one way
or another a node and you know you can
you can print you know as many know any
node you want and you can put any you
know when that can be a note hierarchy
so you just lay out the nodes the way
you want you pass it to print page and
how it comes yeah so this was something
I touched on earlier on you know there
are two you know important threads in in
in Java affects the FX application
thread and the FX rendering thread
called the prizm thread usually
colloquially you know you're supposed to
do everything on the application thread
and we do the printing on the on the
backend thread and so there are you know
rules about you know you can't even you
can be if you do a stack trace dumps
array you can see this but pretty much
you're trying you're supposed to do
everything on this thread on the
application thread once you've attached
stuff to a scene and you know stuff can
only get painted and drawn when it's
attached to the scene and I was gonna
so my real point there was not really
being made but in you know in and that
that's that's that's basically effects
works normally but in printing you know
you know we we're um you know trying to
make it silly you know he obviously
still don't see this but you don't have
to worry so much about the FX
applications right you can you know kick
off printing on the thread if you want
or you can call printed your credit for
a job and show print to page dialog from
any thread you want and you know you can
you don't have to you know you don't
have to add your node to a scene right
so you can do whatever you want with it
right and we can print that thing off
off on any thread you want so you don't
have to be you know it could be just
literally running in the background on
another on another thread and while your
application continues to do its normal
stuff because printing is a fairly
long-lived operation I seem to have lost
some slides here they went oh you know
that's basically about the rendering
thread okay I think I need to revise
these slides of it okay so one note is
you know don't you know don't animate
anything the or we were rendering I did
actually have a fact one of the things
that I could have shown in that copy of
it somewhere in an ensemble so I mean
there was some animation and you know
this is sort of I got any we will just
see it very clearly but you know this
this was an and some kind of ball
bouncing ball or whatever animation and
what I try to print that you know you
know you can see this sort of cut off
and there's well you guys probably can't
see but it's like a Jaggi here and so
forth because you know when we go to
print right it's your animating it's
whatever we get whatever the state
happens to be at that moment and if it
spans multiple frames because we we call
back to print you know with the second
part of you know
you know we may actually try to print
that several times just to actually
complete the page then you know it's
somewhat potluck what you'll get so you
know it should be you know common sense
you know you know you can't you know you
you know you can't print a media view
that's displaying a movie right I mean
we're not going to give you a hundred
thousand pages one for each frame well
yeah the flip book API you know yeah
paper manufacturers would love you but
yeah okay so that was most about
everything I want to just say so this
eyes a bit busy and doesn't have
everything on that I know I meant I have
to adjust it but one thing that was
touched on earlier on is the way that we
did this for fx8 was we built on top of
the Java 2d printing implementation so
the API exposes absolutely nothing of it
and you know there's no you know hard
dependency until you actually until you
start to use it but you know under the
covers we we call through to the what
was the Java 2d pipeline which was the
non accelerated pipeline we used in fx2
it's still there in fx8 but it's not
it's not used for for desktop usage
anymore but you know printing calls
through to it and you know that's where
we're getting our dialogues and and
where we're getting our you know the the
underlying printing implementation for
each platform which talks to the GDI and
so forth and you know that is obviously
a you know was it was a good thing
obvious to you it was for us it was
obviously a good thing because we didn't
have to go and write all these different
platform implementations and you know
each one of these is like like I was
saying off-camera it's like writing a
pipeline so you know we might have a
direct3d pipeline and OpenGL es2
pipeline we might have a software
pipeline you know and a lot of effort
goes into writing each of these
pipelines and you know
printing would you know need to support
you know in its native director native
implementation you know everything that
we would do through D 3d and all the
effort that goes into that so for for
this release basically it's based on on
on 2d so in jelly cake when you have
profiles and you can have the core
profile and the I forget what they call
them all but you know there's a desktop
profile as well which basically brings
in you know a WT it a WT swing and 2d
you know you would have to be running on
top of that profile but you know that's
I don't think a big deal if you want to
do printing because you know generally
speaking you know it's the more
Enterprise type of app so you know there
are some minuses you know we're having
to maintain that 2d pipeline and you
know some of the the bugs if anyone's to
go out and try this you would if you'd
you can still force the 2d pipeline on
screen and you know code rot right it's
not being used on screen anymore and
people have done stuff and not check
that it still works with the 2d pipeline
so you bring it up on screen and we you
say it doesn't work so when you got a
you know some output is missing so mmm
you know eight times out of ten if you
see something not right in the rendering
to the printer it's you try to draw the
same thing to the screen with the 2d
pipeline it looks the same oops so
that's one particular battle I'm
fighting so I want to get you know in in
in nine we'll get past that but it
requires a lot of work to do these
native pipelines and you know then the
other question is what do we actually
generate right you know so on windows
you know we've been using GDI but you
know we only support Vista and above and
then JDK 9 we may not even support Vista
I don't know what the time we probably
have to but anyway but you know there
are newer Microsoft printing api's which
we could try to adopt if they don't know
if they fit in with what we need to do
and that will you know give us more
power potentially than we get with GDI
and then you know what do we do on the
other platforms I really haven't quite
figured out what the best thing to do is
you know we could you know people you
know have talked about the ability to
just directly generate PDF and you know
PDF is a perfectly fine spool format for
for you know from Mac OS and and Linux
so maybe we would actually implement
this as you know essentially just a PDF
pipeline i don't know i interested in
thoughts on that well we don't have a
mobile platform at this point there are
you know sort of open source people
working on you know we they wrote the
code is out there but it's you know the
people are still working on the ports
but you know that's something which we
would have to add in to that port right
you know so but you know one of the
definite goals for you know I think
committed product goals but you know
always that his claim is right from
Oracle right is is you know we have
effects running on what we call the
embedded platform right which is sort of
Linux on arm and so forth and other
similar devices you know that will
require printing support in JDK nine
right so that's not that's not Android
and that's not I us right but you know
we we will have you know something that
works on on those devices yeah but you
know I also did a long time ago at least
for iOS you know just take a look at
what the api's looked like for printing
and it didn't seem like we were doing
anything which would cause a problem in
just making this fit into the API what
was I going to say oh yeah one thing
that's missing from this slide which I
remembered while I was driving I think I
forget exactly how its configured but
CSS lets you explicitly say that this is
the you can have different CSS style
sheets four four four on screen and
printing right and one of the things we
want to try to do is you know with the
if you're displaying off-screen some
something which you know some controls
or whatever where CSS applies you know
we would actually apply the printing for
printing CSS you know and that might say
that would be you know so rather than
having like this you know gray gradient
or something else for as a background it
just would have a white background you
know something that's more sensible for
printing okay I think that wraps it any
questions
so I mentioned print color yeah no
that's yeah okay so it was an API slide
so far back I won't try to find it but I
think I know what we're talking about
where it mentions print color and what
does that print color mean all it means
is that printers you know color printers
right this was printed out you know on a
color printer right but you can put that
color printer into grayscale mode and
you know people will do that for
whatever reason like you know they want
to save their expensive color ink or
something right but you know almost all
color printers right all in at least in
one Mac OS and and and you know windows
they will the drivers right support
if they support color they also support
a monochrome or grayscale mode and it
just toggles between those two modes no
no it's not ID with color space I see
yeah no there I think there are some
windows api's and that I've you know for
specifying particular color profiles to
use with print jobs but we we don't
expose anything to do with that you know
you know we'd have to that would be an
interesting one to explore but probably
wouldn't you know we're probably other
things to do first
yeah so the question I was saying that
in you know in the old API is one one
and so forth he would fight how to
actually get stuff on to figure out what
had to go on what page you know how to
do pagination is there some framework
for that in the new API
yeah and short answer is no but I really
need to post or write some examples
which actually show about how you go
about doing this kind of thing for
typical you know cases the I mean that's
one of the reasons though
you know webview has its own print
method right with all of the other nodes
you at least have a chance right cuz you
know what what what they're they're you
you're in control you put this note here
you can set the size in the content and
you know lay it out and so forth with
with webview right you there's you know
you have a URL I mean you know and then
webview goes in renders whatever is at
that URL in its whatever it is right you
don't know how wide it is how long it is
you have no idea where you would split
it so the only thing that's possible to
do was hand off to web engine to
actually do the pagination for that in
the same way that you know WebKit under
the covers will do that you know if
you're running Safari right but you know
for general you know I have some can I
want to flow my content and have it flow
across pages and be broken up into pages
you know you I have you know I've you
know given I think a chunk of one job or
one talk I'm just remembering like six
seven years ago eight years ago I gave
with showing is trying to actually show
how you go off and do this for something
like J table was it J table and it was
you know such a pain you know I I had it
working and it worked and it was you
know various other people had tried it
too and you know I probably knew enough
about the way things worked then I it's
good a job of it as anybody else did but
you know in the end we actually put a
method on J table for it to print right
because you know you didn't want people
to have to do that so so so that the
kinds of content that really are you
know going to flow across pages like
tables and things like this
like web view we have talked about you
know providing some kind of easy way of
doing it not you know I think there's
some mixed views as to whether we should
or shouldn't do that I mean I think you
know printing something like J the
tables right the riches view is that
that's kind of the reporting package
world right we should you know they
shouldn't even be doing it this way they
should go off and do something
completely different right and you you
know you basically go off and you get
your rows of data and you know you just
print those rows of data one at a time
and and you know it's not really hard to
you know realize that okay I've now got
twenty rows on this page okay got to go
to the next one right but you know then
there are at least you know the one
thing that I really want to try to put
out an example for and but I think you
know really could still need some kind
of helper is you know text and probably
text flow as well because you know text
is a no it's really hard for you to
measure it again it sort of it's not as
bad as web view but it's really hard you
know the the way if I actually wanted to
finish an example which shown how you
could do this and put it in a couple of
columns and so forth maybe I can do that
by Java one or something but you know
some of these are definitely still
really hard so it's not exactly um the
answer you wanted to hear but yeah you
know they well okay here's the bit you
wanna hear no you're not stupid this is
actually the it is actually quite hard
but I would like to sort of provide some
examples which show you know how you
would go about doing this for and you
know if if as time goes on we say well
you know some of these things which you
know just naturally flow too hard we
could provide you know some kind of
helper API to do that for you but at the
moment I don't have anything they'd
rather than you just laying it out
yourself but excellent question
touched on something that I wanted to
add slides on but I didn't want to do it
without my backup example</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>