<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Lighting Talk: Write an Interpreter of Bytecode in Java | Coder Coacher - Coaching Coders</title><meta content="Lighting Talk: Write an Interpreter of Bytecode in Java - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java/">Java</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Lighting Talk: Write an Interpreter of Bytecode in Java</b></h2><h5 class="post__date">2016-08-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/jRCqnq8JImg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so the question is how to write an
interpreter I mean an interpreter of a
kind of byte codes in Java there is a
lot of literature on how to write it in
C with a lot of you have even extension
of GCC especially to write this kind of
interpreter the question is how to write
something like this in in Java so it was
a question of Charles not yesterday so
basically I have language like this it
just an array of int and I want to
interpret it the fastest I can usually
it's very slow to try to do this because
you have big switch and basically a big
switch basically it doesn't like big
switch as a register allocator
technically doesn't like a big switch if
you write your evaluator to use a know
an object-oriented way to do the thing
which is for each code I will write a
class and have an an evil evil methods
it will be far faster which is something
surprising because the GT is able to
inline between the different evil it's
true if at the end of one instruction
you insert a dispatch to the next
instruction if you do a loop it will not
be fast but if at each just after the
code that do the
the things fall are not could you do the
dispatch to the next instruction it will
be fast so the main idea here is to do
exactly the same thing I try to find my
yeah my instruction so basically the
idea is to do exactly the same thing but
instead of using the classical Java
dispatch to use invoke dynamic
technically you can't write invoke
dynamic in Java but you can use meta
lenders and have metal handles that are
static final which basically forces it
it exactly the same thing so for for
Const you will have the instruction that
does Const and at the end you dispatch
to the next instruction and what you
want is a kind of shredded interpreter
which is what you want is that this
invoke exact to be seen by the jet as as
a constant and so this the JIT will
inline the next instruction and so on
until you have a kind of trace of the
instruction it should be full fully
dynamic so it will depends on the
program you run so basically the way you
do that in in Java is to create kind of
inlining cache we have a mutable call
side here and you call this method and
basically what this method does is to
install a kind of god-wave test
that remember the next instruction and
basically it's it's an inline cash but
instead of taking a look to the receiver
class it take a look at the number of
the instruction and so if you run it if
you run it and take a look to the trace
that you have you have trays like this I
think now you have trays like this which
are the traits that are generated you
have exactly the same kind of trace with
metal on door which means that the GT is
able to see I mean a trace of the
different opcode and optimize them so
you want the assembly code don't move
I have it and you will see things it's
perhaps a little big but yeah you will
think you have traced like this I don't
know it's called Q it's the main issue
with assembly code you have a lot of
code in it and I try to find the trace
that see that you have several code that
one I can't find it but you will find a
trace that see that you have the
different out code that follow each
further that's all
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>