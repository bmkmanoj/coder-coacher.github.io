<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Interview with Luke Daley on Geb and Ratpack | Coder Coacher - Coaching Coders</title><meta content="Interview with Luke Daley on Geb and Ratpack - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java/">Java</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Interview with Luke Daley on Geb and Ratpack</b></h2><h5 class="post__date">2013-11-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/zEJ8EDMIHIM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so my name is steven chen i'm here with
luke daily at the dead box conferred hi
everybody and we're going to do a little
bit of hacking on some of his projects
so Rat Pack Jeb Gradle kind of all
involves here you're working for greater
learn now right yeah yeah sup in with
great away for about three years now so
is it a day to day working on Gradle
playing code on that putting releases
out that kind of thing it's cool it's
cool company work for and we're still
growing and it's good to be I like being
there kind of underdog in that space
right there's a well-entrenched leader
and you're trying to sort of come up
from behind so that's cool good company
ya know my my favorite thing to do when
I'm showing people some of the projects
I i hack on is all i'll point out that
most of my builds now our Gradle based
because I just I can't I hate maven so
much right there's a bit of an half day
yeah it's really cool when you see a
talk about some technology that I may
not necessarily be involved with me
presenting you see the Gradle build in
there went to talk last week at a
conference in Sweden and goes through my
big data as it was libraries I'd never
heard of but at the middle of it was a
great ability that's really cool you
can't you didn't really see that so much
a year ago but see more of it now which
is cool cool so we're live at the DevOps
conference here if you're watching this
live join the chat so you can you can
ask questions and then we'll answer them
as they come along or you know if you're
if you're sitting with the session rooms
upstairs you could always pop out of
that boring talk and come down here it's
that but um so tell me about what things
are doing at devoxx here before we get
started with hacking yeah sure so I've
got a session this afternoon it's 4 40 I
believe talking about Jeb which is an
open source project they created a few
years ago it's a it's a functional
testing tool I mean if it's basically a
groovy dsl on top of selenium there's
the whole gist of it so I'll be
co-presenting that with Peter need a
visa Benioff Spock framework Fame so
here also another Gradle where guy i've
been working Peter for years I so came
across Spock if anybody out there if
you're into view into testing tools and
you haven't come across a spot framework
I know you talked about it a lot so i
guess if somebody's on this
they probably come across it so but
that's a great tool and I met Peter
through that and then really created Jeb
to try and have a functional testing
tool that was as nice or fit as nicely
in that kind of space so we
co-presenting he's worked with me on
jabbed a little bit so he'll be doing
some spark bit so i'll be doing some jab
bits yeah yeah i mean getting good
testing tools it's really important and
it i think something a lot of people
don't get as java developers is the
groovy build and test systems are not
just for groovy developer so yeah that's
a huge point so and i'm seeing more and
more that now as well sort of going into
places and helping them with the build
infrastructure bring in Gradle in and
seeing groovy use quite a bit just in
the testing layer so a complete Java
stack you know groovies not in the
application run time at all they're
testing with groovy and people who
aren't doing that so i'm at the crazy
right it's more productive experience i
use cradle for my scala for a crime
scene oh that's cool
alright so now we're showing your
desktop yeah so this is this is a
different project so i'll click back to
this one this is jeff this is the Jeb
home page for that so that's I mean it's
it's been around about four years or so
now it's pretty stable it's still not
one point oh but that's really my my
laziness not really anything about the
code base but it's been used by it's
been used by a lot of people and I know
there are some high-profile sites using
it here and there so it's really stable
that not sore too much work going on it
anymore is more or less feature complete
and kind of thing so it's this is kind
of what there's a bit of an example of
code here this is not a um this is not a
test but you can kind of Jeb itself is
just an automation layer but then you
can integrate it with something like
Spock j unit cucumber whatever you want
to actually do the test execution side
of things so that's that cherished at
all yeah I guess if you're interested in
that sort of things when they check out
the other talks being videos get
presented at the talks right yeah so um
Stefan mesh in the keynote this morning
so so for the folks online who think
this unfair that we're talking about
things which they can't actually see now
Stefan is going to put all the videos on
parlays before the holidays so it'll be
nice like you know Christmas gift or
something and they're all be free which
is really cool so check out the videos
on parlays and also I started putting on
net hacking videos on the night hacking
parlays channel too so if you're
watching this on the parlays channel
you're like you're like halfway there
yeah cool cool yeah so that so that's
jib and like I said talking thats
afternoon but the this is the thing I've
been working on lately and it's called
rat pack and it kind of it started out I
didn't create the project it's been
around for a few years but I took it
over a bout a year ago it started out as
literally a groovy version of Ruby
Sinatra that was the continent was the
kind of brief have those kind of script
based apps and very nice and simple you
know not too much weight just get me to
the HTTP very quickly kind of things
that's how it started and I got a bunch
of guys we're working on that a few
years ago they stopped working on it and
it was taken over by a good friend of
mine Tim berglund one of the NF j s
speakers gets around a bit now Zagat
hubber actually and he came to me and he
sort of asked my opinion on and had to
have a look at it and actually the
reason I was interested at the time is
that I was doing Jeb presentations and I
needed some kind of lightweight
framework to great little apps that I
could you know demo to test kind of
think so just something very small
started quick really nimble that kind of
thing so that's why I was interested in
Italy then I Sabet of got into it nuts
is this is interesting and one of the
things about it is that it's fully
non-blocking it's fully asynchronous
like there no Jas model and I was just
curious about that hears about how that
plays out when you're trying to kind of
build a nice use a level API so it took
it over and have been trying to turn
over the last year turn it into a real
project with documentation and all that
stuff because that's that's the other
thing I kind of being an automation guy
working on cradle and great aware and
got into that side of things how can
yourself the infrastructure around a
project that kind of stuff yeah now it
looks like you even have some design
skills because your website's don't suck
that's not me I don't have design skills
as a guy called rub Fletcher is also one
of the committee's who does actually
have design skills yet that's all you
know modern css3 responsive design stuff
it works well on mobile as well if you
need to visit map pack that I owe on
your mobile device but yeah that's I
can't do that stuff at all so um alright
so so yeah maybe show a good example of
some of the rat pack stuff so it is a
lot of the example code you see out
there is groovy but doesn't have to be
but I'll start kind of start with the
groovy stuff and we'll see what it looks
like to use in Java as well so this is a
complete rat pack up so you can use it
to just completely standalone you just
need to this is using grab which is
Groovy's built in dependency resolution
mechanism just will go and fetch this
one jar and its dependencies from our
sister j frog that org i push all my
binaries tube in tray which is the new
service from the j four guys so that's
not final release yet so it's not in
maven central you have to get it from
this particular repository so once you
do that
I pull in this static import here which
gives you this guy the Rat Pack method
and then in the groove version you use a
DSL inside of here so rat pack handlers
and this lists my application handlers
which really just functions that operate
on a request in response so one thing
should point out is it's not enterprise
Java like there's no servlets there's no
war files anything in that it's actually
all built on top of Nettie so it's you
don't use the traditional server APR if
this kind of thing so basically what
what this app says is that get on / and
no path is just going to render a string
to the screen on / date we're going to
render a groovy template and we serve
assets out of the public directory so
which is here so to start this guy up
if I have groovy installs just run grab
groovy Rat Pack groovy before you get
another app running somewhere over here
let's try that again
so that boots the app and there's my
thing on / which was just that string it
does all static file serving not that
exciting the templates one better this
guy so the one of the things groove is
not core it's an add-on and one of the
things you get me users ability to have
these templates which it basically
strings with embedded groovy code
similar to GSP is it coming from growls
at kind of things you can have arbitrary
groovy expressions in here they get
printed out so there it is an add-on is
that's this groovy template things
coming from aesthetic import up here and
one of the things is that is fully
reloadable so if i change this guy so
the app still running a change on window
change this guy to be
save it and go to the right URL actually
picked up so it was the other thing that
I was kind of intrigued about as to how
can i I'm going to create a nice
development environment it's like
reloading all the things people expect
now with that well one that worked well
with IDEs and didn't actually require
any kind of special too much special
magic so Rat Pack kind of managers when
you in development mode that changes
this file and reloading it so I don't
have to do restarts or anything like
that but I mean that's this is cool for
demos like doing single script apps in
it you can even use it for it's just
like I know some back-end services and
like that but you wouldn't put it into
production like this and it's one script
kind of thing say when you get naturally
there is some Gradle Toulon so if i use
my build up Gradle file for this guy
there's a rat pack Gradle plug-in make
sure this is just the Gradle code to
pull that in some report dependents
repositories here but I just reply Rat
Pack groovy it turns my cradle project
into a project that produces an
executable application and has some
extra stuff in here to deal with rat
pack it's pretty light touch most of the
extra stuff is to deal with the hot
reloading and the idea integration so
basically apply that sets up my rat pack
dependencies that I need it has a
special idea support which I'll go
through in a sec and some extra
dependencies now the the reloading so
how big is the Rat Pack project overall
like the you know in terms of code size
yeah yeah just you know complexity like
how many maintain errs do you have on it
ah right so it's mostly at the moment me
doing most of the work because I mean
it's still it's like pre 10 it's but
there are a bunch people out there using
it we've got a forum and people are set
posting questions and think of that and
getting i think there's about six or
seven people submitting pull requests at
the moment i don't think so it's gets
gather some steam yeah yeah no I mean in
my experience the open source projects
which survive or the
which have basically one or a few small
set of committers which are dedicated
rather than a large pool of people who
just part-time it yeah I mean one of my
um one of my things with this project
that was well was to try and set up
sustainable infrastructure because my my
goal is I'm not been able to
successfully do this today is to create
a project working it for a while step
away and that project continued so I
mean like the things like Jeb well it
well I've got another guy Omar chin who
works a lot on it but it's still very
much kind of my thing but hopefully one
day I want this to grow on and I'll move
on to something else going to think so
but a lot of a lot of works going into
the actual building for structure for
rat pack itself and the documentation
tooling and that kind of stuff so
setting up automatic testing of javadoc
snippets and things like that so i can
show if we have time Memphis tops are
getting that setup so it's just it's
easy to contribute code and to keep
things clean so other projects I've
worked on that's kind of been an issue
so over time as the of the code base
gets more complex just there the barrier
to submitting code gets so high that it
just if you don't have a history with
the code base you can't do it so I'm
trying to work out how to get in
situation where this this is available
over time it probably helps that you're
building agile and testing and all the
tools which you need to do that yeah
that's right yeah so I mean it rat packs
got a lots of testing infrastructure
yeah it's funny you mentioned before
about our testing tools we have this
running joke at great aware that could
very much everybody who works at cradle
where has invented some kind of testing
tool so I mean I did jab our Peter did
spark I've Stephon father who created
makito two other guys who worked on the
original version of selenium and the
project so it's just that first the
barrier to entry but it's it kind of
makes sense because if it's a certain
mind frame if you're into testing if you
into testing tools and things can make
you really productive own tests and
you're kind of in my opinion anyway so
get the quality aspect of it and the
betty tests are the cookie can ride on
the better quality of code it so so so
since I worked on a behavior driven
development test framework for javafx
the Urschel javafx script
theatre club sure absolutely yeah you
looking for work no no but thanks for
the offer hahaha so let's show support
um somewhere hacking code so um yeah so
he's my build a cradle I said most of
the heavy work looking stumble this rat
pack groovy I get this new so Gradle if
you have a news that follows the same
conventions for Tesla a source layout as
mavens have source main Java or source
mowing groovy in this case and test by
get this new rat pack directory and
inside there i get i put my rat pack the
groovy file which is that kind of the
hard on my application so similar kind
of thing few more interesting things
going on in here now this app is
actually a port of the groovy console so
there's that you can eat there's a
online gravy console you can use to run
some pretty code so because i use the
plug-in and I user-generated my ideas
stuff with that plugin I get inside my
IDE are nicer runner to run it this is
something that the tooling creates for
me so I can go ahead and start the app
right with an IDE and I have another app
using that port which is from before
let's kill that going
so that's up
so now this is my but if you haven't use
agree web console before it's like an
online rappelled run kind of so sends a
Ajax request executor groovy on the
server since back down so this is what
kind of looks like so here's my get my
index template there here's the actual
thing that execute that code so this is
a post handler on / execute and you can
see the dependency injection here it's
the other thing that the framework
provides so it's pretty much sum like
functional instructions of a HTTP and
dependency injection by juice so the
script executes a guy which it goes
nicekicks cuz that script and returns
was it what does it return scratch
result I yes that's another thing so um
yeah so the dependency injection for
going about time talk about that so
based on juice so we have this handlers
block and the modules block is where I
can register all the things that I want
to be services or whatever so is a juice
module and I've just got the actual the
thing that executed my groovy code
factored out and into the script
executes a thing and binding it up with
juice so my juice module to say is my
script executor and the result render is
some rat pack infrastructure but my
script executor just takes a string of
gravy scripts returns the script results
straight full stuff the result render
this is something if you bind one of
these guys in with juice it gets picked
up by the framework so when now there's
a request to render this guy right so
and then the frameworks as well who can
do it finds this implementation and it
gets context which is like the wrapper
for the request response and the script
result which is the object that need to
be rendered and then we're just doing
some content negotiation here to then
read under that guys chasing so that's
their render framework it's all kind of
yeah plugin based so you ever you ever
consider I'm kind of tossing a groovy
console out there for people to hack on
just as a website as it like as an
example of rat pack as a service as a
service people could just like play
around with rat pack and the Ruby
console yeah I guess it's interesting
idea so you start a server within a
server yeah I guess there's no reason
you couldn't do it basically so
basically you have a page which is a
there which is something like your rat
pack groovy that's an interesting idea
where's my rat pack approving this guy
so like a groovy web console where I
have this guy and then you hear another
I like another URL which is the actual
running application
we cool so you define the app within the
app some at some point you hit Turtles I
think yeah let's go that's cool idea I
mean this the groovy web console like
this I i ported this kiama Forge wrote
this and he's got it running on App
Engine at the moment so I was kind of
just looking for a nap i could port a
rat pack and found that and poured it
from App Engine to wrap packing it was I
think nicer cool yeah yeah he sure
places yeah yeah so um so that that's
like that's a groovy sort of things but
in job so so yeah you mentioned testing
of Java doc I'm curious about that so
let's go to the rat pack project itself
so that's what this guy is here and I
mean one thing you see me is it's pretty
modular there's another thing I've
learned from working on projects over
time is that you have to modular eyes
from the start and plug-in architecture
from the start trying to retrofit that
stuff is always painful so I went
straight away kind of went to factoring
this stuff out these are all
independently usable modules so that's
that's probably the only bit of wisdom I
could give to anybody is that if you
start a project modular I straight away
don't wait so let's have a look at so
this this bit of code here so here's a
spec that's testing a feature and one of
the one of the it world issued one of
their characteristics of our pack
because it's non blocking right small
number of threads if you have to do a
blocking operation you have to get off
the request thread somehow so there's no
inbuilt support for doing that so if you
need to use jdbc or some blocking API
you can do it so inside a handler I can
just use this blocking thing do some
kind of background operation here and
then get the result back on the request
thread here so it's kind of from a
slight but it's not full blown promises
so it's kind of small so if we have a
look at some just hope this works I was
just moving it around
so let's have a look at your blocking oh
it is here right so so one of the other
things we wanted to do is that some try
and have as much useful information that
javadoc as possible so the javadocs
actually really useful and which means
code snippets which means it has to be
tested run because otherwise they get
stale and having bat having wrong
examples is worse than having no
examples yeah so inside the javadoc of
all these little code snippets and the
way that I test it is that for the pre
block I just have a certain class which
this is this one ends up being okay that
kind of fixture don't need and then I
wrote some stuff here so there were some
there's already some stuff built into
groovy itself to do this but I had to
take it and modify it a little bit so I
have this code snippet test case which
uses a custom chain unit runner to do
this and basically to use this is
something I want to extract and kind of
provide outside a rat pack because it's
just there's nothing nothing to really
do with rat pack so in in your
implementation this you have to
implement this method add tests and you
add to this guy a test code snippet it's
been a while bear with me
what is that guy so test code snippet
ah I've just got some um just some
groovy dynamic stuff going on here
anyways it basically it ends up becoming
say that in my projects so here is the
code that I want to test the name of the
class that it came from the name of the
test and this all gets used to create a
J unit tests dynamically some kind of
setup because in depend on these in
these snippets you need it going to set
up some code do some stuff and then some
tear down for example and if you have
all of that and your examples it becomes
a bit bloated so it's in my in this case
here like I'm just demoing some of the
actual kind of their handling dsl I
don't have to have the code in here to
start the server and settle that stuff
up so I need to fix you for that stuff
and some other bits and pieces but based
on all that basically was doing is going
and just grabbing through those files it
just searches through java files using a
whole bunch reg expressions to find
things that look like Java doc find
things that are pre class something
extract that stuff out and because
groovy has a like a runtime compiler API
just construct a string of groovy which
which is a superset of Java so you can
do for java stuff as well and execute it
so let's make this go fail so this
should be with this run javadoc co
snippet tests I think it's working
and I mean I think one of the most
important things about this sort of
testing is I I hate people who /
document their code because it's very
hard to maintain since you have no way
of testing all of the comments and you
know you want it you want to be right
rather than giving misleading it's
better to not have docs that have docs
which are wrong absolutely it's so so
costly if you don't have that if you
have um wrong examples in there because
people write this side copy paste it and
then why doesn't this work it's seen as
in the docs it should work yeah exactly
if it's not I found it this was was
actually fun little project to work on
how to test the javadoc yeah so I do
have some kind of problem here well as
myself so you can see I've got some
issue with my javadocs as some
refactoring so I was doing this morning
so this hasn't even committed yet we're
living on the edge so there's some also
some munching going on here so that
actually gets the stack frame of what
went wrong because basically what we're
doing is taking this code right we're
wrapping it out of this file taking it
massaging it to get rid of other leading
asterisks getting into a big string
putting some before and after block on
to it I'm throwing it at the the groovy
compiler and we get back an exception
which is going to have a stack frame
somewhere in here so then what happens
is not having a fine being here so wrap
it when if you if you're interested in
looking more into this code for anybody
watching it's in the rat pack manual
component of this projects sauce test
maybe
what's that funky character that the end
47 if I do this closes the Javadoc
comment I'd some want to have commented
and comments so that's the HTML okay god
I think actually that the problem it is
as incorrect needed a semicolon there so
now we run it well spotted Steve yes all
right come here that counts is hacking
right yeah yeah cool good some what what
I was going to show is that there's some
like massaging going on to execute oh
thank you
is it something I haven't quite got
right yet but there's a when it gets the
exception takes the stack frames looks
at them and tries to rewrite them back
with the right information to point at
the right line in the file so as I say I
change this to be I don't know so that's
going to be integer what's a method
integer doesn't have food doesn't it foo
method run it should fail yeah yeah no
foo does the stack frame yes so I points
me to the red line which is also cool
because I've been making a bunch of
refactoring slatington breaking all
these examples and I just run this and I
get to update them all the other thing
here is that you know if your if
anybody's really paying attention say
this is groovy code right and we had a
method that doesn't exist and called it
and we've got a compile error so this is
actually using static groovy to do it
because if you're not using so that it
groovy then won't catch all the problems
right answer and that's the other thing
about rat pack is that the there's no
dynamic stuff going on it's all static
API so you can use full stop checking
and that kind of stuff so even with
these like nice concise dsl is still for
statically compatible cool call no
that's really nice so I think I think
that justifies you've you've done some
real hacking on the stream so we got to
give you your um your night hockey and
stick or hold us rissa nice can never
have too many stickers yeah Oh actually
I'm going to stick it for you do a stick
a trade
yeah so these are the little late
hacking logo sticker so it's um
transparent so like you can see like the
Duke edges are transparent and it's made
at a nice plastic so like later on if
you change your mind it actually comes
off without ruining a lot cool man well
here is your rat pack sticker oh that's
a nice logo it is I can't take any
credit for it at all again Rob Fletcher
thank you very much so yeah it's going
alright cool so um thanks very much for
making time that your busy schedule and
we'll have to what to make some time for
night hacking later second I mentioned
this earlier to you but I'm I'm gonna
start a regular TV show or every couple
weeks I'll be doing some some hacking
and then pull people in over Skype get
some usergroups involved it alot of
meetings at the same time so was I
thinking like um like what like trying
to contribute a feature to a project or
that kind of thing yeah I don't know so
we actually the idea would be to get
some may be an open source project or
something where we want to get people
hacking on it and at the beginning we
may be open up a github repo instead of
some examples and stuff and along the
way folks who are watching could
actually like contribute stuff nice be
cool it's like the distributed hecka
garden yeah yeah don't like it all right
cool well thanks again and enjoy the
rest of the dev ox offers tasty thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>