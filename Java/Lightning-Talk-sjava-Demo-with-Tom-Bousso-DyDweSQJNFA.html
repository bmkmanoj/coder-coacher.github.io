<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Lightning Talk: sjava Demo with Tom Bousso | Coder Coacher - Coaching Coders</title><meta content="Lightning Talk: sjava Demo with Tom Bousso - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java/">Java</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Lightning Talk: sjava Demo with Tom Bousso</b></h2><h5 class="post__date">2017-08-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/DyDweSQJNFA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I just want to talk a little bit
about a project I've been working on so
I call it a s Java so you might see the
next expression so it's Java with s
expression so you might be asking is it
a list is it scheme is a closure no no
it's fully static best expressions don't
exist after you compile right so here we
see the classic hello world example it's
basically the same as Java we can just
to run that real quick and we get hello
world okay now what Lisp is known for is
the macros right and so there's no
reason why we can't have compiled time
macros so let's just create this macro
here Mac takes in a T and then it
returns the system.out.println of T and
so we can replace this with Mac and we
run that and we still get our hello
world cool
now this micro this macro system it's
different than any other that I know
anyways because it's hygienic and it
gives you a lot of information about
where the macro is being called from so
for example we can add a print so
anything I typed inside the macro will
be run at compile time right so we can
run a print of mi mi stands for method
information method info and so we'll
actually see the method where the macro
is being called from so macros what are
macros well a macro I think about it as
a compile time function it takes in
tokens and it returns a token so this is
JVM LS so I figured I'd show some byte
codes so the macro is compiled as a
static method you can see Mac right it
returns a s Java compiler
lexpark spoken and it takes in a bunch
of stuff here this is the method info
this is the int that's for the hygiene
so if you have X in the macro and X
outside of the macro
they're colored differently based on
this in the handler which is how the
method is being compiled and the Lexx
parse token which is the key parameter
and so what the macro does is it creates
the token that that you want to create
with a lot of byte codes and then it
finally returns to that token and then
the compiler compiles that soaking into
the method so the little ASP we have the
block token which is what I call the S
expression and then you have the
standard stuff here : token with the
system.out.println and the hello world
okay so let's change this up a bit so
let's define a a variable here and so
now we're going to call Mac on this
variable okay so an interesting thing we
can do is we can run some type inference
on the tokens which are passed into the
macro so the macro is expanded as the
method is being compiled so it has
access to all of the information about
the method so if we run this now then it
will tell us that it's typed in so we
passed in a the token and it knows that
it's typed in if we change this to
change this to 3.0 it'll give us a type
double cool so this has some fun uses
for example if we were going to create a
for each macro so everyone knows that
arrays are a big wart in Java but we
still have for each right so if we
wanted to create a for each macro which
can loop over arrays and array lists we
just do a condition in the macro which
checks the type of the of the
collections that you're trying to loop
over and if it's an array we live using
the index and if it's not an array we
create an iterator and we loop over that
way so here we create a for each macro
and we do the for each either with an
idolater or with the index and if we run
this we'll see it prints 4 to 9 2 times
cool so some other interesting things we
might do we have a wave macro right I'm
sure everyone knows with statements
maybe from visual basic or something
like that so we can do a similar thing
here right so println is also macro just
the shortcut for system.out.println so
we do with ArrayList we're going to add
all these elements then we get to this
then we're going to set the first
element to L and then we're going to
remove the second element and we end up
with the 3 LM m7 and if we run this
we'll see 3 LM n 7 and of course it
supports the lambdas too so if we have
an array list here or rather a list and
then we create a stream we filter and we
have lambdas these are fake lambdas it's
just anonymous classes but we can use
the stream API so we're going to take
out everything greater than 5 so we'll
get the 9 8 9 and that works too cool
another little example so in Java we
don't have double dispatch right so
either you do visitor before you do
something ugly like this where you have
basically a switch on the instance of
check and then you cast it so that it
goes to the right method so the compiler
is also posting 4's Java so if you look
these are all the different compiled
methods for the different types of
tokens right so you have a compiled
method for the string tokens for the
field for the begins and all that and so
the compiler actually uses a macro
called double dispatch to generate
uj-- if for all of these different token
types and it's able to do that because
when the macro is called
it can access information about the
method which it was called from and in
the class which it was called from and
so it looks at all the methods which are
defined in the class and so it creates
the big double dispatch so that's kind
of cool you don't have to worry about
every time you add a new token type to
go back to the if statement okay so more
generally obviously I don't expect all
of you guys to start coding in s Java
even though I do like that it has s
expression syntax while it's still
statically typed and a good macro system
but more generally I'd like to say that
the only reason I was able to make a
project like this was because I used a
new bike code for bike code generation
and it offers many many abstractions
which you just don't have in azzam the
big thing is that if say you're writing
a compiler so you need to for example
you need to be able to know the
parameters when someone says
system.out.println you need to know that
system.out.println takes a string so
that if someone doesn't give you a
string then you throw an exception or
something like that so the new bike code
will unify the representations of
classes which you are creating using new
byte code so classes which are being
generated and classes which are already
generated so you have these class types
method field and so you can create those
for classes and fields and methods are
already created and then it'll use the
new java.lang reflect in order to give
you the same information I've been
working for a while on on changing new
bike code so it actually uses azzam
underneath and so I think that will make
it so that we can add a lot more
features to the new bike code and
whenever Azzam is improved then new bike
could we'll be able to be improved too
so I think that'll be merging in soon so
just this one little example in Adam if
we're going to push 2 4 2 4 4 2 4 2 so
we're going to need to write some code
which knows to pick the SI push because
we can't do a bi push with two four four
two four two sub range and then if we
want to do a return we need to remember
that the last thing we pushed was of
type integer and we need to do an eye
return so this is just a bunch of things
which if you're writing a compiler you
really don't want to have to think about
which instructions to pick to push an
int and then which return instruction
you need so in new bytecode you just do
any push in it'll automatically take the
best instruction whether that's the LBC
bi push as I push whatever else and when
you do an omit return the new buy code
keeps track of the back state and so
it'll know to pick the I return and this
this is for all of new bike code and one
of the things this allows new bike codes
to do is that it'll catch all sorts of
errors which with Azzam you would have
only caught say when you were verifying
the class file and when you're writing a
compiler it's really good to have it
crash the second that it does something
that doesn't make sense so that made
debugging a whole lot easier so yeah
overall a you know s expressions are
good and if you're creating byte codes
you should check out the new bike</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>