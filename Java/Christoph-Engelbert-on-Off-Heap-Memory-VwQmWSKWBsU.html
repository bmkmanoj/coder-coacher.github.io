<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Christoph Engelbert on Off Heap Memory | Coder Coacher - Coaching Coders</title><meta content="Christoph Engelbert on Off Heap Memory - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java/">Java</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Christoph Engelbert on Off Heap Memory</b></h2><h5 class="post__date">2014-03-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/VwQmWSKWBsU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright so welcome back 2nite hacking at
Java lens our next interview is with
Christophe engelbert Microsoft hi and
we're going to chat a little bit about
how to keep memory off of your heap I
think we have a demo to show and we'll
chat about various stuff so 10 first why
don't you do a little introduction for
yourself talk about you know what you're
doing okay um as you can see i'm working
fraser costs so we're doing some here
let me let me help your employer I love
you like they've got proper yeah
definitely upper promotion okay so yeah
I'm working for hazel cast we're
building a cluster solution environment
doing data partitioning over multiple
JVMs and all that stuff and one of the
topics we we work on as our fee as well
cool alright and you you gave a talk
here javelin sir yeah I gave a talk
yesterday morning about off heap and and
how how to keep your data off the heap
and stuff yeah so I suddenly ask you why
why would you want to keep your data off
the heap oh I'll give you the new be
prompting question yeah so um that's a
very common question actually it's
either you have a lot of pressure on the
garbage collector and you want to lower
the pressure or you have a lot of data
that that have midterm life's a lifetime
so they're not dying in Eden or
survivors basis but you won't don't want
them in general space or they just don't
fit into a normal size of heap like 1623
gigabyte whatever something like that so
it sounds like the two basic
classifications would be things where
you can't get good garbage collection
yeah kind of because it doesn't fit into
the standard model or really really
large memory yeah right so memory sizes
up to 2 500 gigabytes that kind of stuff
that's a lot of ram it depends on the
company you're working for ya know I
guess most large servers probably have
that much memory but then they're
partitioned into a bunch of virtual
instances
ya ready different things right so if
you ought to take advantage of the full
server hardware then yeah right we
either have the chance to run multiple
virtual machines and inside of a cluster
using for example I so cost yeah so
splitting up your heap size or you're
going off heap and have one big machine
and cool okay so let's do a demo yeah so
um yesterday I gave a short presentation
and the demo demonstrates how to prevent
garbage collection problems so there's
let me find it there it is there's a
small example it creates 50 million
objects one time on the heap 50 million
objects with I guess four gigabytes of
paper I said something that and you're
suffering from from big garbage
collected problems you can do the same
off heap we will show that later so
first let's run the unhip example and
you will see on times that it has a very
very big amount of time consumed
sometimes there is 6.2 seconds goes up
it goes bit down due to the JIT compiler
so 552 so in general you can save about
five seconds so if we do the same if we
stop it and do the same off heap you can
see that it is much much faster oh ya
know that so it's a rap about one second
maybe I mean is this is kind of a micro
benchmark but it's it's it's a it's a
time of a kind of pretty playing with
the garbage collector so creating more
objects in the garbage collector can
handle in a good way in that case but
yeah you see the problem if you have a
lot of data and you need to have some on
he pits maybe a problem so what is in
this case it's it's pretty much easy
stuff we get some misc unsafe
and we're allocating a bit of memory I
know the size of the object I want to
store and one more object does it just
rights to the base address and rights in
memory directly write the data directly
to the memory cool yeah so that's a nice
alternative to putting stuff on the heat
for special cases would you recommend
people start with doing off heap stuff
or use this as like a performance tuning
stage I'm like wait until they're trying
to tweak or two there so I would mostly
never tell people to do their own off
heap stuff yeah it's pretty much very
hard for and and it's very simple stuff
like there are awesome frameworks out
there food for doing this like hazel
cast elastic memory like to recall a big
memory all that kind of stuff a pet you
directly you guys probably created this
for your own needs right that's it
internally at hazel cast yeah we'd
created that internally we're pretty
much out there for 4 version 2 of a lot
of people implementation so with the
next version of hazel cast we have a new
one and we hope it's even better so as
all sad it's hard to do it right and
even we need a second approach on on
this one to make it better nice so for
folks who want more references about um
the own feet of implementation by hazel
cast or a little bit about what you're
doing where should they where should
they go to find more information about
hazel cast it'sit's IVA hazel cast calm
or hazel cast a dork so when we're not
only doing our fate as I said we're
doing mostly data partitioning over
multiple JVMs it feels like one hashmap
but it is spread over multiple jvms and
you can get your data all cool all right
thanks very much for the short interview
Christoph yeah no problem and for those
of you here at Java lands the next
interview is going to be at 145 and it
will be with burns Mueller on bytecode
class loading and transformer so
stay tuned for that in the next 45
minutes and thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>