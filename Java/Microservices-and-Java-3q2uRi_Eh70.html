<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Microservices and Java | Coder Coacher - Coaching Coders</title><meta content="Microservices and Java - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java/">Java</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Microservices and Java</b></h2><h5 class="post__date">2016-07-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/3q2uRi_Eh70" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so hi Vinicius thanks a lot he with
us thank you everything so you give it
talk about micro service can we just
start talking like having a very brief
discussion about micro service is and
why it's important all right
so micro services is another
architectural pattern that is emerging
in the latest years in the basic idea
behind it is to decompose the existing
systems in his Mahler parts or build new
applications based on services that will
compose together functionality right and
everyone says that you know once you're
doing micro services we have we have a
track here today talking about DevOps
right and you know once you decompose
your application or you start a new
application with several services
running it's it's reasonably more
complicated to deploy your montane to
keep those things up and running
everything so can you actually do micro
service by hand or you have to automate
a lot of things and have to do DevOps
really you can't do that by hand but
it's gonna be always more difficult for
you to maintain an application like this
right so DevOps and micro service is
they walk together because if you have a
good divorce culture in your team like
automating everything developing micro
services and adding new services becomes
easier for you right so you have this
question that everyone you know
Microsoft's like this big buzzword right
now and so a lot of times when you talk
about micro service you have those guys
that you know they have like a large
monolithic applications that they still
have problems in deploying you know they
can't they they don't have the whole
thing automated if you have problems of
deploying these you have problems of
doing uh you know a zero downtime
deployment for example and then they say
oh I'm gonna do micro service so that's
just gonna get even crazy right yeah you
always have to evaluate if you need to
use micro services or not mm-hmm because
of course it's more easy for you to
deploy a single application right now
that's kind of the right complicated
part right yeah now what are the
benefits of Microsoft what if you
actually do something Microsoft's you
automate everything
why that's better well there are several
there are several advantages you can
point out one is you don't need to be
tied to a single technology if there is
one part of your system that could be
built using another technology which is
more appropriate for solving that
particular problem you can do that if
you take impose your system in separate
parts another advantage is that
different micro services they could have
difference across functional
requirements for instance scale is
scalability or you know performance or
security so you can deal with that when
you have this separation and another
advantage that I like a lot is that you
can build separate teams to be
responsible for separate services and
they can manage smaller applications
better because they are separate very
smaller and so that you can build faster
and with more quality right so so what
come first do you decide the
architecture first and then you divide
your team in smaller teams or once you
have like a distributed team it's easy
to do an attribute architecture which
one is well that's an existing
discussion there's no like a standard
answer for that there's a lot of
discussion even between Martin Fowler
and Sam Newman who were guys that have
been talking a lot about microservices
nowadays so usually in most of the
places I have seen people dividing teams
by bounded context and bounded context
our business concepts that will define
what is a micro server see what is a
micro service in your domain so when you
define this bonded context it most of
the times it makes sense to have a have
a team with that business knowledge and
with the capability to develop their
application as a service but there are
variations on that there
there are some places like in SoundCloud
I've heard that people are building
teams to build features and those
features could like be built across
multiple services so it depends really
depends on your context and what you're
trying to achieve okay that's pretty
cool now I see that you have like a
little demonstration or something to get
in can you make sure you go to the demo
a little bit so we're gonna show here
some like some micro-services yeah so
I'm real the real thing yeah let's do it
alright so Microsoft's run up and Ronnie
let's go so the talk that we gave on
Tuesday was about a new architecture
developed based on micro services and
events or C so if you are used
you
we have like bi analytics requirements
we have a lot of requirements for
auditing and compliance and legal
reasons
so although those requirements forces
forces us to come up with a different
architecture for this okay so the idea
of this architecture is using the
concept of event sourcing which is
everything that happens in the system
you're gonna you're gonna persist in
your database as a as an event as a
domain event and then you're gonna have
listeners that will listen to that event
and then we'll keep global consistency
in your system so that changes a little
bit how micro services they communicate
traditionally if one service depends on
information in another service that
first service will have to arbitrarily
send an HTTP request to fetch data or at
least have a cached version of the
information it needs in that event
sourcing model we're gonna polish events
to the an event bus and every service
which is interested in that event will
have a listener to react when that event
happens okay so the difference now is
that services they are totally the
couplet they don't need to know about
each other they only need to know about
this the events that are in the bus
right once for instance here's a diagram
and I'm sure you can do all lots of cool
things right yeah like like put events
one after the other or multiplex events
two different services I mean so that's
a much more interesting architecture
than just kind of exactly accessing
directly okay so yeah like you said you
can you can do a lot of things a lot of
the interesting interesting things from
the point of view of the architecture so
in this diagram you can see that the
service one is publishing an event and
the service two is interested in that
event and the only thing that the
service two needs to know is the event
is the event structure the
payload and how to deserialize that
event it does not matter if the service
one is sending that event or if the
service 10 is publishing that event and
you can even change who is publishing an
event and it doesn't affect the other
applications which depends on that data
okay so this is pretty interesting and
makes the architecture really open cause
in a sense that you can easily add and
remove things without too much of impact
that's pretty nice okay yeah that's
that's that's uh things are much better
much more scalable much much easier to
manage an architecture okay yeah so
another thing that we should keep in
mind as well is that there are some
challenges on this model too right so
the idea of the idea of the event store
for instance when you save events to
your event store you never change when
event that happened so that's immutable
and it's immortal you cannot delete an
event from the event story and that
imposes you some challenges what if you
wanna add an additional field to an
event so what happens with the old
events in your events alright so we need
to come up with a way to map all the
events to new version of the events and
there is another thing which is what
happens if you have a lot of events in
your event store and it takes a long
time for you to load up everything in
the current state of the application so
we also have to think about that and
come up with snapshot strategies and
like indexes and ways to improve the
performance in that in that sense ok so
another challenge also the event buzz is
kind of like your bottleneck here right
yeah that too
another challenge is that if you have a
lot of events in the event was that kind
of make the listeners to wait until we
have like batteries to process the
events right so those are those are like
drawbacks in this architecture but if
you can handle that
those drawbacks in a way that you can
still deliver good quality software I
believe it's a good it's a good approach
to take ok that's when I so so
do you intend to show something runny or
just you know because you have I see
there you have an IDE in the back yeah I
can write and show you some code all
right so let's let's take a look at the
code or how to do this okay so when you
have any event sourcing architecture
everything will happen a synchronously
so I'm gonna show you an example in Java
here and this is a spring bootie
application so you can see here it's
just a this is just an example based on
like an order and are there items and
then you have a controller here and I'm
gonna show you an example of creating a
new event okay so there's the concept of
commands in event sourcing and commands
were generating events when you when you
handle that command and process some
business logic so controllers in this
architecture will create commands for
the system to process so here for
instance we have a create order endpoint
and that create order endpoint will
create a new create or their command and
that will contain the data needed to
create a new order so we have a common
gateway here which is another command
bus it's like the event bus for a but
for commands and for every command you
have into this architecture you have
also a handler for commands so there is
the create order command and we have
create or their command handler right so
another important concept events or see
are the aggregates so we have the
repository of our targets and what the
command handler will do here is to load
the aggregate from the database the
meaning of that is to rebuild the
current state of the application based
on the events that have already happened
okay in this case we don't have any any
event and even start array ready because
we are just create a new order so we're
gonna create this order aggregate which
is just with just an object that handles
your rdid
and the other items
okay so when you call the constructor or
have this apply method and dissapoint
method what it does it saves a new event
to the event store so the new event here
is our the created event so we we run
some business logic here just for
validation and if everything goes well
we just save the event to the event
store and that gets automatically
published to the event was and once this
event is in the event
you
the abstractions needed for implementing
an event source system so we've been
using that in my current project and it
helps us a lot to save us from writing
code to adapt to create the event star
to handle the comments and events and to
have the concept of distributed commands
handler command gateway and an event bus
so he saves us a lot of time by
providing those abstractions and and
capabilities for our already so that's
the basic flow of the event sourcing
data you know the data flow of the event
sourcing architecture and another
interesting thing that we use in our
system is CQRS security this is a
pattern it's it it means like command
query responsibility segregation so the
goal here is to have a separate model
for writing data to the system than the
model for reading data from the system
why would why we need that because it's
really hard to read and perform joins
and complex squares in the event star
because it's just a sequence of events
okay so based on the events that happen
we kind of build projections with which
is the query database okay so in our in
our case for instance we have usually a
an Oracle database to save all the
events and you also have a projection
that could be in MongoDB or could be
another sequel database and sometimes we
send some events to Hadoop in order for
us to perform VI in analytics analysis
and stuff like that so secure s is an
important component in this then you
decide watch what are the events that
you want to save on these to analyze
later yeah exactly
alright and that's pretty much it if you
want know more details about events
sourcing I recommend one author which is
called Greg yang this guy is talking
about events are seen and securest a lot
lately in conferences
and I've been following him and I
recommend you guys to take a lock on it
on his work it's pretty interesting okay
that's pretty nice so thanks a lot of
any issues that was really great and he
just switch back here Thank You Bruno
really great and I think that's so so
one quick question you know do you think
that developers in general is is this
the right time for them to start
learning micro-services even if their
companies are not interested right now
or they should kind of wait a little bit
until things are a little bit you know
for some developers are you learning
because they are in the bleeding edge
but like if if if the developer the
company's not interested in maker
service right now is there something
that people can start doing to
modularize some parts of the application
or tests or or like rated some small
micro service that that that work
together with existing applications just
to experiment or not the time yet well I
would say that micro services are
becoming and standard lately because
every time you have an application which
is large enough for you to have problems
adding new features on it maybe it's a
good time to think about dividing it in
about that context right so even if you
were working on a corner on a project on
a team which you do not have micro
services maybe at some point this is
always an opportunity for you to
question your current situation and see
hey would we get some benefit dividing
this large application in smaller pieces
so this is always a good thing for you
to do right so I highly recommend
everyone to take a look and I also
recommend the sane human book I recently
read that book which is really good
because it gives you a overall context
on micro services and ways to accomplish
it fast so yeah I think it's a good idea
excellent okay so that's Vanitas gamma
is thanks thanks a lot thank you Bruno
thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>