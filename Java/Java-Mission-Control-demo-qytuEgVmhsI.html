<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Java Mission Control demo | Coder Coacher - Coaching Coders</title><meta content="Java Mission Control demo - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java/">Java</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Java Mission Control demo</b></h2><h5 class="post__date">2014-08-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/qytuEgVmhsI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">one of the features of Java SE advanced
is Java Mission Control this facility
gives you the ability to monitor profile
and troubleshoot java applications hi my
name is James Weaver and I'm a Java
technology ambassador for Oracle
Corporation I'd like to talk to you
today about Java Mission Control Java
Mission Control was built for monitoring
profile and troubleshooting Java
applications and consists of two parts
one is JMX console and that's for
monitoring in real time and then Java
flight recorder is for collecting data
over time and then also you can have via
plugins some optional tools that do heap
dump analysis and DTrace recording
here's an architectural diagram
essentially Java Mission Control talks
to a JMX agent which has an M beam
server that then talks to the built-in
VM and instrumentation and app
instrumentation built into the JVM some
fun facts about flight recorder is that
there's an almost unnoticeable impact on
the performance of a java application
the overhead is usually well below 1%
and that's because the high performance
recording engine is built directly into
the runtime also this is very important
that in order to do flight recorder to
JVM startup Flags have to be enabled in
the JVM for which you want to do flight
recordings and here they are you'll see
that in just a second so let's take Java
Mission Control for a spin will invoke
it from the command line using the JMC
tool that's in the jdk in the bin
directory and that will come up with the
welcome screen when you do it the first
time and I'll go ahead and click here to
start using Mission Control and then
we're going to go back to the command
line and start up an application that we
want to monitor now because we're going
to use flight recorder eventually on
this we're going to go ahead and put
those command line
parameters in there the name of the
program is load in deadlock so now we'll
see it show up in the running VMs here
we'll go ahead and start JMX console to
be able to see things in real time so in
this overview tab we have some gauges
that show various attributes and we
could swap out these gauges if we want
to we could delete one and then say
instead of showing live set we could
show things like maybe system CPU load
also we have some charts down here and
we could add some attributes to the
charts maybe you want to show committed
Java heap in this tab we have an M being
browser so we can see all sorts of
attributes that are available with M
beans for example if we wanted to look
at memory pool the old gen and then look
at the usage threshold and maybe even
set a new usage threshold maybe 256
megabytes we could certainly do that
then we'll look at triggers if I want to
be alerted when something is out of a
range that I set then I could go ahead
and set an alert here we'll do CPU usage
if it's too high and we'll say 10% here
and so then it triggered the alert we
could click on it to find out more about
the alert now I'll go ahead and set that
maximum trigger value to something
higher so we don't get the alerts as a
matter of fact go ahead and turn the
alerts off for that particular attribute
then system we can see lots of
information about the system and we can
even query information here for example
finding out all of the properties that
have the word arch in them the next tab
is memory and up here there's a heap
histogram button so I can get a heap
histogram and then I could click it
again and then get a Delta between them
also I could do a manual garbage
collection
by hitting that garbage collection tab
now we could see the threads in this
load and deadlock application there are
some deadlock threads so we can find out
what those are by clicking deadlight
detection and then sorting on the
deadlocked column in addition we could
add some columns to the table we'll add
one called lock owner name that will
allow us to then find out who the lock
owner is of the deadlock thread also we
can click allocation to find out how
many bytes were allocated to that thread
as well as CPU profiling to find out CPU
usage information about the threads and
then we have some diagnostic commands
for example if we wanted to print the
current thread we could just click that
and click execute so now that we've
explored some of the things in the JMX
console I'd like to turn our attention
to flight recorder so I'm going to close
this out and on the same program I'm
going to right click and say start
flight recording and for brevity I'm
going to go ahead and just say 10
seconds of flight recording and we'll
start gathering the information flight
recorder gathers of the information and
we'll display it and in that information
that it displays there will be different
tab groups so here's the general tab
group that shows those same gauges as
well as CPU usage and heap usage and
we'll see the CPU usage chart here also
notice above up here there's a range
slider so maybe I'm not interested in
everything in the recording but maybe
just in a certain range that changes the
range that the information reflects
there are other tabs down here tab
groups down here as well as events and
events allow you to do data mining on
events that are happening in the
application as well as in the virtual
machine and operating system
and I can see the events that are logged
and get graphs of them and things like
that now I'd like to walk through some
troubleshooting and profiling scenarios
using Java flight recorder I've taken
the liberty of gathering some flight
recording data on a couple of
applications the first one is called hot
methods and as you can see in the
general tab the CPU usage is saturated
and so we suspect that it's taking too
much time in a particular method so we
could go to the code and find out that
we're taking a lot of time in the linked
list class percentage is 97.3% we can
drill down then and see hot methods and
then we can also examine that using a
call tree and it turns out that we're
using a linked list in this application
which has unique values and so in
finding something in the linked list it
takes a proportional amount of time and
so we just change that to a hash set and
improve the performance so that's Method
profiling another scenario is latency
profiling so here's another recording
from a different application in which we
see that it's not CPU bound but we do
suspect that there's some latency going
on so we could go to threads and find
out that yes we do have for a one-minute
recording we have 15 minutes of waiting
and the average weight is three seconds
so then we could go into lock instances
and find out what's going on find out
there's a lot of threads but only one
monitor instance and we can take a look
at the stack trace and see that we've
got a locking problem so then let's go
to events and take a look at a graph of
what's happening and we can see that we
indeed do have a locking problem let me
go ahead and drill in
so we can see that more easily and we
can see that these are the the critical
regions and only one threat is being
allowed into critical region at a time
if I compare that to after it was fixed
I can see that more than one threat at a
time is being let into a critical region
I hope you enjoyed this brief demo of
Java Mission Control including how to
use flight recorder for various
profiling scenarios to improve
application performance</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>