<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>iOS 9 Purify Content Blocker + VWO Fix | Coder Coacher - Coaching Coders</title><meta content="iOS 9 Purify Content Blocker + VWO Fix - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Wes-Bos/">Wes Bos</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>iOS 9 Purify Content Blocker + VWO Fix</b></h2><h5 class="post__date">2015-10-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/oiLBi6YGSDo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone was here I just got
finished wrangling a bit of a weird bug
and it took me a little bit to figure
out what was going on so I thought I'd
make a quick video just to detail us and
hopefully save you some time if you run
into the same bug so the issue was that
uh we had a website that was just not
loading at all on iOS 9 and it was
loading for some people and we we
figured out that it was because some
people were using the iOS 9 content
blocker and it should normally just
block the ads on the website but what
was happening here is it was actually
blocking the entire site so the the site
just wasn't loading at all so my debug
process and I just have one of them up
here where I I sort of got it down to
the test cases I have just some content
on the thing and then this here if you
ever seen visual website optimizer it's
just a be testing which will figure out
like what color buttons you can use on
your website and how you should lay it
out which is kind of interesting and if
you want to block it that's totally fine
but the website should still load
without it so um I have a little test
case here and I open it up on my my
phone right here and it just is blocked
entirely so I open up the Safari
devtools here I opened it up and it's
great it tells you right here content
block or prevented frame displaying dev
visual website optimizer calm before it
/ blah blah blah that's cool you go to
your body here and you'll notice that
they put opacity 0 filter in background
at first I was like well the content
blocker shouldn't just block the entire
website should just stop this but what
was actually happening is that the
visual website optimizer code that it
puts in here what I did is I unmiss
obeyed do not edit below this line and i
went ahead and edited it so let me just
comment out the that part and bring in
the unmanifest so I can see what this
code was actually doing and the way that
it works is that when the page loads it
really quickly creates a style tag to
create element style and it says body
opacity 0 alpha opacity 0 background
none so what it does is it hides the
page while it does
it's sort of swapping out so if it's
going to change the color of button
you're not going to see any flash of
text which is great however what happens
is that it hides it and then it loads
this dev visual website optimizer calm
and then when it's done doing its thing
it goes and runs this finish function
right here which will get that style tag
that was hiding everything and actually
remove it so it's it's hiding the page
doing its changes and then showing it
again but the problem was that the it
would hide it it would try to load
visual website optimizer and then the
call to finish what would happen is the
finish would be called inside of this
script that it would load and since that
this script is blocked it would never
actually call finish so that's okay they
thought about that and there's this
little thing called the settings
tolerance which after you can set this
to two this is two seconds maybe you
want that to be like half a second after
half a second if something goes wrong
and this script doesn't load then what
should happen is it should just show the
initial website you should just fall
back to the regular website which is
what we want in the case of a Content
blocker we just want the regular site to
load and it doesn't look like we can do
an a/b testing on this particular person
however it just wasn't running at all
because you can see right here setting
timeout vwo code finish it was going to
call finish but it never set the
variable F which i found out that is
called finished if it's set to true then
it will actually go ahead and show the
website but f was never getting set to
true which meant that the website was
never actually loading because i'm
assuming inside of this script again
that f variable is being set to true so
unfortunate tip for us so what all quick
fixes all you have to do is just well I
can go back to here and you can just
take this if statement out which will
just make sure that after two seconds is
just going to remove it entirely
regardless of if
worked or not so I gave that a save and
I'm going to go up to my content block
or here and give it a refresh and you
can see that after that 500 milliseconds
or after if I jack it up to two seconds
of loading and probably shouldn't be
that high but you'll see that it's blank
blank blank and then it actually shows
up after two seconds because it's it's
still being blocked which is ok you can
see it in your console here but at least
the people can actually see the website
so hopefully it won't lose as much time
as I did on that and let me know if you
have any questions thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>