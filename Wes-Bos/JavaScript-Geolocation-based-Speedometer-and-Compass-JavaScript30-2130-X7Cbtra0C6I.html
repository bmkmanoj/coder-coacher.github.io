<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>JavaScript Geolocation based Speedometer and Compass - #JavaScript30 21/30 | Coder Coacher - Coaching Coders</title><meta content="JavaScript Geolocation based Speedometer and Compass - #JavaScript30 21/30 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Wes-Bos/">Wes Bos</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>JavaScript Geolocation based Speedometer and Compass - #JavaScript30 21/30</b></h2><h5 class="post__date">2017-09-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/X7Cbtra0C6I" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">today we are going to be learning about
geolocation and not just getting the
latitude and longitude with geolocation
although we can do that if you like but
there is also information that comes
along with geolocation and that is the
heading which is essentially like a
compass in which direction from or how
many degrees of north is the person
currently at and it also will tell us
the speed at which somebody is is
running which is kind of cool in chrome
we can fake coordinates but we cannot
fake heading and we cannot fake speed so
really the only way that I've found to
do this so far is with the iOS simulator
and if you don't have a Mac you might
have to sit tight on this one or you can
run it on your phone and then start
running down the street to actually test
it because you need some real data to
get it going
so I've downloaded Xcode here and if you
don't have a Mac and maybe you can do
with Android I'm not totally sure you go
to Xcode open developer tool and then
simulator and then you can change the
hardware from hardware device iOS 10 and
then you might have to download some of
these things first I've got to open on a
iphone 7 plus now the next thing is just
like our last two you cannot run access
to users web cam to the microphone and
now you cannot access their fuel
location unless you are on a secure
origin and that hasn't been a problem
for us so far because what we've been
doing is we did our npm install here
which will install just that browser
syncs and it will do an NPM start for us
now
that will give us a local host which is
a secure origin but because I want to
open it up on a different device we're
going to it's going to give us a
external IP address or internal IP
address sorry it'll say HTTP 191 6 8 1
dot 107 and that is the address that we
need to visit on our devices now browser
sync ships with what's called a
self-signed certificate which allows you
to have HTTPS on your computer it's
still going to throw this really scary
warning but
that's because it is a self-signed
certificate and it doesn't trust it so
you have to go to advance and you have
to proceed to the localhost in order to
get that to work it's still going to
cross us out but that is standard for
getting it working on your local
computer so what we want to do is
actually copy this HTTP here open up
your Safari on your simulator here and
visit that website now it's going to
yell at you that this is not a trusted
cannot verify the identity you want to
click on continue there and then it's
going to serve it over in a secure
origin and then we go to our index s
finish to see where we got now it's
going to ask you can you access your
location say yes I want to have access
to that location ask me a second time up
and there we go so what's happening here
is that I've gone to my simulator here
you go to debug location and you can
select a number of different John's so
this is simulating somebody running
having a bike ride at the Apple campus
walking around I guess or if we freeway
drive and it's gonna simulate updating
the location as well as the actual speed
that's why we need to use this iOS
simulator in here so that's how that one
works but we want to go back to our
index - start one other thing you might
want to do is to open up Safari and the
beauty of Safari is that you can take
Safari you can go to develop you can
find like this is the phone that I'm
using right now but you can also have
your simulator and you can see you can
open up dev tools for whatever is that's
currently open on your phone or in the
simulator that's pretty cool so that's
going to be helpful to have that console
window open for us just in case we need
to see if we have any errors now so
let's go back to our script tags here
and let's get going with coding this
first thing we need to do is to select
both the arrow which is this right here
and the km/h that we are running on so
go to our script tag here Const
equals
Dr Manette query selector diary do the
same thing for speed now that we have
that we need to listen for the users
position so we access that on navigator
dot geo location dot and now there's two
ones here there's watch position and
there is get current position
we won't watch position because get
current position we just give us the one
and watch position is going to just
watch it over time and it's just going
to give us data as frequently as we need
it the person's not moving around too
much it's going to give us less frequent
updates if the person is flying down the
highway it's going to give us a lot more
frequent updates so we have that data
that comes in here and it's going to run
a function and let's just come to log
the data to see what we've got and give
that a save it's gonna ask the user
location and then I'm going to open up
my Safari dev tools here and here we go
look at this this is data that's
streaming in and this is giving us this
geo position and we got bump the size up
here inside of that we have a timestamp
as to when that happened as well as
coordinates for what happened so here
we've got accuracy and I believe that is
number of meters it is accurate - we've
got heading this is really good so that
is the number of degrees relative to
north that we are and then we've got the
latitude and longitude - where they are
you could put that on a map if you want
and then speed and that's coming in at
km/h so if you're some weirdo from the
states that uses miles you got to do the
math but us the rest of the world will
use kilometers now we've got this data
here and what we simply have to do now
is we can update it so we say speed dot
text content equals data chords dot
speed now I want to refresh that sucker
see that we're automatically seeing this
and if you wanted to you could pop any
math dot round and that would just give
you
34 I find that it doesn't change very
often so you're not sure if it's working
or not
so I like to keep the decimal places
there just so that we can see exactly
how fast they're changing that's good
now what we need to do is rotate this
compass right here which is our arrow
depending on where we are and we simply
just take the arrow and we apply the
style dot transform this is just a CSS
transform and that's going to be rotate
and normally be like 20 degrees let's
try that so you see what happened that
it rotated 20 degrees but we don't want
to rotate at 20 degrees we want to
rotate it the data chords dot heading
and that is the number of degrees
relative of north and it's already 360
based so you don't have to do any math
on that so give it a save and now you
see that this thing is slightly turning
depending on where the person actually
currently is in their jog and it will
just tilt itself as we go along last
thing we need to do here is if someone
this right here is called the success
callback so when someone successfully
gives you access to it this will run but
what happens if they say no then what we
have to do is run a new function here
which is our error and we'll just
console dot log or console dot error
that error message and then maybe like
alert to the user hey you gotta allow
that to happen
or whatever is and then you have to
display instructions to the user on how
to re-enable it if they've blocked it
from happening it's not a save
browsersync we can switch it around
change our location what's going to run
instead or going a lot slower you know
there's a lot more turns in something
like that so that's pretty cool you can
look at the latitude and longitude
inside of this data at Accords if you
like maybe if you want to try do a
Google map but this is a framework a
free series so there's not too much we
could do with the latitude and longitude
hopefully you enjoy that and I'll see
you tomorrow
[Laughter]</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>