<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Custom HTML5 Video Player - #JavaScript30 11/30 | Coder Coacher - Coaching Coders</title><meta content="Custom HTML5 Video Player - #JavaScript30 11/30 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Wes-Bos/">Wes Bos</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Custom HTML5 Video Player - #JavaScript30 11/30</b></h2><h5 class="post__date">2017-09-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/yx-HYerClEA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">today we are building in html5 video
player if you've ever tried to style the
default video player you'll know that
it's really not all that possible if I
take a look at what the video player
looks like by default this is currently
what it looks like in Chrome but that
changes sometimes as well as it's
different from browser to browser so
this is what it looks like you get some
basic controls you get to be able to
scrub the video you can change the
volume and full screen it and as well as
other couple other things that happen
now what we want to build is this
totally custom interface where we're
gonna hide the controls and we're gonna
build our own interface with a button to
pause and play it there's going to be a
button that this just does the volume a
slider this is going to speed it right
up so it goes much faster it's gonna
bring it right down to be nice and slow
as well as we're gonna have these nice
little skip buttons that allow you to
skip forward 25 seconds let's get back
10 seconds and finally when you click
the video itself it will pause in place
there's a whole bot on here and at any
time during this tutorial and what I
want you to do is just pause the video
and try to like maybe tear off like just
doing the sliders or just doing the
scrubber or just doing the skip buttons
and and see if you can just get a couple
features on your own and then come on
back and join me for the parts that
you're having trouble with so I've
already done some CSS for you and it's
really not all that much going on here
it's just going to be it's gotta take my
the autoplay is annoying you take this
little off what was I saying I've done
some CSS okay I've done some CSS sorry
this is hilarious bunny is getting me I
the CSS has been done for you but
there's really not all that much here
it's just a bunch of divs and then when
you hover over it I just transition the
position of that div up and down up and
down depending on where we're at what we
have here is we've got ID of the class
of player this is the video element that
we're working with and then everything
below it
is just HTML that we've built for the
control so we've got a progress bar here
inside of that we have a filled I've got
a player button here that we're gonna
pause and play there's an input for the
slider which has a min a Max and a step
which is how much it's going to
increment each notch on the slider same
for playback rate and then I have these
skip buttons and I'm going to talk a
little bit about why I chose to use data
skip in just a second so this one's
pretty big so I'm not just gonna stick
it in a script tag here we're actually
going to put it in a separate script CAS
file that we're going to be working in
here so let's get going first thing that
we need to know is there's gonna be like
pretty much three pieces of this first
we're gonna get our elements and then we
are going to build our functions and
then we are going to hook up the event
listeners so let's start with getting
our elements on the page there's a whole
bunch that we need here we're going to
first get the player so const player
equals document dot query selector dot
player and then inside of that player
because that's sort of like the the papa
div here inside of that is we're gonna
grab everything else so we need the
video itself and we're gonna call player
dot query selector and inside of that
we'll look for the dot viewer because
that's the class that that video has
right there okay working good so far
other things we need is the progress bar
the progress filled the toggle the skip
buttons and the player slider so i'm
just gonna blow these out real quick
otherwise you can just grab them from
the answer i'm sure you understand
what's going on here
we're just selecting elements from the
page if you'd like to see me type them
i'm sorry but we've got them going right
here so we've got our progress bar and
i'll explain exactly what all of these
are next what we want to do let's just
start easy and work with the toggle
place we're going to have a fun
called toggle play and when that is
called
we are going to either call dot play on
the video or dot pause so what we can do
is we say if video dot paused because
paused is a property that lives on the
video there is no playing property
there's only a paused property and we
will say video dot play else video dot
pause good so now if we open up our dev
tools here and call toggle play you'll
see that starts to play if I call it
again it's going to pause it one little
thing that you could do here is you
could say Const method equals and use a
turn turn a turn dreary operator I don't
know how to say things play otherwise
pause and then because the method name
is in a string here we can simply just
call video access the method name and
then immediately call it some people
don't like that because they find it
hard to read don't send me angry mail
just don't use it if you don't like it
but that is sort of a way you could even
just put this sucker right inside of
here if you want to get really crazy but
we're not gonna we're not dipping down
there let's just double check that this
the works working good for me okay so
that's our toggle play now what we need
to do is hook it up both to when you
click the video as well as when you
click this button so first we're gonna
go down to our hook up our event
listeners and it was a video to add
event listener click and when that
happens we are gonna run toggle play
good now let's try it out click it's
going it's going click it again it
pauses on and off on off good next we
want to hook up this button right here
so what did we call that button that is
the toggle button so say video or we can
pretty much just duplicate that line and
switch out the tall
out of endless inner click toggle play
there we go it's working for us you
notice that this button here isn't
changing and for that we need to update
the actual text of this button inside of
here so one way that we can do that and
you might think okay we'll do that in
here where we'll we'll get the button
and we'll say dot text content equals
and figure out whatever the play button
is but the better way to do that because
there are other ways that you could
pause the video other than clicking on
the video and toggling it sometimes
people have plugins sometimes people
have like maybe you want to pause the
video of a pop-up opens so rather than
hook into this toggle play function what
we want to do is listen to the video for
whenever it is paused so whatever causes
it to pause then we can just update the
actual buttons right here so what we
could do is we will go to our video and
I'm gonna group these together video to
add eventlistener
and we're going to listen for play and
when that runs we are going to make a
function called update button and
console.log update the button will just
call say that so take that update button
when the video is played run update
button and when the video is paused or
pause is the event sort of like click it
will also run so now if I click it see
what's going on here
every time I click it it's going to
trigger a play or a pause event which
will in turn run our update button
function so if we go inside of our
update button function you'll say Const
icon equals and we simply say this dot
pause and why can we use this in this
case because it's bound to the video
itself this stop pause if that is true
then we will put the play button
in there otherwise we will put the pause
icon if you need to grab these icons you
just grab them from the answer file and
then we take that icon and we say
toggle what's what's toggle well if we
go up here toggle is our toggle button
which is this button right here has a
class of toggle good so I'll say toggle
dot text content equals icon or again
yes you could take this and just slap it
right inside of there I'm just gonna do
it in two steps and that should be it oh
oh error on line 17 what did I do
I got two question marks what a silly
thing to do here we go Oh doesn't seem
to be working let's debug this real
quick console.log it ran okay it's
running now let's console.log the icon
you know what there's no property called
pause it's paused uh there we go now
it's up and running it's working and
then if I click this button itself it
will also but if I also just call it
from the console video or is it viewer
no I think it's it's a video which is a
video and if I just call video dot play
on it it's gonna start playing but look
haha it's worked if I call it again or
call dot pause it's updated the button
for us so you see how we we didn't have
to hook into this function we simply
just listened for the event good what
should we do next year we got the play
button working let's do these skip
buttons here so we're going to make a
function called skip and what we then
need to do is understand how much it's
going to be skip the way that I like to
define how much the video is going to
skipped is to go to the actual Dom
element and let's look at these skip
buttons that way you have here and they
have a data - skip - 10 which means is
gonna go back 10 seconds and a data skip
of 25 which means they're gonna go
forward 10 25 seconds and I really like
this approach because that means I can
put a data - skip on absolutely anything
it could be a picture of myself and when
you click my face it will skip to the
end because you don't want to see at all
so we can put a data - skip on
absolutely anything and that's the way
that it's going to work
so before we run the Skip we'll just
console.log skipping it'll held down
here and we'll listen for a click on
anything that has a data - skip now
let's look at the top here skip buttons
is equal to anything that has a data -
skip attribute which is why I said you
could put a data - skip on absolutely
any element so we'll say skip buttons
for each button button add eventlistener
and we are going to be listening for a
click and when that happens we are going
to run the Skip function good let's try
it out
skipping skipping skipping now what's
cool about that is instead of console
logging skipping let's console the log
this data set and see what we have there
is we get an object which has that Skip
value in it so we can take that this
data set skip and we say video dot
current time plus equals this dot data
set skip now that's a string so you
should wrap that in a parse float and
that will convert it into a true number
and now if we play it and click our skip
button it'll jump back and forward back
and forward next let's work with these
range sliders here if you take a look we
have the input type of range
the name is volume and then we have
another one where the name is playback
rate and I've purposely done that with
volume and playback rate just so that
they line up with the properties on the
actual video so what we're going to
is first of all we're gonna listen for a
change on those specific sliders so
we're going to make a function called
handle range update they're just going
to console.log this dot value and then
we're going to go down here and listen
for a change event on each of those
ranges it ranges for each range and then
the range dot add event listener click
is going to run the function handle
range update so oh not click change
event so give it a refresh now if I
change one of these point zero three
five change one of these one one seven
five one point five one point three
another thing we could do is we could
just duplicate this and listen for a
mouse move event and that will fire this
will fire regardless of if you're
clicking or not but you can if you want
to have a little bit more practices go
back and set a flag so that when you
click down and move it much like we did
with canvas and click up you are only
updating the property when you are
clicked down but for that we've got it
updating in real time rather than just
when we let go of the button so we have
this this stuff value and we could also
console.log this dot name and
coincidentally volume and playback rate
are the two properties on the video that
we need to update so we simply just need
to say video and the property you want
to update is called this name which is
either going to be volume or a play back
rate so we'll say this name is equal to
this value because that's the value
that's already being piped in so now if
we go ahead and play it there are
volumes right down all the way up go
super fast so
burr slow you get the point right that
one's a pretty simple one and remove
those console logs as well as this
console.log here next up let's deal with
the big one which is this progress bar
here so first of all when you play the
video
the progress bar should be updating in
real time let's do that first and then
second of all the when you click on it
and drag it should update the video to
correspond with that place so first
we're going to make a function called
handle progress and we are going to make
a percentage because essentially how
it's going to work is we're going to go
in there we're going to inspect this
progress filled here and you see how we
have a flex basis value we're just going
to be updating that flex basis value of
sort of like updating the width of the
progress bar and it's just going to
correspond with how long it is so if we
have zero percent being not started at
all 100% being totally finished we
simply just need to calculate that
knowing how long is the video and how
far are we right now
so Kant's percent equals let's say video
dot current time divided by video
duration current time and duration are
just properties on that video and we
multiply it by 100 so we're getting a
not 0.5 but 50% and then we simply take
the progress bar which we've selected at
the top here progress bar and we append
the Styles dot style the Flex basis
equals and we simply pop in the %
variable and put a % on the end there
so that doesn't work just yet and why
not it's because we've created the
progress and if I were to run it
manually it would update itself but we
want it to run every so often so should
we put that in like a timeout or
interval and and run it every second no
what we'll do is we will again we will
listen for the video to emit an event
called time update and when that happens
we will run handle progress
so you just duplicate one of these video
out of endless
we're going to listen for the time
update event and we're going to run a
little progress when that happens
there's also an event called progress
and I don't know the difference between
the two I've looked and I don't really
understand but as far as I've tested
both progress and time update we'll just
trigger when the video is updating its
timecode and then if it's paused it's
not going to be unnecessarily running
that function so now we'll give it a
play and it seems to be working just
fine if I use these skip buttons to skip
ahead you notice that it updates itself
nicely as well finally the big one that
we want here is the scrub and how this
is going to work is we are going to
listen for a click on this video bar
here and wherever I have clicked let's
say I click right here it's gonna be say
like you've clicked how wide is this bar
here 640 pixels so let's say I click at
320 pixels in we know that 320 pixels is
halfway to 640 so I should scrub the
video 50% or 50% of its duration so
we're gonna make a function called scrub
here and when that happens we're gonna
get the event let's just console.log the
event here and we'll go down to the
bottom here and we will get our progress
bar we are going to listen for click and
when that happens we are going to run
scrub so let's see how we're doing here
open up your console play it now click
somewhere on I'm going to click about
halfway ok now we've got this mouse
event and inside the mouse event we are
going to see that we have e dot offset X
which is exactly what used in the canvas
tutorial so here it is
it tells me I clicked 283 pixels into
this bar because that bar is positioned
relative so given that knowledge we can
do a little bit of math so let's say
Const scrub time equals e dot offset
pauses but bunnies here hold on / and
now we have to figure out what is the
width of this entire progress bar well
we've already selected it into a
variable called progress and we can grab
the width of it with offset width
that'll give us the entire width of the
bar and that gives us like a percentage
like 50 0.5 or 0.6 for 60% and we simply
just multiply that by the videos
duration so if it's a 60 second clip
you're halfway through it's gonna tell
us that you should scrub to 30 seconds
and then we simply just update the video
video dot current time equals scrub time
let's see we're right now so if I play
it and I click about halfway it jumps
exactly to where I've tried to click it
good
now let's work on the actual dragging
and dropping of it because you don't
want to just listen for when someone
moves it you want to listen for it when
someone clicks and moves it all around
so let's just do it where you Mouse move
over top of it so we'll take progress
the add eventlistener
and we are going to listen for a mouse
move and we're just gonna scrub it there
wasn't without thinking about clicking
just yet so play it watch as I move my
it's a little bit jerky because it's
just firing like a million times and the
video can't really keep up but when I
move my cursor anywhere it just catches
up now that's not really all that great
and because I want to be clicking down
and what did we do in the canvas example
we created a flag variable set it to
false and then when you clicked we set
it to true so this is what we do we say
let mouse down equals false what is the
person currently clicking or has their
mouse down no that is false and then
when someone Mouse's down we'll set it
to true so say progress
eventlistener mousedown and when that
happens we will run mousedown is equal
to true then when someone messes up will
make the mouse down equal to false and
then the scrub when someone moves their
mouse what we want to do essentially is
we would run a function here that says
if Mouse down then we want to scrub
right however we can do it a little bit
easier I'll show you a little trick here
we will run a function just in line here
and we'll say Mouse down and scrub and
we'll pass it the event so we need to
pass the event here now whoa hold on
what what did we just do here when
someone moves their mouse we say mouse
down and scrub and what this does is it
first checks this variable and if this
variable is true it moves on to this if
this variable is false it's just going
to return false and it's not going to do
anything so we're sort of a hijacking
the fact that we can use and and and if
this is true it will move on to running
the scrub if this is false it's not
going to run the scrub and then because
our scrub function requires the the
initial event of when this happened on
mouse move we need to pass it in this
arrow function and then just sort of
like hot potato it over to our scrub
function here so now if we play it and
see I'm moving my cursor over top no
problem but if I click and drag you'll
see it is updating all that time looking
good awesome so that is the very basics
of a video player it's not really all
that basically if we've got a lot here
the one thing that we did not do and
this is my challenge to you is try to
figure out how to make the fullscreen
button work so add another button here
and they should nicely work out I've
used flexbox here so if you add another
button that'll just shift on over and
when you click that button make the
video go fullscreen thanks a lot see you
tomorrow
[Laughter]</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>