<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Vanilla JS Countdown Timer - #JavaScript30 29/30 | Coder Coacher - Coaching Coders</title><meta content="Vanilla JS Countdown Timer - #JavaScript30 29/30 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Wes-Bos/">Wes Bos</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Vanilla JS Countdown Timer - #JavaScript30 29/30</b></h2><h5 class="post__date">2017-10-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/LAaf7-WuJJQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">today we're creating a countdown timer
that will show us how many seconds are
left in some sort of task like you've
got a quick 5-minute break or you have a
15-minute break or you've got a lunch
break going on you need to be able to
click these buttons or you can put in
the number of minutes that you'd like
it's going to count it down as well as
show you what time to be back this is
just because when I teach that we have
breaks and people need to know how long
a break is left and they always asked me
it was how much time is left in the
break and I say I'm not your dad and
then we built something so we could stop
asking that question
so we want to first go into our scripts
here and I'm just gonna make a function
called timer and we're just going to
work in the console to start and then
what we are going to do is update this
actual interface here so I make a
function called timer that's going to
take in the number of seconds you wish
for the timer to be in and then we are
going to do two things now how do timers
work you have the amount of time that
you wish for it to be have and then you
simply elapsed that time over however
many seconds it is in the past what I've
done is I would just set an interval
which has a function and that function
itself it would run every second and
then what I would do is I would just say
seconds - - and then it would just
decrement the amount of seconds every
single time however I did run into
issues with that because set interval
does not run sometimes I found some
times when I would tab away for a long
time it would simply just stop running
it I don't know if the browser does
something funky there with pausing its
intervals when it's not necessarily
running and then I also found on iOS
when you are scrolling it will pause all
of your intervals and I think it does
that for performance issues as well as
making your scrolling nice and buttery
smooth similar to how if you scroll it a
page your animated gifs will also stop
so it's not really a good use case there
because if I were to be scrolling for 10
seconds then it would add an extra 10
seconds on to the break so rather than
doing that we go we will use an interval
but in a different way what we want to
do is figure out when the timer started
which is constant now equals date now
and that's kind of a new one to the
browser previously we had to do like new
date and then get time but there is a
new static method on date called now and
it will just give us the current
timestamp in milliseconds and then we
also want then which is now plus the
number of seconds which you wish to run
the timer for but that now is going to
be in milliseconds in seconds is
obviously in seconds so we just multiply
that by a thousand
so let's console.log now and then just
to see what we've got going on here if I
were to refresh this run timer 10 you
see are now and are then values that we
have here good so those are working for
us next what we need to do is every
single second we need to display the
amount of time left and this is where we
set an interval and this is okay to use
an interval here because we're really
not worried about it running every
single second if something happens but
like let's say it were just skip two
seconds it will just update two seconds
later and show us those two two less
seconds rather than one so find easy
here we're going to run it every second
which is a thousand milliseconds here
and then what we need to figure out is
how much time is left on the clock so
we'll take our then which is when it
stops and we'll say kant's seconds left
is equal to then - and we can say now
because that's that was captured when
that when it ran but we need to run date
dot now once more and again now that's
going to be in milliseconds so we want
to divide that by a thousand so we can
get second also log seconds left see
what we got here eight and
1/2 7 6 5 so we have a bit of a rounding
error here oh that's a bit of a funky
one and I guess just because we're
dealing with milliseconds and doing this
division here so you can wrap the entire
thing in a math dot round and then run
it 10-9 there we go and you may have
just seen that it started going negative
after a while and why is that because
intervals don't know when to stop
themselves so what we need to do here is
before we display it we need to check if
we should stop it and how do you stop
I'll say if the seconds left is less or
equal to zero
then we want to stop it so obviously we
could return which will stop the
function from running but that's not
really gonna help us and I'll show you
here
that's not going to totally stop this
interval from running it's just gonna
run but not show us anything so we need
to do is to store this interval in its
own variable so I'm gonna go up here and
say let countdown and that's going to be
our sort of higher level variable in
this case it's a global variable it's
gonna live on the window but you could
pop that in if he and not have it in the
global namespace and then here we're
going to simply update it count down is
equal to and then here we will call
clear interval and pass it the name of
our timer which is countdown then when
we run it let's run it with three
seconds left to 1 and then it will never
run again because we hit this here real
quick aside sorry that I have to jump in
here though but I said less or equal to
but that ends up with leaving us one
second obviously we want less than zero
seconds which is going to give us two
one and zero so not less or equal to
just less all right back to scheduled
programming now one other issue that we
are running into is if I run 10 seconds
watch what happens only after one second
elapses does it actually run and the
problem with that is that set interval
what we have right here that does not
run immediately it has to wait for the
first second to elapsed so what I want
to do is we'll create a second function
down here called display time left which
takes in seconds and here we're going to
console.log the number of seconds left
and we're gonna change that to minutes
and whatnot and then down here instead
of counsel logging it we're gonna
display it which it should still let's
do the same thing still after a second
but then we could also run that as soon
as the function is invoked so we run
display time left and we'll pass it
seconds so we're gonna run it
immediately once and then once again
every single time that we do that
interval so here we go a timer then see
it does 10 immediately and then we'll
count down from 9 to 6 all the way down
to 1 good so this little countdown
function that we've written here is
looking pretty good now I want to go
down into our display time left and
start working with converting it to
minutes 10 seconds in a previous video
what we did is we took all of our
seconds and converted it to seconds
minutes and hours you can go grab that
code right now if you'd like or if you
want a little bit of practice figure it
out yourself
we're only going to do minutes and
seconds here but you are welcome to do
ours as well so say Const minutes is
equal to seconds divided by 60 and let's
just consult we have left so if I were
to run 70 we've one point one six
minutes left one point one three so
what's what's going on here with that
well that's because we only want whole
minutes we don't care about those
remainders here so say math dot floor
we'll grab the lower bound of that
number and now if I were to run let's do
100 in 24 seconds so two minutes two
minutes and then eventually should get
to one whole min it
there we go and now we're worried about
how many seconds are left so it counts
remainder seconds and that is going to
be seconds mod 60 and mod will give us
the remainder that we have minutes in
remainder seconds timer there go three
two one that goes down to one minute and
59 seconds good so we've got our minutes
in our remainder seconds now we can
start working with our HTML we've got
this display time left div here if we
were to put that in a variable Const
timer display is equal to document dog
query selector we want to look for that
then we'll go down here and create
another variable which is going to be
our display time which is going to look
like something like 1111 right so how do
we get the number of minutes left simply
just minutes : number of remainder
seconds and then we take our time our
display which is our div we set the text
content to be display and we can get rid
of this console log because now we're
dealing with actual Dom elements here so
if I run it oh I spelt it wrong minutes
mine it says now we run it oh okay
kind of working but you see what the
problem is here when you have less than
10 seconds left
it just says 4 seconds but we should be
0 4 seconds left so how do we do that
well we could go to this remainder
seconds and we'll say if the remainder
seconds is greater than 10 or sorry less
than 10 then we want to return a 0 it's
a question mark this is a shorthand
ternary operator and otherwise we're
just going to return nothing and that
will give us a 0 and then finally on the
end here you can just give us the
remainder seconds left so if we run it
now is 124 second
so we have that padded zero on the front
until it gets there another thing is we
should update the tab on our browser
here it just says countdown timer so we
can simply just say document title
what's document title is the the title
tag in your HTML is equal to display in
order to run it there we go it updates
it as we're updating it you can put that
really wherever it is that you like now
I want to work on that other function
which is showing the ending time so if
it's 2:30 and you have a 5 minute break
I want to say be back at 2:35 so we'll
create a function called display end
time that's going to take in a timestamp
of when you want to finish that's our
then time right here takes in a
timestamp and we got to turn that
timestamp
into a date counts end equals new date
and you want to pass it the timestamp Y
if you've never done worked with
timestamps before this is how they work
you have date now which is just a number
of milliseconds since January 1st 1970s
when God created the earth so that's the
number of milliseconds that has elapsed
since that amount of time now if you
were just to take this and put it in a
string and then come back to JavaScript
and be like ok I need to convert this
back into a date you say new date and
you pass it the number of milliseconds
that you have and it's going to convert
that it's December 1st right now convert
it into a proper timestamp for you
what's cool about that is you can put it
in a variable called X and then you call
X doc get date X dot get day X I get
month and you get all the information
about what day and month and all that
that's a proper date so that takes in a
timestamp we create a new date object
from that and then we can simply just
get the hours so it's a constant our
equals and Duquette hours and Const
minutes is equal to end get minutes and
then we'll say end time which we don't
have that yet let's go back up to the
top here what is our end time display
end time grab that sucker const end time
is equal to document our query selector
will grab the thing with the class of
display and time okay so we got this end
time that text content is equal to and
I'm just gonna set it here previously we
put it in a variable called display why
because I needed to use it more than
once I needed to use it to update the
title as well as update the text content
but in this case I just want to do it
directly inside of here
so we'll say be back at and then we will
grab the hour and we will grab the
minutes that easy right no it's not
gonna be that easy but let's give it a
shot
so underneath in our timer we're not
going to run this in our interval
because it doesn't need to be updated
every second it just needs to happen
once when you run the timer so somebody
just display end time you pass it then
which is the end time so if I were to
run our timer with I don't know 3000
seconds to pass it into it we got 50
minutes left but the problem is here is
that I am NOT European and I do not
understand what 15 old clock is I do
know that I should be back at 3:11 so we
need to then go into here and if you're
European congratulations you can leave
this part and maybe go get a pop or
something like that but we Canadians and
Americans and whoever else is normal
needs to go into this hour and we'll say
if the hour is greater than 12 then we
need to return the hour minus 12
otherwise we want to just return the
hour and if this is a little bit too
funky for you you can simply just go in
here and create a new variable Const
adjusted hour is equal to will return
our -12 so if it is 13 o'clock take away
12 it is 1 o'clock
take that adjusted our and put it here
so how's that looking ok be back at 3:12
good but what if I were to run it with
2700 seconds be back at 3 7 so we got
the the trailing minutes again so if the
minutes is less than 10 then return 0
otherwise return nothing and then we'll
attack minutes on to the end again be
back at 307 be UT full ok so we've got
our timer working our function is
working it's updating displaying and
everything last thing that we need to do
now is hook it up to all of these
different buttons as well as our minutes
here so if we look at our HTML you see
that each of these buttons here has a
data - time in the number of seconds we
wish to run it on it and then we have a
form here which is a custom number of
minutes not seconds let's deal with
these buttons will knock them off first
so we'll go in here and first we'll
select all of those so say Const buttons
equals all and you want to select
anything with the data - time so not
just a button it might be a picture it
might be something else anything that
has a data - time attribute and then
when that happens go down here we'll say
buttons for each button button an event
listener we want to listen for a click
and when that happens we could run a
function called start timer here we'll
make a function called start timer and
we will simply just console.log this
okay let's see we got here 20 seconds
button got it so how do we get this data
- timeout well this dot data set will
give us an object with the time on it so
this data set time will give us a string
of the number of minutes so we can just
make it put that into a variable counts
seconds is equal to this that days at a
time you want to wrap it any quick parse
int turn it into a real number and then
we'll console.log seconds 10 20 30 good
working really nicely for us so what we
want to do is then we can simply just
call timer seconds that other function
so click it ah-ha looks like it's
working really nicely although watch
this click on work 5 dude Oh back and
forth back and forth back and so what's
going on here we have these and if I
click a couple of them let's just go to
town here so I just click like at a
hundred times oh my goodness what's
going on well I just queued up like 1000
timers and there's no way for the timers
to cancel themselves out unless in the
number of seconds hit zero so that's
annoying like what if you click the
wrong one
you have to like refresh the page and
then start again that's not really any
way to live your life what we want to do
is when we start our timer we'll just
clear any existing timers it's clear
interval countdown so if there is a
timer in countdown
it will clear it if there's not the
variable still exists and it's not going
to error out on us it's an office say
about 20 I'm in 5 it's not going back 15
it's not going back you see that our be
back time is also updating itself nicely
good good good
last thing is this form here where you
enter in maybe 30 minutes so we want to
take this form right here which if we go
into our HTML you'll see that this form
has a name of custom form so I'll go
into here and before you select it I
kind of want to show you this little
thing I actually didn't know about it
for the longest time I was always just
selecting all of my elements but did you
know that you can type document dot and
then if it has a name attribute on it
custom form means this type document
custom form and that will give us the
form element similarly if your input
also has a name you can it'll just
test itself dot minutes and that will
give us the input so whoa
we don't need has a select a single
thing let's go into our scripts here and
we'll say document custom form add
eventlistener and we're going to listen
for it what click enter no sub MIT and
then we're going to run a function
proper function here I'll show you why
in a second pass the event now if we
submit this now type 10 it refreshes the
page and you see the URL says minutes
equals 10 how do we stop it from
reloading the page and sending the data
over a get we call a dot prevent default
that will stop it from running so 10
good nothing happens then we can get the
mins which is going to be this because
this is the form dot minutes which is
going to be that that text box there
that we typed into the input dot volume
and console.log our mins 2:10 got it we
can quickly call this dot reset to clear
out the value 10 it'll clear the value
in console log it and then we simply
just take that number of minutes that we
want we pass it to our timer we can't
pass it minutes because our timer
requires seconds multiply that by 60 and
if we do it right so 5 minutes should
give us five whole minutes
very nice so that is our timer we got a
couple of different functions going on
here we have our timeout and whatnot
hopefully you enjoyed that I'd love to
see how you can take this a little bit
further either adding some animation and
some interaction or adding some features
in terms of hours and whatnot
[Laughter]</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>