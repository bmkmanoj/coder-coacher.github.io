<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Stripe Follow Along Dropdown Navigation - #JavaScript30 26/30 | Coder Coacher - Coaching Coders</title><meta content="Stripe Follow Along Dropdown Navigation - #JavaScript30 26/30 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Wes-Bos/">Wes Bos</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Stripe Follow Along Dropdown Navigation - #JavaScript30 26/30</b></h2><h5 class="post__date">2017-10-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/GvuWJSXYQDU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">a couple videos ago we looked at this
really slick nav that stripe has on its
pricing page and when you hover over top
of it of course it shows the drop down
but the really cool part about it is
that the background of the drop down
seems to be able to transform itself
from the width and the height as well as
wherever it is on the page so it's xn
its y-coordinates and when I first saw
that I was like how did they do that
that's incredible
and what I found out is that the drop
downs themselves like the content the
text here those are separate elements
but there's this sort of like little
puppy div that follows each of those
drop downs around and will resize itself
based on wherever it is on the page so
this white thing that you see moving
that's the actual background that's just
moving itself around and it's just sort
of absolutely positioned behind those
elements and we did a really simple
example like that in our a couple days
ago when we hovered over a link we had a
little div that would sort of resize
itself and go behind where that element
is so today we're going to step it up a
little bit and build something like this
which is a proof-of-concept striped
navigation looks a little bit different
but it has the same idea where when you
hover over top of one of these
navigation links it's going to resize
itself it's going to match the width and
the height of the actual content and
animate itself wherever it's gonna go or
transition itself wherever it's gonna go
let's jump into looking at our HTML real
quick we have a nav element right here
and you could give that a class of top
if you like then you've got a drop-down
background that's the white that's what
the white is gonna follow around you see
this little white dip part that's not
three separate divs that's just one and
it's gonna follow along with the content
as we go so that's what we have and then
we have a span with a class of arrow
which is going to be that little notch
that we have there okay good and and you
notice that I put this inside of this
nav in the last one we just put it
straight in the
body so that we didn't have to worry
about any like margin or padding on top
of our nav here but in this one I want
to show you how do you actually deal
with this if you're trying to get the
actual position of an element inside of
a nav because it's not always your job
to pick the HTML sometimes you have a
CMS and it's gonna generate that HTML
for you and I want to make sure that
we're we're not just making this as easy
as possible and then you go to implement
in your own Alice is actually a little
bit harder than then we actually thought
it was so we've put it in here just to
show you a different way to do it that
we have on order class with the class of
cool we have our list items these are
our allies we have three of them we've
got our link and then what's called the
drop down and the drop down can be any
element in this case is a div that has
some info on me in this case it's an
unordered list that has more list items
inside of it but the important thing is
that these Li is the top-level eyes they
will be our triggers they are the things
that are going to be hovered on them and
the reason why these lis are going to be
the things that we hover is because if
you hover onto this a link and then you
try to hover into something inside of it
like Twitter Facebook our blog you're
technically hovering off the anchor link
and and then it would trigger the off
and it would fade itself out so here
what we're doing is even though I'm my
mouse is right here I'm still inside of
this parent Li and then we've got the
second one as well as the third one in
terms of CSS there's not a whole lot
going on here most of this is just so it
looks half-decent none of it really has
anything to do with the positioning on
the page other than this
position:relative right here that we
have we are going to be writing the the
CSS that is important for ourselves so
first we need the triggers and those are
those three allies so say Const rigours
equals document query selector all and
we'll say cool Li and that's going to be
all the direct descendants of that cool
that are a list item then we also need
to grab the drop-down background which
is that white div so we'll call that
background make sure that you use only
query selector
because we don't need a node list we
need just one element and then we'll
also do that for our nav which we put a
class of top on then what we want to do
is listen for a hover in and a hover out
or a mouse enter and a mouse leave on
each of those list items so we're going
to make two functions here called handle
enter and we're gonna make one call
handle leave then we'll listen for the
mouse enter and the mouse leave and
trigger each of those functions so I'll
handle enter on that one and we'll just
duplicate it over and we'll listen for
the mouse leave event which is going to
trigger our handle leave all right so we
just wrote a bit of code there let's
make sure that these all work so enter
and leave make sure we didn't get
anything wrong here so any syntax errors
in our console note then you go to your
console hover over top of them good you
should be getting enter and leave
console logs whenever you hover in and
out of any of those elements good so
next what we need to do is we need to
break this down into two parts first
part is I just want to get the contents
of the drop down showing meaning that if
I hover over this last one this UL here
it should show itself I take the opacity
off and then it's playing on off you see
there's the content for each of them I
want to show whenever I hover over Li I
want to find the drop down inside of it
and then display it and the way that's
going to work is we're going to be
adding and removing classes and then
leaning on our CSS to actually do that
for us so we'll go into our handle enter
function here and we will grab this what
is this this is the list item I'm going
to put the class on the list item the
class list dot add and we'll say trigger
- enter and then what we want to do is
also add a class of trigger interactive
after 150 milliseconds and this is going
to become more clear as to why I've done
this when we get into the second part
which is that follow-along div so I'm
gonna say set timeout we are going to
I'm going to show you a little trick
here with arrow functions I'm going to
use a normal function here and then I
say after 150 milliseconds this thought
classlist dot add trigger enter active
now this isn't going to work why not
I cannot read property ad of undefined
so it's cannot find class list of this
and why is that if you console.log this
it's it gives you window and you
probably have like yahwah as you showed
me this in your ESX of course i
understand it now when you enter into a
function the value of this changes
however if you change that into an arrow
function the value of this is inherited
from the parent function which is going
to be exactly what we want
aha good so we can make this into a nice
little short one-liner arrow function
here there we go is this still work good
we've got it so we've got this that
class list to add trigger interactive
then we want to go into our CSS so
scroll up and this is why I've included
the CSS in the file for you here because
it's actually a bit long it'd be better
suited towards a separate CSS file and
we'll find our drop-down which is here
and you'll notice that the way that I
show the drop down is with both I hit it
with opacity 0 and display:none and the
reason why I've done that is because you
cannot go from opacity 0 to 1 as well as
display:none to display:block so it's a
bit of a pain but what we're gonna do is
we're sorting in a step it where when we
have trigger enter our drop down is
going to be display block but it's still
going to be opacity 1 and I'll show you
opacity one see that will just
immediately show it but I wanted to sort
of transition itself in which is why we
have this here so what I want to do is
not put the opacity there but after a
second we're going to have this class of
trigger interactive
so watch this see how they say after 150
milliseconds we get that second one and
then when it has a class of trigger
interactive because it is already shown
with the display:block just a
split-second earlier then we go into our
opacity instead of until v1 and this is
how if you've ever used animations in
either react or angular this is how
animations are transitions work inside
of those frameworks they just apply to
separate classes when something enters
or leaves and then you can use your CSS
just to do that sort of staged move
there so now if we give it a save and
refresh looks like it's not showing
opacity one oh it's because I need to
say don't drop down there we go see how
they animate themselves in or transition
themselves in and then of course on the
other side of things we can go into our
leave and we simply just need to
duplicate that one and we will just
remove the class of trigger enter and
then I'm gonna do it all in one shot
I'm not gonna animate it out so I'll say
trigger enter active good you see these
things are nice fading in so that's a
lot of JavaScript just to do something
that CSS can do out of the box but the
next piece and the reason why we need to
do this with JavaScript is because the
next piece is that we're going to figure
out how big is this UL with a class of
drop-down and then can that little white
div go behind it so we get this little
animation that we have here so let's go
here first thing we need to do is get
that white thing on the page and that
white thing is our background so what we
have right here so we'll say background
a class list dot add it's going to have
a class of open and then just duplicate
that and remove it on our leave so now
we should look at our drop down
background here and then when you hover
over top of one of them
it should also add a class of open so if
we go into our CSS we see it here when
our
down background also has a class of open
let's say opacity one you see see that
the little white guy in the corner is
showing itself makes sense so now we
need to do which is really the heavy
lifting is to figure out okay we have
this drop down just Twitter Facebook
blog course catalog how wide how high
and where on the page do you live so
that we can take this white thing and
move it on over to where that exists so
we're going to go down here below where
we did all those class lists and first
thing that we need to do is figure out
what that drop-down actually is so it
will say cost drop-down equals this dot
query selector and we're going to be
looking for a drop-down and you might
ask be asking like why didn't we do that
up here with our nav well you can't do
that here because there's three
different dropdowns and it needs to be
dynamic you need to find the one
drop-down that exists inside of the
thing that got hovered so if we
console.log that dropdown go to our
console here you should now see that we
get a different drop-down in the course
in the console whenever we hover good so
we can then take the coordinates from
that just like we did in the previous
one will say Const drop-down cords is
equal to drop down dot get founding
client rect and put those together let's
just call it the log drop-down cords
give it a save ah so you see what's
happening here is that we get
information about where on the page from
the bottom the left the top the right in
the width is that actual item now the
other thing is that we need to get
information about where the nav is
because you cannot assume that this nav
tag is always going to be the first
thing on the page you might have an h2
that says hello and when that happens
you bump everything down and these this
information
it gives you information relative to
where on the page it is absolutely on
the page not and it doesn't take these
things into account so we need to do is
then grab the coordinates for the nav as
well so go down down down it counts nav
chords is equal to nav get found in
client wrecked we should also have the
coordinates for the nav and the reason
why I do that on every single time
something might change sometimes you
have a banner that opens and closes you
can't assume that it's always gonna be
the same on page load as it is when you
hover so you got these nav chords as
well it's console.log those good we've
got that and then what we need to do is
figure out where are the chords for
everything so we're going to put those
two coordinates that we just got
together it counts chords is equal to
and then the height is just going to be
equal to the drop down chords height and
the width is also going to be drop down
chords out with let's just stop it there
and work with the width and the height
before we get any further so now that we
have the width and the height here we
can just take our background which is
that white thing we can set the style
and we'll say the set property and we're
going to set the property the width to
be cord start with we're also going to
do that with the height and that doesn't
seem to be working how come because you
need to give it pixels so you could just
wrap these suckers in a template string
and add px to the end that should do it
for us ah look at this so when you hover
it it will know how big and how wide
that actual element is and that's
another reason why we do that sort a
2-stage adding trigger enter and trigger
active so that when you enter it even
though it's not shown on the page its
display block and we're able to get
these bounding client rekts from it
because otherwise if it was hidden you
can't tell the width and the height of a
hidden element so it needs to be on the
page even if it's visibly not there with
opacity so we've got our width and our
height and the reason why that is
animating itself if we go up to our CSS
here you see this drop down background I
have a transition of the opacity is half
a second and then everything else is 0.3
seconds and the translate is 0.2 seconds
so if I make that two seconds make this
one three seconds the width and the
height will just take two seconds to
actually grow but you want that to be
nice and short and you can kind of play
around with how nicely that goes good
well that's working and then the last
piece of the puzzle is actually working
with the top and the left values so if
we go back down here
they say the top is going to be let's
just say drop down chords top and the
left is going to be the same thing and
then we were to go down here and set our
transform because this is a CSS property
is going to be normally it would be
translate and we would give it our X
and/or Y but in our case it's going to
be chords dot left px comma chords top
give that a save seems to be working but
if I were to go up here again just do
what we did before and maybe for like H
to say look cool now see how everything
is messed up and that's because the
coordinates ever get are off a little
bit because that navigation is pushed
down so you can't always assume that
everything is going to be anchored to
the top of the actual page and that's
why we've went ahead and grabbed this
nav coordinates right here because we
need to take our drop-down chords and
then offset them with the top nav so if
the top nav is 30 pixels we know it's
been bumped down 30 pixels so the value
the top of this white box it needs to be
moved up 30 pixels and same for the left
nav chords left and those two values are
just going to offset
um and it's gonna perfectly put itself
haha
buttery smooth you've got it going on
this is probably the hardest part that
took me a while to figure out when you
have something nested inside of it these
values don't care and you need to do the
math yourself that's one thing that
jQuery did really nice for you if you
ever use dot offset inside of jQuery you
didn't have to worry about it because I
did all the math behind the scenes for
you there other than that working really
nicely for us there is one little thing
where if you sort of go bananas on it
take the nav the ul open this up you see
look look why is there trigger
interactive here and if you'd like
really mess with it let go really
quickly you'll see like okay sometimes
you see the content before you actually
get to it and then if you mess with it
sometimes you're going to end up with an
active here and and what's happening is
that it's this set timeout here
immediately when we enter we're gonna
add a class of trigger enter and then
150 milliseconds later we're gonna enter
trigger interactive but sometimes I'm
already hovering off before this is even
added so there's a bit of a problem here
where you try to remove the active one
before it's ever been added so you run
the remove and then a little bit later
you actually add it on that's a bit of a
pain so what we want to do is take this
function that we're running here put
that into its own and we'll say if this
dot class list dot contains trigger
enter then we want to add the class of
active and then you can see it you can
just go too crazy with it and you see
that you're never seen the content too
early because that active one is never
being added and you never see them on
here another way that I like to write it
is it's it's a little bit more it's a
little bit shorter where I'll take it
back to what we have here take that the
if statement out take this block out
that we had here bring it back to that
arrow function and what you can do is
you say this the class list that
contains trigger enter and this
and that sort of short circuiting this
where if this is true then this will run
if this is false then it doesn't bother
a checking the second one so it's a bit
of a hack there where you you take
advantage of this boolean and an but
that means that the ad will never run
unless it actually contains trigger
enter it's just like the estimate that
we have there and things oh no I broke
it
token we got too many tokens is it that
one maybe yes there we go working nicely
for us
so hopefully you enjoyed that one I
really liked it I think that the people
that work at stripe they have if you
look into it use if you notice like when
you just hover into it they have this
like really cool sort of fold down
effect that they have going on and I
think that their code is probably six or
seven times as large as this but if this
is something that you love working with
was just coordinates and timing and all
of that I would definitely encourage you
to try and make that little fold down
animation work as well
thanks so much and I will see you
tomorrow
[Laughter]</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>