<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Learn Redux #12 — Updating State with Reducers | Coder Coacher - Coaching Coders</title><meta content="Learn Redux #12 — Updating State with Reducers - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Wes-Bos/">Wes Bos</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Learn Redux #12 — Updating State with Reducers</b></h2><h5 class="post__date">2016-05-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/BWN-9bF51BU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">when someone clicks on this like button
right here
I want this increment function to
actually run and the way that we do that
is we simply add in on click equals this
dot props increment now that's going to
be this action creator right here it's
going to run increment and we're going
to pass it the index of zero one two
three you get the point so how do we
pass it the number like zero two we
already have a variable called I which
is the index that's good so we could
just do that but you'll know that that
would just run it on page load which is
not what we want so there's a couple
ways that you can pass an argument to a
function on click and you can choose
your own way at my favorite way is just
to call dot bind you pass null as the
first one because react does all of the
binding for us and then you pass the act
the first parameter as the second one
here so if I give that a save now and
I'm going to go to my console here in
whoa looks like we got a whole whack of
errors going on here it says there's
another module with equal name when case
is ignored I wasn't sure what this was
but I gave it a quick google and I
realized that when I imported react
right here I put a capital R on it that
should be lowercase R so give that a
save clear out give a good refreshing
you're good to go so we just hooked up
the button with bind and now when I
click that button what should happen is
what's this who all of our reducers are
now running so we just created an action
that got fired off or dispatched as we
call it in redux and now we actually
need to open up our posts reducer and
start handling the actual increment of
the actual like in redux we use a
functional programming and what's really
important about that is that we do not
mutate our state and we use what's
called pure functions I want to take a
little bit of an aside and sort of
explain what these things actually are
the
we seem to hear about a lot and if
you're not sure exactly what they are
then it can come back to bite you when
you write it so you we have our reducer
right here and you might think like Oh
incremental like that's pretty easy we
take the state we find the action I
which is which would be like action of
zero and we just take the likes of value
and increment it by 1 and we're done
call it a day go get a beer but that's
not exactly how we do it because what
we're doing is we're simply mutating
something that is outside of this actual
function right and that is not a pure
function now a pure function is a
predictable function when we've got some
code right here that takes in a picture
increments the number of likes and
returns it so if we have a picture
variable and we pass that function with
10 likes every single time that we pass
it with 10 likes it should always return
it with 11 likes that's what a pure
function is this makes it easier for
testing as well as it's going to open up
the whole world of Redux dev tools and
time-travel and all this great stuff so
here I have coded a impure function and
you can see that right here we're taking
this object which is has a name and the
number of likes and we call add like add
like add light we call the same code
three times however every single time
we're getting a different result and
that's what makes it an impure function
so what we can do to fix this is that we
essentially we take a copy of this
object or we take a copy of an array if
it's in that case we modify it and then
we return the new state so we don't
modify the old state we simply just take
a copy and return the new state so how
would I fix something like this well I'm
gonna go right here I am gonna paste in
my new code right here and what I've
done here is we take a copy it's an
object spread that we pass here and then
we use but we can't exactly use that
just yet so I'm using object assign
which is taking an object and applying
each of the properties onto this blank
object then
increment the likes and then I
console.log and return it so now we see
that we're calling I'd like I'd like I'd
like three times and we get 11 11 11
that is a predictable that is a pure
function and we are not mutating an
external state it's going to open up a
whole new world to us so with that in
mind let's go back to our code here and
let's start coding whatever goes on in
our reducer so what happens in the
reducer is that whenever you click this
button right here we are running all of
the reducers and this increment likes
right here is what we need to act on we
use a switch statement to be able to act
on that so we'll say switch on action
dot type right because the type is going
to be increment likes in in this case we
only have one possible scenario but when
we get two comments we're gonna have a
couple more scenarios that we can work
on and you can say case increment likes
so if it is an increment likes then we
are going to return the updated state
and then we always give a default state
which is just going to be simply return
state I can go ahead and delete that one
so why did we do that because remember
we said that all of the reducers always
run for every single one and if we are
not acting on that specific one like the
comments reducer it will run but if it
doesn't care about increment likes it's
just going to return the default state
and not do anything but in this case the
increment like so we're gonna do
console.log incrementing likes and I'm
just going to open up the comments
reducer real quick as well and I'm gonna
take that console log out of there so we
can keep our console nice and clean and
refresh now when we go ahead and click
that it says incrementing likes every
single time that we actually click it
and here is where we go ahead and update
the state so we are going to return a
newer right here and this is a little
bit tricky but essentially what needs to
happen if we take a look at our actual
state here is we have our posts and we
want to return this entire array but
only change one of them with the likes
one so we could do that with
Raik and cat and in take a copy of the
array and return it but we are using es6
spread here which will do essentially
the exact same thing so i'm going to
take the state dot slice from zero to
wherever the index is so we're going to
take everything up and - maybe we put a
comment before the one we are updating
and then I'm gonna do the last part as
well which is we want to go from the
increment plus one and this is
everything after the one we are updating
and then in between what we want to do
is pass it a new object right because
let's say we're updating the third one
so this is - we want to take a copy of
this actual object because the rest of
these are just references to the old one
we're not changing them so that's
totally fine but since we are changing
this one need to take a copy of this
actual object right here so we will use
an object spread right here which is
state square bracket I and that will
take everything but then we are also
going to tack on the new number of likes
which is going to be the state of I
which let's say we're updating 3rd one
state square bracket 2 dot likes +1 and
that is going to return the new value so
this dot dot dot that is a spread which
is going to update it it's very similar
right here to using object dot assign
where it will take a copy of the actual
element and then we return that entire
array so it takes in state it's
everything before and after and then
just updates the one post that we
actually want so I'll give that a save
and it'll go over here and now when we
click on this 56 here open up our
console here we get incrementing oh I
got to give it a quick refresh because
you can't hot reload those but you see
now I is not defined what we forgot to
do here is right inside of this case
where it's a Const I equals action dot
index right because we're we sent over
that index value there give it a refresh
click it hey look it's working that is
so much fun
it's incrementing likes every single
time click it click it click it over and
over
and we are simply updating state and
then react takes over from there it has
a virtual Dom and it's going to do all
of the updating wherever we're
referencing that actual piece of State
so that is our first reducer</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>