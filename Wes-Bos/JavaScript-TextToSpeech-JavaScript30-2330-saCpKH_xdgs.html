<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>JavaScript Text-To-Speech - #JavaScript30 23/30 | Coder Coacher - Coaching Coders</title><meta content="JavaScript Text-To-Speech - #JavaScript30 23/30 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Wes-Bos/">Wes Bos</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>JavaScript Text-To-Speech - #JavaScript30 23/30</b></h2><h5 class="post__date">2017-10-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/saCpKH_xdgs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay folks today we are going to use
about the speech synthesis API okay
folks today we're going to use about
this nation this is I think I'd agree I
think everybody using application ready
alright I hope you enjoyed that
introduction well we're gonna be working
with today is the speech synthesis API
that comes in most modern browsers much
like we did voice the text a couple days
ago we're now going to be doing text to
voice so let's take a look at our HTML
that we've got set up here we've got a
select which is gonna contain a list of
all of our possible voices if we look at
the answer here you'll see them here
there's a lot more I'm currently
filtering just for the English ones then
we also have an input with the name of
rate which is going to change hello I
love JavaScript hello how fast the
person talks hello you get the point we
also have pitch oh boy and then finally
we've got a text area with the name of
text which is going to contain whatever
the person says right we're gonna write
it in there now only an important thing
we need to know there is that rate pitch
and text the names of all these inputs
here they are important that they're
that because the name of them is going
to line up with the property on the
utterance which is essentially the the
voice that's going to say it so those
are important don't change those and
we've got the stop and speak buttons to
start and stop it now let's go down here
I've got you some starter code here
we've got a message which we're going to
create a new speech synthesis utterance
and that essentially means what is the
person going to say and on that uh
pterence it's going to contain
information about how fast did they say
it what is the pitch that they say it
what is the voice that they say it in
and what will they be saying so all
these four things that we have here
those are going to be put onto our
utterance so we're creating a new
version of that into message
empty array here which our voices are
going to be dumped into and then I've
just gone ahead and selected the
drop-down I selected the rate the pitch
in the text area all in one go I call
those options we have the speak button
here which is going to start it and then
the other one that's going to stop it
good so what we need to now do is on
page load whatever is in this text area
I want to set that to be the default so
what we'll do here is we'll say message
text equal to and normally say hello
testing in here what we want to do is we
want to select this box right here and
set it to be whatever is in there so
let's say document query selector where
the name is equal to text and we'll call
the value right out of there I'll give
that a save and a refresh open up your
your dev tools here and if you type in
MSG you should see that we have our
speech synthesis utterance and the text
is now equal to hello I love JavaScript
whoever there is no voice being set just
yet so let's go ahead and populate all
the different voices so what we do is we
take a global variable if this is a
speech synthesis utterance that's sort
of like one thing that a person might
say we also have another global variable
called speech synthesis and what speech
synthesis will do is you will can call
dot speak on it and pass it an utterance
which is going to be our message now if
I were to do that right now and try call
speech synthesis thoughts speak and pass
it or utterance because the utterance is
the thing that we say it doesn't work
just yet that's because there is no
voice but we can take that global
variable which is speech synthesis and
we can add an event listener to it so
add event listener in there is a event
called
voices changed and when that happens
we're going to populate our voices so
we're going to make a function called
populate voices and then right before
that we'll make that function then
we say is we will take that voices array
that we've declared up here and we'll
just override it with this get voices
and let's just console.log voices see
what we have so when and this just can't
be called on page load because when
speech synthesis loads it has to fire
the voice has changed because sometimes
it'll take a a hot second in order for
it to load so we need to wait until we
run the voices change so woah look at
this and if you are on a Windows machine
you might not see as many the Mac comes
with a whole bunch of voices built-in
which is pretty fun and you can open it
up each of these is a voice where they
have a name like Elva and a language
code that they speak in so what we want
to do is loop over all of those speech
voices and set them as options in this
drop-down so we'll say Const voice
options equals we'll take our voices and
we'll map over it cuz I'd like to map
over absolutely everything
put that on its own line here and we
have our voice and from the voice we're
just going to return an option where the
value is going to be the voice name and
then in there we're also going to put
the voice name but in brackets I also
want to put the voice Lang just so you
can see what language that voice is
meant to be and then once you've done
that we call a quick join on it and then
we will take our voices drop-down and
set the inner HTML to be voice options
or if you'd like you can just put this
inner HTML right away inside of here and
then you've done away with this one
extra line here so let's take a refresh
of that refresh your page and you'll see
that as soon as the voices load you'll
get a huge drop down of all the possible
voices now again you might not see all
these voices but it looks like Google
does include some of their own voices as
well for Chrome now that those voices
are actually loaded on the page we can
take a look at our message here and open
it up there still is no voice on it but
because those voices have been loaded
into the page
it will just default to our buddy Alex
which is the default one so we can now
call speech synthesis dot speak pass it
our utterance which is such a hilarious
thing it's an MSG and then when you call
it hello
I love JavaScript thumbs up uh and then
we say message text is equal to Wes is
cool and I could run it again wes is
cool so you get the point what's going
on here we've got an utterance we've got
a speech synthesis that will then take
that utterance and then talk out
whatever we have but we want to be able
to choose one of these from the
drop-down and that doesn't work just yet
so we're gonna make another function
called set voice and that is going to be
called console.log changing voice that's
going to be called when we change from
this drop-down so what is that we have
our voices drop-down we're going to add
an event listener for change and when
that happens we're going to call set
voice let's try that okay it's changing
voice changing voice every time we
change this drop-down it's actually
changing it but we don't just want a
console.log it what we want to do is we
have our utterance which is MSG and you
want to set the voice to be and we can't
just say like Alex or something like
that because it's it's not a valid voice
property so what we need to do is find
the voice that lines up with the value
and the way we can do that is if you
were to just console.log this value easy
Ana and Ellen and Luciana so we need to
find not just the name of it but if you
look at our voices array we need to find
the corresponding speech synthesis voice
object so the way we do that is we'll
say
MSG voice is equal to voices dot find so
we want to find the one where the voice
dot name is equal to this value
essentially what that's doing is it's
going to loop over every single one of
these voices in the array
it's going to find the one where its
name attribute is the same as the option
that was currently selected like alpha
right so it's gonna loop over until it
finds a voice name that's equal to alpha
and then we've gone ahead and set it so
let's try that now refresh go ahead and
select a meal and then we can manually
call speech synthesis that speak msg
hello
you love JavaScript all right let's
check out Ellen from the Netherlands
hello
Olivia's a script done whoo yay hello I
love JavaScript thumbs up I have found
that some of these Google ones take a
bit to load so if you do select it and
it's not working maybe it's just wait a
second I haven't figured that totally
out see fellow Aloha bias creepy goth
yeah here we go
seems to be working nice car meat hello
I love a Java Script a good Alamelu
it does speak the emojis in the native
language but then just does English
words in the accent of that language is
just kind of funny so we've got that now
what I want to do is make a function
that's going to every time I change one
of these things I want to restart it so
that's gonna be a function called toggle
and what we're going to do is first
we're just going to cancel anything that
we have that is currently speaking so I
call speech synthesis cancel and watch
this so if I run something immediately
it will cancel it right there that's
what cancel will do stop it from
speaking and then we'll just restart the
entire thing which is
speech synthesis don't speak the message
then we'll go back up to the set voice
and just call toggle on the end so now
we'll go to create
hello I love a JavaScript original
change hello
II love JavaScript hello you get the
point right it's going to stop it and
start it again you can also pass a flag
here I'm gonna call start over because
sometimes you might want to
you call put past false so it will not
restart itself and that's what you can
pass as false so I'm gonna say if start
over and it's by default going to be
true so you don't have to pass anything
unless you explicitly want it to not
start over and then we run it like that
double check this is still working hello
I love a JavaScript evil evil JavaScript
are boss and it will stop it
whereas toggle itself researcher and
toggle false will stop at all that's
what this if statement does here good
next up what we want to do is work with
our rate our pitch as well as our
message so we're gonna go down here and
we're going to take all of our options
which let me take a look at whatever
what are our options options options are
three inputs that the slider the second
slider in the text area so we'll take
all of our options here say options dot
for each option option add eventlistener
and we're going to listen for the change
event and when that happens we are going
to run a function called set option
which will then code here function set
option and inside of that function we
could let's just do this console log
this name and this dot value so when I
slide this right here it's going to tell
me I gotta go to all the rate has
changed to zero point three the pitch
has changed a zero point four the pitch
is at one point nine wes is cool and
then a click away the text area the text
property has changed - I love JavaScript
wes is cool so now we've found all of
these options when they change we know
what property will change which is the
spot name and what it was changed to
which is this value so we simply need to
take our message and set what property
changed this dot name to what changed
this value and then we can run the the
thing we can stop it and start it over
again
so let's try that now so I'm gonna
change the rate up hello hello hello
hello hello hello hello hello hello
hello hello I'm cool you got a tab away
or click away what's cool and then it
will rerun that why cuz these things
have changed we're also doing that on
here awesome then these buttons right
here we got to listen for a click on
them so we'll take our speak button
which is the the speak one right here
let's speak button and event listener
click when that happens we are going to
run the function toggle and that's just
going to manually run it hello I love
JavaScript thumbs up put some poops in
there it's pretty funny when you put
emojis in there smiling pile of poo eyes
bro mod doesn't be bloody de caca oh I
like it
oh remind me well you're not gonna
remind me we should filter this list for
just English ones if that's what you're
looking for but we do have to run our
speak button and then we also need to
listen for a click on our stop button so
when the stop button is clicked toggle
fall so how do you do that folks how do
you pass an argument to a function well
you might think okay I could I could I
can make it a function like this and
then say toggle false let's see if that
works
so hello okay that works but it seems a
little bit bigger there another way we
could do it well you can't call toggle
false like that because that's just
gonna run on page load hello I love Java
see it's on top it doesn't do anything
because this function is not returning a
function so okay huh so what we could do
there's there's a couple different ways
we could do it you can call dot bind
pass it the value of this which is going
to be nothing and then pass it your art
your first argument which is going to be
false and that's what bind does you take
a function and then you call it in the
context of this and pass it an argument
of false
I loved works great or this is somewhat
popular and react right now and you
could just do an inline function arrow
function right here you say toggle falls
so downside to that is this is creating
another function same with buying and
same with the function but it is another
way to do it
hello I love John it's really not that
big of a deal in this case unless I was
creating lots and lots and lots of these
so we've got that last thing I wanted to
do is filter this list for only ones
that are English like our friend Karen
from Australia so what we'll go do
before we map it will simply add a quick
filter in there or the voice and we say
if the voice dot lang da includes en and
that should just trim that list down to
ones that include en before we map over
it so now when i refresh we only see a
smaller subset of the list of the ones
that we have there so that is the voice
inator 5000 it's actually pretty simple
to get all of this code up and running
we just created a couple different
functions that will listen for when the
different elements are changed and then
it says it for us hopefully you enjoyed
that I'd love to see what you make of it
and I will see you tomorrow
[Laughter]</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>