<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Heres how React's New Context API Works | Coder Coacher - Coaching Coders</title><meta content="Heres how React's New Context API Works - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Wes-Bos/">Wes Bos</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Heres how React's New Context API Works</b></h2><h5 class="post__date">2018-03-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/XLJN4JfniH4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everybody West boss here I hope
you're having a fantastic day I just
wanted to make a little kind of informal
video this isn't going to be as polished
as some of my other stuff but so i'ma
show you kind of what this all new react
context is all about so in react 16/3
we're getting this new thing called
context which we already have had
something called context but this is
going to allow us to actually use
context in another way and it's sort of
something that will come along with
using state and props and it's going to
solve a problem that all of us have in
building react applications and it's
something that maybe we reach for
something like Redux maybe a little bit
too soon so I'm gonna show you how why
this is useful what problem it solves
and how to actually implement it into
your application so what I did here is I
just got a basic create react app up and
running so the way what I did is I just
type create react app dot and that went
ahead and installed it then I opened up
my package dot JSON and you can see that
I'm running a alpha 1 of react 16.3 and
that's because that has the newest
version of this contacts API in it and
same with the react Dom so if you want
to install those you just npm install
react at next and react Dom at next and
that's gonna allow us to install the
alpha versions of that then I opened up
my app j/s and I simply just import
react I create a component here and then
I export that application here so now
that we're up and running let's take a
look at sort of what the problem is that
we we often have so let's say this app
here has some state and in that state
let's say we have a name and the name is
Wes and the age is a hundred and the
cool is true now let's make another
component so say class person extends
component and I'm gonna actually move
this above here just because I'm going
to use that first and that needs a
render method inside of that I'll give
myself a div with a class of person so
or return that and inside of that I'll
just say hey
I'm a person good now if I want to go
ahead and use this person tag in here
that's fine it's a person and it should
render out just fine
you see that our person tag is is up and
running if we open up our reactive tools
let me bump up the font size on this
real quick and we look in there we have
our app and we have our person tag now
the question is like what if you want to
get data from our app into our person
tag
well how does data get anywhere from
state or from anywhere else it's via
prop so you might do something like this
like the name is equal to the state name
and and then we can go into here and
instead of hard-coding person we say
this stop props name now when I go back
to my app that's writing here obviously
the data from my app component is being
passed down to the person component now
where that starts to become a problem is
when you don't just have this sort of
direct parent-child relationship between
where your data lives and where the data
needs to go but sometimes you have
components that sort of live in between
there so let's make a another component
here I'll just say Const family is equal
to this will be a stateless functional
component and from that we'll return a
div with a class of family
and then inside of that will do a person
tag and and then down here instead of
rendering out person I'm going to render
out the family tag so we have our app
that renders out our family tag and then
we have our family tag that renders out
our person tag which is finally where it
needs to go now we have a bit of a
problem here because we have app family
person and the data lives that app and
it needs to get down to a person this is
a very simple example and you can
already see the issue here is that I
can't directly pass the data from app
down to person so what I would need to
do in that case is I need to pass the
data to my family component and then my
family component would need to pass the
data down again - I would say props dot
name and then it should make its way
from one to another and Kent C Dodds has
a really good blog post on this and he
called it prop drilling which I love
because sometimes you find yourself just
being like playing hot potato with your
your data or your functions or your
state or whatever it is you're just
passing it all down via props so that's
fine if it's one or two or three levels
but what happens when it gets into six
or seven levels deep well that's where
people start to reach for some sort of
data store like Redux where you can
inject your data store you can let you
can sort of like keep it outside of your
application in your data stores where
all your data lives and you can inject
that data at any level deep now reiax
contacts API is actually going to work
very similar to that where we can inject
our data at any level that we want so it
requires sort of two different pieces
first we need a provider and then we
need a consumer and that is both in this
new context API so let's just go how
it's actually going to work first what
we need to do is say first we will make
a new context so I say Const my context
is equal to react dot create context and
the is a lower case on that so make a
new context make sure you spell it right
there we go
and then what we want to do is we need
to create what's called a provider
component and that's where your data is
actually going to live so then create a
provider component class my provider and
from that we will render out and we put
also put some state in there and in that
state let's let's move that data that we
were talking about which is the name age
and cool we'll move that up to here so
we'll say name alright just actually let
me just take the whole thing move it out
of there going to move it into my
provider component and from the render
we are going to return and this is not
going to be divs or anything what it
looks like or what the markup actually
looks like but we actually need to
return a context
so let's say we'll give ourselves what
is our context well it's it's called my
context my context dot provider and now
we have that tag and then inside of that
we say this stop props dot children and
what this is going to do and very
similar to redux if you've used it is
this is going to live sort of at the top
level of your application and then
there's going to be another component
that we use to actually access the data
now this isn't enough just yet we need a
what's called a value here and that
value can be anything that we want let
our case let's just say I'm the value so
so far we aren't able to access the
state that's okay but we've passed down
this value to anything that this
provider is wrapped in okay that makes
sense then what we can do is we can go
to our application here and wrap the
entire application in that provider so
we'll say my provider I'll wrap that
entire thing and then any child inside
of that provider it doesn't matter if
it's directly there or anywhere down the
chain we're able to access the actual
data so we can quit passing down the
data like that we can just render out a
family component then let's go back up
to our family component and we can quit
caring about passing down the props name
here so we can just render out the
person tag and then let's go down to our
person tag and let's just take this top
props out so the question is going to be
how do I access my data here my context
is not defined
oh I goofed it up should be a capital M
on this variable here there we go so
here's the question we have our app we
have our provider we have our context we
have our family and we have our person
our data lives in the provider but we
need to access it inside of the person
how do I get it down from here all the
way down to there
and the way that we do that is we create
what's called a consumer right so the
provider is going to be where your data
lives and the consumer is going to be
where you actually want to access your
data so all we need to do is to go into
our person component because that's
where we want to access our data and I'm
going to remove that paragraph and we
can take our context remember context is
where we're going to grab our data from
so that we're going to have my context
but instead of doing a dot provider like
we did up here we're going to use a dot
consumer and then inside of that it's
not going to pass it down via props it's
actually going to use something that's
called a render prop and a render prop
usually looks a little something like
this either have a property called
render and inside of that you give it a
pass at a function to render or in this
case the render prop is passed as just a
child so the child of consumer will
always always always be a function so
you give yourself a set of curly
brackets to tell react that we're
running some JavaScript and then inside
of that you get your value or your
context whatever you like to call it I
like to call it context and back from
that we can start returning something so
we just say here P and I'll just say I'm
inside the consumer so it's rendering
out I'm inside of the consumer now the
question is what's in this variable well
let's let's see I'm inside
I'm the value so let's go through that
again real quick this value is the data
that we want to pass down and that lives
inside of our provider then a two three
four levels deep when you actually want
to access that data then you can access
it inside of your consumer by wrapping
it in a dot consumer tag and then giving
the only child of that consumer tag to
be a render function and then inside of
here you can render out anything that
you normally are used to rendering out
so the question is how do I change this
value not to be
the value or if I put a poop in there
just for old times sake you can see I'm
inside the poop it's passing the value
how do I pass down state well what we
can do is instead you can just pass down
an object and inside of that object I
like to do this state and I've only been
doing this for a while and there's some
libraries that are being developed to
sort of live on top of this but this is
this is just pure react contacts API
state is equal to B this dot state and
then all we can do is go down here and
say context dot state dot and then we
can access any of the state that lives
in our provider inside of our consumer
so this state dot let's try age we'll
just say age and we'll do another one
for name the state name uh-oh that's
because you can only return one element
from this function here so we could
solve that by wrapping it any react dot
fragment that's another new react API
that will render out sort of just like a
blank tag which is really exciting and
there we go look at age name is being
passed down from our provider which
lives here through this div through to
family and then finally from family down
to person and then finally when we
actually render out our person so we're
a couple levels deep being able to
access our actual context and the data
that lives in it now the question is how
do I update that state like you've ever
you want to remove it you want to
increment it or do something like that
well what you can do is much like
passing down state here you can also
pass down your functions are your
actions as we would call them in redux
so let's just say grow a year older is
equal to an arrow function and that
function is just going to call this that
set state and we're going to update the
age to be equal to we'll put this on its
own line this that
State DOT age plus one okay oh oh
because I don't know how to do code
there we go it's a colon there now we
have access to this function called grow
you're older and we can go anywhere we
want inside of our consumer put a button
there inside of that we'll have a cake
emoji sir there's lots of cake fish cake
is there a birthday cake yeah there we
go and that button on click it's going
to be equal to this
Oh No context dot grow a year older so
when someone clicks it access that
method called grow you're older that
lives inside of context and it should
just update the age let's see here
boom boom boom there we go you see that
still our logic of how to update state
and our actual data which is stayed that
still lives in the provider but you can
then just magically sort of grasp it out
of the air at any level deep by just
wrapping your code in this little
consumer tag that we have so that's my
super simple example of how context
works hopefully it gives you a little
bit of a better idea I am using it in my
own application here let me show you
this real quick so I'm working on an
application right now that is doing some
advanced react stuff and I am using
context specifically if I go to my local
host 3000 I am using contacts
specifically to hold things like the
current UI state like this cart if the
cart is currently open it's either true
or false and I need to know if the card
is open all through it the application
obviously in this button I need to be
able to access it but if I wanted to add
one of these items to my cart and then
for some reason I want it to open it for
just a split second then I would need to
be able to access that data so having
the state of the cart being open it
doesn't really make a whole lot of sense
keep that in the cart component when you
might need it somewhere else in your
application so my solution to that is I
have a context that lives sort of at the
top level of my application and then
anywhere lower level that I want to
access if the card is open or not I
think you should wrap it in this little
consumer tag that we have here and then
it gives me access to both is the cart
open as well as the functions that I can
use to toggle the cart being open and
closed so hopefully you enjoyed that if
you did let me know I'm at West's boss
on Twitter and I'll see you in the next
one</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>