<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Let's build something fun with HTML5 Canvas - #JavaScript30 8/30 | Coder Coacher - Coaching Coders</title><meta content="Let's build something fun with HTML5 Canvas - #JavaScript30 8/30 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Wes-Bos/">Wes Bos</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Let's build something fun with HTML5 Canvas - #JavaScript30 8/30</b></h2><h5 class="post__date">2017-02-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/8ZGAzJ0drl0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">today what would be building is this
sweet html5 canvas where as I click down
drag my finger and let go it's going to
draw something on the actual canvas here
now this may seem a little bit syllable
are actually going to learn a lot about
how the fundamentals of canvas actually
work as well as a couple of other neat
tricks along the way so let's head on
over to our JavaScript file here and
really all we have is this canvas
element that we need to draw on so first
thing we want to do is grab that canvas
and the second thing that we need is
something called a context canvas on the
web is sort of like Microsoft Paint
where you just get a block of actual
pixels and you need to then draw on that
now you don't draw directly on the
canvas element in HTML but you draw on
something called the context and the
context can either be 2d which is what
we'll be working with a hole though you
can also use it with 3d for stuff like
video games and 3d rendering so we're
going to grab the context
CT x equals canvas get context and we've
asked it for the 2d context next thing
we need to do is size up our canvas to
be the exact width of the window by
default your canvas is going to be 800
pixels by 800 pixels because I've done
it here however we want to resize it
before we do any of our drawing so say
canvas dot width equal to window inner
width and we'll also do that with height
then when i refresh this page it should
be as big as the actual window is I
inspect element on my canvas element you
shouldn't see anything but if you hover
over it you'll see mines about 1700 by
1100 pixels then we need to do a couple
of the base settings with the stroke
style the line cap and the line join and
I'll explain these in just a second
badass and we need line join is going to
be round and the line cap is also going
to be around and when you draw on
something what is going to happen is
this needs to be a color first of all
we're going to start with badass and
then also the end of the line should it
be squared off and when a line meets
another line should it be squared off or
should it be rounded around the corner
so we've done rounded you can go up on
mdn and look at all the different
options for line join the line cap and
play around next we need a couple dummy
variables so we're going to say let is
drawing is equal to false and what this
is going to do is when I click down on
this element
I'm clicking down I just did it and I
move my mouse and then I let go and then
I move my mouse again nothing happens
when I'm moving my mouse down it only
draws when my cursor is actually down so
what we're going to do is we're creating
sort of like a flag right here where we
set it to false and then when you click
down we set it to true and when you
click up you let go of the button we're
going to set it default and that's sort
of just going to be our flag to tell us
should we actually draw to this canvas
or someone just moving their Mouse
without doing anything then we need a
couple of variables let last x equals
zero and last y is equal to zero and
last X and last y are going to help us
out because when we draw to a canvas
let's say I have my mouse right here and
I want to move it to right here let's
imagine that was just one straight line
what needs to happen for you to draw a
line is you need a starting x and Y and
an ending x and y you can't just tell it
draw a line at coordinates 100 100
because it how does a line need to start
and a stop not just a start so what
we've done is we've created a last X and
the last Y variable that's going to be
where do you start the line from and
then when we finish drawing it's going
to be where you and next up we need a
function called draw and that's going to
take in an event that draw a function is
going to be called whenever I move my
mouse on top of the canvas
it'll just console.log that event and
we'll listen for our mouse move event on
the canvas so now when I move my mouse
on the canvas it's going to count the
logs draw and when I move around our
mouse now you're going to see
that these events Mouse events are being
logged every time I move the mouse and
on those Mouse events we're going to see
offset X offset Y movement X movement Y
X &amp;amp; Y where all this information about
what happened where was the mouse when
this thing was fired but again we don't
want this draw this console.log to run
all the time we want to only do it when
the person has clicked down so what we
can do here is we'll say if is if they
are not drawing then return and this
will stop the function from running when
they are not most down and then how do
we change that is drawing well we'll
have another event listener here so
mouse down and when the mouse is down
we're just going to run a quick arrow
function inline here that this is
drawing is equal to true and when the
mouse is up is drawing is equal to false
and then a finally one we want to listen
for a mouse out is drawing is also going
to be false because what can happen is
you can click down let your mouse leave
the actual window here and let go and
come back and it's still going to think
that the mouse is down because you never
triggered a mouse up all in that event
so when you mouse out it's going to
automatically say up you are no longer
drawing so with these variables being
set here we should only console.log the
event when my mouse is down so refresh
here we go I'm moving my mouse around
nothing's happening
I'm going to click in and keep moving my
mouse look at all these numbers are
moving and I'm going to let go and move
my mouse around nothing happening good
so that means this function everything
below this one line is only going to run
when the user's mouse is actually down
so that's sort of our click-and-drag
functionality down pat now let's work on
actually doing the drawing so first
thing we want to do here is start a path
so to see T X remember CT x is where we
do all of our drawings for a canvas
in path then we need to start with an x
and a y move it to an x and a y and that
will complete our drawing of X so say CT
x dot move to last X and last Y and then
we are going to line to e dot offset X
and e dot offset Y and again those eat
out offset X and offset Y those values
are coming from the actual event that
happened here and then finally we call
CT x dot stroke so all of these lines
right here
they've just been starting up our line
but we're not going to actually see
anything on the page until we call
stroke now that's not going to get us
there but let's see where we are so far
whoa
what is going on here maybe you can
understand what's going on here we're
drawing all of these actually kind of
cool we're drawing all of these lines
but what's happening is we're always
starting from they will put a comment
start from and go to we're going to
always start from zero and go to
wherever the user's mouse is actually
moving right so what we want to do is
when we're done this draw function we
want to update the last X and the last Y
variables to be wherever they were
so we could say last x equals e dot
offset X and last Y is e dot offset Y
let's see if that does it for us ah
working so far drag oh no a couple of
things happening here first of all let
me just show you a quick ESX trick we
could set both of these variables in one
line where you say last X and last Y or
equal to Y offset X and offset Y that
just allows us to do it in one single
line that's called be structuring an
array but we still have this problem we
got a couple problems here first of all
when I click down my
first drawing is still always going to
start at zero zero and that doesn't
really make much sense and then the
other thing is like when I continue to
draw it just starts off from where I was
so I just I'm only able to draw one
continuous line and nowhere in between
what we can do is go back to this Mouse
down here this function and maybe I'll
move this to the top here just have it
out and rather than just doing this one
quick inline function I'm going to make
that into a block so I can do multiple
things so is drawing it's true but we
also have to update our last X and our
last Y the same as we've done here and
pass the event so what we're going to do
is as soon as the person clicks their
mouse down to start it before we do a
mouse move because Mouse down will
happen before we move our mouse then
we're going to update the last X on last
y and that's going to put us where we
want to go rather than starting at zero
and zero so give that a save now I'm
going to start here click aah
looks like it's actually working connect
start another one good draw another line
draw another line draw another line good
I'm really happy with that now a couple
other things this these lines are really
really small so we could go up to our
contacts here and say CTX line width is
equal to 100 and that will give us a
much you see how the the end of the the
caps are round if I were to take this
line join and line cap off we just get
that wound just kind of funky and that's
going on here and as well as a line cap
it's going to give us this nice smooth
round one so that's the very basics of
drawing on a canvas but let's have a
little bit fun and do something like
this let's first do the the color if you
haven't heard of HSL I need to stop for
just a second and explain it so head to
the website mother-effing HSL and what
HSL is is is essentially the rainbow but
you can programmatically select pieces
of the rainbow so the hue part of HSL is
from red all the way over to red on a
rainbow the a switch is a saturation
just sort of like how bright it is and L
is going to be the lightness and that's
what you can change right here
lightness all the way is white the
absence of lightness is going to be
black so somewhere in the middle is
probably what you're looking for maybe a
little bit higher and that's going to
allow us to programmatically pick the
different pieces of this now that's
really cool because what we can do is if
zero is red and 360 is the other
spectrum that means for every 360 draws
that we do we can just pick an increment
a color and then flip it back so what
we're going to do is go back up to our
initial variables and we're say let Q
equals zero and as we draw before we
begin the path will the CTX dot stroke
style remember we started with bad ass
but now we're going to be setting it to
be HSL and the hue is going to be the
variable hue and then we're going to
give it 100% saturation and 50%
lightness so let's start let's see where
we we get so far okay so it's starting
at zero which is red good but we could
also once we've done that stroke style
or maybe at the end of it here with a
hue plus and that will just increment it
so the second time we draw it will be
one third time will be two okay looking
good looking good
and eventually we're just going to get
all the way around and the kind of the
cool part about HSL is if you go over
360 it's just going to like if we pop it
into here and see what hue is that Q is
906 but it just kind of like keep going
around and around and around what we
could also do is say
if Q is greater or equal to 360 then Q
is equal to zero and just sort of like
reset it at that point and that will
work just as well and then the other
thing that we can do is we can also
change the line width of what we've done
right here CTX outline width but we can
use that variable as well so stroke
style TTX dot line width is going to be
equal to hew see what we got there
so it starts goes all the way up all the
way up all the way up and then at a
certain point it just starts over again
and that's kind of cool but what I've
done here is once you hit that maximum
draw it will just sort of fade itself
back so what we can do is create another
variable here called let Direction
equals true and that means it's going to
be building up so we have let direction
equals true now we have this line width
equal to you we don't want this delete
that line and head down to the bottom
below where we do our hughes stuff and
we are going to for every loop we are
going to increment the line width so
it's a CTX outline width plus plus what
that will do is it will increment the
line width once for every single time
they have those so going bigger bigger
bigger and it just keeps getting bigger
and bigger and bigger infinitely and
that's really not what we want so what
we can say is we'll say if CTX dot line
width is greater or equal to 100 or CTX
dot line width is less or equal to one
then we want to flip the direction
then we say down here if direction is
equal to true then the line list goes up
otherwise the line width goes down now
that might have broken your brain for a
second so let's take a second to see
what's going on here
if CTX outline width is greater than 100
so essentially what we're doing right
here is we're incrementing it from zero
all the way to 100 but then once we hit
100 we're going to go from 100 to 99 to
98 all the way down so we're saying if
it's greater than 100 then flip the
direction or if it's less than 1 also
flip the direction and then depending on
what that direction is we either
increment the line width or if the
direction is going in the other way we
decrement alignment by 1 so let's see
what's going on here draw draw draw and
it's going smaller bigger bigger bigger
smaller smaller smaller bigger bigger
bigger and you can play with these
values as well you could do it something
like 500 where it gets super big and
then it will slowly bring itself down
once we get to 500 and there we go it's
bringing itself down to be much smaller
you can play with it
exactly one other thing we can do is
play with the something called global
composite operator and if you've worked
with Photoshop blend modes you can use
blend modes inside of context so if they
context that global composite operator
equals multiply this is kind of cool
where when you draw on it let me refresh
this here they will sort of blend each
other as you draw over top of each other
eventually everything is just going to
be black but you can play with the
different blend modes that we have here
to subtract enlighten and all that good
stuff so just go and look up global
composite operator on Google and take a
look at the different types that we have
here they've got a nice source over
source in source out source a top
destination over that you just play with
all of them and you can kind of get an
idea for how
or are they actually working so that is
today's exercise we had fun with canvas
we understood a couple things about
events and when events happen we
understand this flag thing where you
said it is drawing and is true and is
drawing equal to false that's sort of a
common thing that we do a lot in
JavaScript where you have a flag where
you want to test if it's true or not and
then when you move the mouse we use the
event information to draw on to our
canvas context hopefully you enjoyed
that I'll see you in the next one</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>