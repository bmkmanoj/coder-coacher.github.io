<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Beginner PHP Tutorial - 123 - Creating a Database Hit Counter Part 1 | Coder Coacher - Coaching Coders</title><meta content="Beginner PHP Tutorial - 123 - Creating a Database Hit Counter Part 1 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Beginner PHP Tutorial - 123 - Creating a Database Hit Counter Part 1</b></h2><h5 class="post__date">2011-04-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/maBMsxf4T2g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi this is Alex from PHP academy' dog
back with another video for the new
Boston now in this tutorial we're going
to be looking at incrementing a value in
a database by grabbing the value and
updating it and we're going to do this
in the way of a hit counter and it's
going to be a unique hit counter we're
also going to have another table
despite the one where we're counting a
single value we're incrementing a single
value we're going to have a table that's
going to store the IP address of the
users that are visited it's a very sort
of loose way to do it it's just going to
give you an idea of updating and and
everything like that but we're going to
keep a track of the users that visited
so if the user has visited we're not
going to increment the value so it's
basically a unique hit counter but using
what we've already learned with with SQL
and SQL statements or queries rather so
we've already got this food table but
we're going to ignore that for now
because that was from the last tutorial
what we want to now do is create a new
table and I'm going to call this hits
count hits underscore count now this is
going to be a single field table gonna
have one field on it and this is going
to just be an integer starting from zero
and we're going to work our way up as we
refresh the page as long as our IP
address doesn't exist in another table
which is what we incur in a minute so if
we click go the field we're specifying
is going to be called count is an
integer we're going to set it as the
primary key because technically is a
unique value however we don't need an
auto increment because we're going to be
specifying this value anyway we could
put Auto increment that would be a lot
easier but it would avoid the point of
teaching you perhaps how this can work
another way so the quick and easy way
would be to click Auto increment but
what we're going to do is we're going to
grab the current value and then add one
to it and then increment so we're going
the long way around things but it's
going to allow you to practice a lot
more okay so we need to save this let's
just go down and save that so we created
this table with this
count value here if we browse the table
at the moment we've got nothing in so
what we're going to do is initially
we're going to need to set this value to
zero by clicking insert entering zero
and clicking go you can now see that
when we browse we've got count equal to
zero now within PHP we're not going to
do anything else in MySQL with regards
to this in PHP we're going to grab this
value add one and then reinsert it into
here or update it rather so we need
another table now and that's going to be
called hits IP and this is going to be a
list of the IP addresses that have
accessed the site so again we just need
one field and this is going to be IP we
don't need to set this to a primary key
this is going to be a VAR char now if
you think about an IP address let's just
go to here we've got a possibility of
this and this amount of characters in an
IP address so we've got three here and
six nine twelve in length add the three
dot is thirteen fourteen and fifteen so
we need it to be fifteen characters or
less and we're not going to sell it to
primary it will give us a warning that
we haven't set it to primary but that
doesn't matter
so now index defined here but that's
okay so IP address is going to be stored
in here in a long list and it counts are
going to be stored in here now there are
other ways to do this obviously we could
just have a method to store the IP
addresses and then count the amount of
IP addresses or unique IP addresses that
were present using the MySQL num rows
function and that's going to work in
exactly the same way so there's loads of
possibilities to create this but like I
said I'm just going the long way around
things so we learn a bit better so back
to PHP we're not really going to do much
more in my PHP myadmin now I'm going to
first of all include or require this
connect file that we've created earlier
on in the tutorials if you haven't
already seen that I suggest you do so if
you don't know how to connect to a
database so we've connected to our
database I'm requiring this within our
page
so if it's not there we're not going to
run the page simple enough
the next thing we need to do is grab the
user IP and I'm going to put this into a
variable called user IP so remember
we're using dollar underscore server and
then we need to remote address in there
with the dress shortened there's another
tutorial on this as well if you haven't
already learn how to do this so we've
created a variable called user IP let's
just echo that out this is just to check
the we're getting a value back correctly
okay so don't seem to be getting a value
back
oh it's because we haven't saved the
file so that would help let's refresh
okay so I've got my local IP address
being returned to me we can test it just
with this so what's going to happen is
I'm going to refresh the page the hit
counter is going to go up my IP address
is going to be stored then the next time
i refresh we're going to check for my IP
if my IP does exist in the database or
in the table rather we're not going to
update account but if it doesn't again
we are so it's essentially like a file
based account like we've already
discussed in some of the other tutorials
if you haven't seen that and you want to
look at that then you can go back and
view them but now we're using databases
instead okay so we're going to be using
two functions within our program I'm
going to predefined these functions out
going to write a skeleton if you like of
these functions and then we're going to
fill them in at later date so the first
function is going to be called an IP
exists and the argument we're going to
give this is IP so we're going to be
specifying the IP address into this
function so it's going to look something
like like this
and obviously this variable here is
going to be user IP so that's our first
function our next function is going to
be let's just say update count and this
is going to take no arguments because
all we're doing is incrementing the
value by one that's simple enough
now because we've declared this user IP
outside of our functions we need to
create a global of these inside so it's
an global user IP that's going to allow
us to use this IP address outside there
and sorry we don't need to do that in
this function but we do in this function
because we need to get the IP and we
need to compare it to the user's IP and
that's been specified so let's just echo
out user IP and check that that works
within that function so IP exists and
let's just give this a value of 1 and we
can refresh now you can see that's still
being echoed out however if I was to
remove this global keyword and just try
and echo out user IP you can see it
doesn't work so we need to make this
globally usable inside of our function</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>