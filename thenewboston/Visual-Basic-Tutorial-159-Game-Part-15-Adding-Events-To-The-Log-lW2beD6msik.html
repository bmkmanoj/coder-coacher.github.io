<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Visual Basic Tutorial - 159 - Game Part 15   Adding Events To The Log | Coder Coacher - Coaching Coders</title><meta content="Visual Basic Tutorial - 159 - Game Part 15   Adding Events To The Log - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Visual Basic Tutorial - 159 - Game Part 15   Adding Events To The Log</b></h2><h5 class="post__date">2011-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/lW2beD6msik" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello YouTube sam here from youtube.com
slash on live gamer for the new Boston
and in this tutorial we're gonna
continue working on the log for our game
now you may be may be wondering how are
we going to use the name of the zombie
or not zombie the enemy if we don't have
name variables that store their names so
what we can do is let's come in come in
to each class we'll do public string
name as string and we'll set it equal to
Zambia now there is one problem with
this this would seem like a simple
solution but if we come over here to
form one dot V B or yeah format maybe
you see that current enemy is subtype
enemy and so anything that current enemy
can do enemy should be able to do too so
if we're calling a current enemy
function here or a method or a variable
enemy has to contain that variable so
come over here and we'll get rid of this
that's not needed
so we'll do public string name as string
and you could ignore that thing I was
just deleted because I was just
experimenting with the code so we've got
public string name a string so now we
can come in here you can see that we get
a message that says it conflicts it
conflicts I mean with a string name in
enemy so in order to get rid of that
instead of read a cleric string name we
can just go ahead and set that equal to
a value so it's going to be zombie and
we need to go ahead and copy this or
we'll cut it and we need to put it in
our constructor so the names gonna be
equal to zombie when a new zombie class
is created
so in our constructor for Dragon will do
string name it's gonna be equal to
dragon villain
string name it's gonna be equal to
filling okay so now that we have string
name for each of the enemies and it's in
the enemy class so we can use it on an
enemy object we can go ahead and use
that whenever we need it okay so now
that we've got all this working we've
created our damaged arrays we've used
names and some indirection to make it
easier to access parts of our program in
our variables what we want to do is go
ahead and create one of the logs now we
have event log VB now this isn't just
gonna automatically open when our
program run runs we have to tell it to
open because form or not VB is the form
that is run by default and no other
forms will run so we need to come in to
form one DB and whenever it loads we
need to create a new log so we'll just
declare one of those so-dimm new log as
new event log
and we need to event log VB now it looks
like we lucked out here because there's
already an event log built into Visual
Basic so we did event log VB so after
that's done what we need to do is type
new log dot Show so it will show us our
new log now we want to be able to access
new log outside of just form one dot
load so we can go ahead got this right
here and we will paste it in the class
itself and we'll just declare it as
private so now that we have new log and
it shows when it's open let's go ahead
and add some stuff to the log but first
I'll show you that it opens with it so
here is our game and then here's our
logged C says event logger has
successfully loaded and it allows you to
select indexes of this so we'll go ahead
and close out of these so whenever you
attack the the enemy after we attack
them what we want to do is we want to
create that event so we will just type
new log dot list events
or we don't want list events we want to
do let's see here figure out what the
name of that is add event so we want to
add an event so new log dot add event
and we need an event as a string
so since create event is a function and
it returns a string we can use that as
the argument for add event so we can
just add event and we can create event
and then the argument is going to be pop
I dot name okay so this might be a
little bit confusing to you but we we
added an event to our list box and for
the arguments of that we use create
event which is a string because that's a
function and it used it returns a string
and that function requires an argument
itself which is the name of whoever it's
making the event for so we'll do that
once more for the enemy attack so let's
see as soon as it attacks we want to
create the event but first we have to
type new log dot add event and then we
want to create an event so create event
and then we'll do
current enemy dot name or string name so
it's gonna create an event based on
their name and it's gonna pass that to
the add event method in new log so
hopefully we won't get any errors from
this okay so here's our game and I'll
just drag the log over here and if we
attack looks like we got an error here
okay so we got a bit of an error there
and I'll tell you why so whenever Popeye
it adds the log for Popeye it says hero
dog attack damaged which is a
an array of integers and it uses at
index of attack num now we can't put an
integer into a string an argument that
takes a string or returning as a string
we can't put an integer in there so we
need to convert that to a string so this
is gonna be the number this is gonna be
the damage that is returned which will
be an integer and then we just convert
that integer integer to a string so
we'll do that once more for this one so
current enemy dotted for the attack
damage dot to string so we've converted
each of those to a string now we'll go
ahead and try this one more time and it
says event logger has successfully
loaded and then we can go ahead and
attack and you can see that says papaya
has used kick for a 10 damage and then
zombie has used punch for 10 damage and
let's just use spinach now you can see
that it says 10 damage right in here we
haven't accounted for in case Popeye
uses spinach and we're going to be
learning about that in the next tutorial
see Popeye uses kick for 10 damage and
then use just 5 let's see let's try to
get popped by to use anchor throw aha
Popeye has used anchor throw for 15
damage so what this does is it just logs
everything that happens each time one of
the users attacks or gets attacked so go
ahead and close out of that so go ahead
and put this code in if you haven't
already then once you've done that if
you don't understand it leave some
comments I'll try to answer the any
questions for you and then after that
move on to the next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>