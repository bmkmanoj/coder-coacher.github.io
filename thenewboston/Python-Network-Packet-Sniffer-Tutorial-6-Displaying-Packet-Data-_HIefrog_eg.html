<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python Network Packet Sniffer Tutorial - 6 - Displaying Packet Data | Coder Coacher - Coaching Coders</title><meta content="Python Network Packet Sniffer Tutorial - 6 - Displaying Packet Data - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python Network Packet Sniffer Tutorial - 6 - Displaying Packet Data</b></h2><h5 class="post__date">2015-12-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_HIefrog_eg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all righty house is welcome back and in
between the last video in this video
what I did is I made the function to
unpack a UDP segment it's pretty much
really similar to ICMP and I also made
this right here actually found it online
it is a function to format Malto
multi-line data so whenever we have like
a long string of data and let's say it's
like I don't know like 7000 characters
long it doesn't all appear on one line
and you have a look to find it all it
just breaks it up line by line in it I
don't know it makes it more readable to
humans so it doesn't really do anything
um you know like packet sniffing related
so figured out save you guys some time
and the last thing I want to mention is
I already made these constants at the
top and these are just tabs or oh oh
smoking too much Multi guess art so I'm
just kidding all right so all these do
is they're just gonna be able to format
our text and I just want didn't want to
put tabs inside my strings because that
way if we ever want to change it then we
just have to do so up here if you guys
are like why do you even need those tabs
well whenever we display this data
remember
what we basically have is an Ethernet
frame and inside that is an IP packet
and inside that is TCP info so I'm gonna
display it whenever we just saw you know
look at it on the screen it's going to
be indented like this so Ethernet
there's your data in ipv4 data like this
and then you're gonna have some data for
that data for that and then of course
your TCP and then here's all your TCP
data so that's what we're gonna do
pretty much display each arm piece of
data that's inside as a new indentation
level just to make it more readable to
humans why not
so before we even start displaying the
ICMP or tcp the first thing that you
probably should do is you need to make
sure well you don't need to do this but
you should probably check let me have a
little comment to make sure you're using
Ethernet proto call eight so whenever
you do this it just means that eight
I'll say for ipv4 so if your Ethernet
protocol is 8 so eath proto equals 8
that just means that you're using ipv4
regular Internet traffic now once we
verified that we are working with ipv4
then we can just go ahead and display
all of the data so remember what we did
is we already made a function to return
the version the header length the time
to live the protocol and we also have
the source properly formatted the
targets and the actual data and we just
have to set this equal to ipv4 packet in
data all right
so basically we're listening for some
data right here we unpacked it and now
what we did is we said that oh that's
actually an ipv4 packet so we can go
ahead and rip out all the information
that we need boom roasted taken care of
so in order to display this it's really
easy just gonna go ahead and tap one
ipv4 packets and now let me just go
ahead and print out the information that
is inside that ipv4 packet so I'm gonna
print out a new annotation level so it's
version
header length and time to live and what
I wanted to do is format this version
header length of time to live now if I
just print all of this information out
on the same line then fee so what I'm
gonna do is I'm gonna actually break
this up into two lines and you guys can
change it if you want but I'm going to
have this protocol source and target
yeah targets alright so now what we did
is we pretty much already printed out
all of the header information for our
ipv4 packet but now what we have to do
is we need to deal with the actual data
that's inside and remember the data
that's inside is more likely than not
going to be either ICMP TCP or UDP how
do we know which one it is well all we
have to do is we test the prototype of
your where is it right here your ipv4
packet so again every arm kind of
encapsulation your Ethernet your IP your
TCP they all have protocols so I think I
keep saying prototype that's not it so
alright so we're first going to check if
it's equal to ICMP now remember if you
look at your little diagram for IP
headers we have a little cheat sheet
that says okay if the protocol is one
that means that there's an ICMP packet
inside if it's equal to six that means
it's TCP data yadda yadda tomato tomahto
17 for UDP whatever so we're gonna test
the proto and if it's equal to one that
must mean like I said that it's ICMP so
we can go ahead and get all this and it
returns four pieces of information so we
can just do this and data equal to ICMP
data so that way we check the proto call
there we go got it right that time and
if it's equal to one then we're gonna
unpack it properly now if it was equal
to one and we try to unpack it using
this function and this can throw a whole
bunch of errors because the data is not
bundled up in that kind of way so that's
basically what we're gonna do now I'll
skip the video ahead because I'm pretty
much doing the same thing over and over
again but once you have all the
information
from whatever type of packet you're
trying to view then you can just go
ahead and display it to the user</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>