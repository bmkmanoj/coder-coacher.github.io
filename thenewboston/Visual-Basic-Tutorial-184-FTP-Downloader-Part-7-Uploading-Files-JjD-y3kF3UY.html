<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Visual Basic Tutorial - 184 - FTP Downloader Part 7   Uploading Files | Coder Coacher - Coaching Coders</title><meta content="Visual Basic Tutorial - 184 - FTP Downloader Part 7   Uploading Files - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Visual Basic Tutorial - 184 - FTP Downloader Part 7   Uploading Files</b></h2><h5 class="post__date">2011-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/JjD-y3kF3UY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello YouTube sam here from youtube.com
slash on live gamer for the new Boston
and in this tutorial we're going to
continue working on our FTP downloader
now you may have been thinking to
yourself that well what if they put in a
an invalid server so let's say this is
invalid when I click Save server
settings you can see that if I click
home directory it's gonna try and
connect to that and you may think it's
going to freeze and crash but you can
see that our FTP client VB class library
has this built into it so so that if it
cannot connect to the FTP server it's
gonna show them a message box saying
that it could not be resolved so it
could not connect now this is something
that makes our lives a whole lot easier
when we're building this program because
it checks for us automatically and it
already has exception handling in it so
thanks to Howard Richards for that so
now let's go ahead and allow the user to
upload a file so we'll access the click
event for upload and what we need to do
is create an open file dialog so we'll
go ahead and get rid of this and what we
need to do is come into our designer
come over to our toolbox and scroll down
to dialogs so we'll open up in or will
add an open file dialog and we'll just
call this open file to upload just hit
enter there and looks like we put that
in the wrong field and needs to go in
the name so now we need to do is we'll
do declare path name as string and then
we'll do file name as string let's go
ahead and type open file to upload dot
title and we'll set that equal to please
so
liked a file to upload okay so now I'll
type if open file to upload dot show
dialog is equal to Windows or let's see
forms windows dot forms dot dialog
result dot okay so if the dialog result
is equal to okay and what do we know
what to do
well we're gonna set path name is going
to be equal to open file to upload dot
file name so this is going to get the
whole directory of the file so now I
need to do is get the file name now this
is where it gets a little bit tricky so
file name is going to be equal to string
or we need to get a substring of the
path name so we'll do path name dot
substring and we're gonna have to give
it a start index so what we're gonna do
is type path file or not path file path
name dot last index of so it says
reports the index position of the last
occurrence of a specified character
within this instance so the last
occurrence of I believe it's going to be
a backslash so at the last index of this
we just want to add one so what this is
going to do is going to set file name
equal to a sub string of path name and
this substring is going to start at the
lab
the currents of the backslash and we add
one to that just so it'll start on the
first character so let's say we got a
whole long directory like C colon
backslash Documents backslash hello dot
txt well this is going to do it's going
to start at the last index of this so
let's say the last index is 15 it's
going to add 1 and so it'll start at 16
and it'll take all the characters after
that which will get us the file name so
now what we need to do is we need to
upload that file so let's just go ahead
and enclose it in a try-catch statement
in case any errors happen so we will
call ftp downloader dot upload and the
local file name is going to be equal to
path name and the target file name is
going to be equal to file name and then
let's see here we'll go ahead and catch
this exception so message box show e x
dot message so the reason we're doing a
try-catch is because we might get a
network error and also these might be
set to null so let's go ahead and
minimize out of that now I know this
part right here can be a little
confusing but if you play around with
this and see changing changing the last
index of this or if you go back to the
sub strings tutorial and you look at
this you will be able to figure it out
and see what's going on so go ahead and
run this so go ahead and click upload
and let's just go to my desktop and
let's add a let's just upload Popeye to
the FTP server so we'll click open and
it's going to open up that file and it's
going to upload it to the server now you
see that nothing's showing up right here
so what we need to do whenever they
upload we're going to need to refresh
the list
now we'll go ahead and run this let's go
ahead and go to the home directory and
you can see here that we have popeye dot
jpg now I'll show you this by uploading
another one you can see here the title
is please select a file to upload which
is what we selected so we'll upload a
villain so we upload the villain you can
see it will update the list box and add
some villain cartoon jpg to it so go
ahead and this code in to upload a file
and once you've done that if you
understand it move on to the next
tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>