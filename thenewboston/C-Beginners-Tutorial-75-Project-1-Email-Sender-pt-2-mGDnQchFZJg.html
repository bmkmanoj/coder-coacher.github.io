<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# Beginners Tutorial - 75 - Project 1 Email Sender, pt 2 | Coder Coacher - Coaching Coders</title><meta content="C# Beginners Tutorial - 75 - Project 1 Email Sender, pt 2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# Beginners Tutorial - 75 - Project 1 Email Sender, pt 2</b></h2><h5 class="post__date">2011-09-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/mGDnQchFZJg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys welcome to the 74th C sharp
tutorial that I'm making it for through
Boston and in this tutorial we're going
to continue working on our email sender
project so all you're going to need for
this tutorial is just what we worked on
in the last tutorial so just double
click on the button the send email
button and you're going to need to be
using the system net map mail and the
system net namespaces the first step in
sending an email at an email is creating
a new instance of the mail message class
so it's going to be panel message I'll
call it a message I'll set it equal to a
new mail message the first thing that we
going to have to do is set the from
address so we're going to message
message dot ROM and we have to set this
equal to a new mail address so we're
going to do new and then mail address to
create a new infants of the mail address
class and inside of here we're just
gonna put the string address and since
the from address will be whatever the
user puts in here for credentials we'll
just do xbox 3.5 so do so here
Xbox 3x we also have to set other things
such as the subject which we will set
equal to on this text box so the user
can provide a subject will do Xbox one
dot X and we also have to provide the
body which is text box to text
so we'll do a message body equals text
box to tag and the last thing that we're
going to have to do inside of this or
with this message class is um is state
the recipients and we cannot do just
message dot on to equals the recipients
because first of all we have to provide
a collection and second of all on the
user can provide multiple um addresses
your email address inside of this text
box
here so remember in the last tutorial we
told the user to separate each on email
address using a semicolon so we're going
to use the split method to get all of
the email addresses inside of this text
box so we're going to go ahead and
create a for each name here so we can
move through the string array that the
split method returns so we're going to
do for each string s inside of um what
it returns so in your text box five dot
X dot split and remember we're going
keep splitting it a semicolon so now it
will return this will return a string
array in this will this for each
statement we loop through each address
inside of text box five and then we just
want to simply add that address to this
song there the two the two lists or to
the address lists so we're going to do
message to dot add an S or the string in
order to send our message we're going to
create new SMTP client so we're going to
do SM GP clients I'll just call it climb
equals a new SMTP client and there are a
few properties we're going to set inside
of this as well we ran a few client dot
um credentials equals new network
credentials and here we're going to have
to provide on the username and the
password and remember we have these text
boxes right here for the email which
will be the username and the password
so we're going to have to be textbox
three will be the user name in text box
for or be the password so we'll be
textbox three dot txt and then text box
or dot text for the password the next
thing we're going to have to do we're
going to do client dot post and we're
going to be sending it through on using
the Gmail service and this is going to
have to be
email now right here so we're going to
be doing SMTP oops smtp.gmail.com and
this is just an example or this is just
the one for gmail.com but you can I'm
sure find other ones on Google the next
one we have to do is the client port and
the port that we're going to use or
you're probably always going to use with
Gmail is 587 and the final thing we have
to do is enable SSL and that is just a
type of protocol I'm not going to really
get into it but we have to enable this
in order to send through Gmail so we're
going to set this equal to true and then
what we can do up here is we can go up
to SMTP client s or oops no you can do
client done send and then we have to
provide the message that we wanted to
send and we wanted to send this message
right up here that we created so we're
just going to do message and now when we
click the send button it should send the
message with all the internal
information that we provided in the next
tutorial on we're going to get into
checking this and cleaning up our
application to make it look a little bit
nicer so see you guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>