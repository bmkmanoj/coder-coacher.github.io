<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Stock Market Analyzer - 7 - Text File to Database | Coder Coacher - Coaching Coders</title><meta content="PHP Stock Market Analyzer - 7 - Text File to Database - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Stock Market Analyzer - 7 - Text File to Database</b></h2><h5 class="post__date">2012-01-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Z8eJ0fMi4UI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright guys so welcome to your seventh
tutorial in now that we basically
created a custom URL downloaded the data
that we needed and we saved it to a text
file the only thing that's really left
to do is take that data or excuse me
take that text file and insert it into a
database so we basically have to take
this data and transfer it from this text
file into a database now wouldn't it be
really nice if there is just one little
function that says okay take this data
insert it into a database well it would
but there isn't so we have to code it
ourselves
so I'm just gonna go ahead and make a
function called file to database and
what this function is basically going to
do is it's gonna take a comma separated
file which we happen to have right here
come separated text file and it's gonna
throw into whatever database we want to
tell it to so we are already connected
to a certain database which was I
believe named YouTube so the only thing
we needed to say is what table do we
want to insert it in so this is gonna
take two parameters a text file because
remember we're gonna be downloading
several different text files one for
Yahoo one for Google one from Netflix
say this is the one for Yahoo that is
why we need to say okay use Yahoo's text
file and insert it into Yahoo's table so
we're gonna be just uh you know worried
about those parameters whenever we are
calling the function but for now I'm
just gonna name the text file text file
and the table the table name and let me
go ahead and just get myself some space
I hate I hate it when everything's all
on the bottom of the screen alright so
we have two parameters we pass in in
this file to database the text file
which is basically what file do we want
to use and the table name of whenever
creating tables in MySQL later on that's
the table name so now the first thing we
need to do is reference this file this
text file so in order to reference a
file PHP use the F open function now
what F open does is it basically you
give
the path to a file now the path to the
file is going to be passed in whenever
we call this function later on in a
variable called text file and now the
second parameter it takes is what do you
want to do with it and just go ahead and
put our for now I I don't want to get in
all this because I don't have time if
you want to know then go ahead and watch
my PHP tutorials but it's basically
saying we only want to read this file so
that's what we're gonna be doing reading
the data from this file so what we want
to do is basically we're gonna be
treating each of these files or excuse
me each of these is a separate line on
each line we're gonna be breaking it
apart this one in this one and this one
in this one and we're gonna be picking
apart this data and storing it in our
table so we just can't say okay take all
this dump it into our table because it
doesn't know does this go in the first
column the second row does this go in
the eighth column ninth row so we kind
of need to break it up in a special
fashion so let's go ahead and make a
while loop so make a while loop just
like that and what this is gonna do is
it's gonna test it's pretty much gonna
loop through this an entire file until
it gets to the end and there's a
built-in function called F AOF and what
this does is it takes one parameter
which is the file a file object and it
basically loops through it until you get
to the end of the file so that's what
feo F means it's something else that's
built into PHP pretty dang awesome if
you ask me so anyways this loop is gonna
run until it gets all the way to the end
of the file pretty sweet huh so what we
want to do as this is looping through
the file well the very first thing we
want to do is we want to grab each of
these things line by line because if he
knows each line is a different date so
each of these lines we want to store in
a different row in our table so how do
we only pick one line from the file well
let's go ahead and make a variable
called line and set it equal to F gets
and let me just go ahead and finish that
and what it does is excuse me I got
Fleming my throat's though go ahead and
pass in this file object now okay I'm
gonna have to get a little deep here
what this does technically is it tests
for the end of the file or the file
pointer the file pointer is basically
this invisible cursor that goes along
and it pretty much points to a certain
point in the file so what F gets does is
it basically takes that pointer moves it
to the end of the line and it returns
this entire thing as a string just
remember this this loops through the
entire file and what F gets does is it
takes a line from that file a line of
text and it returns it as a string so
now this line variable right here is
going to be equal to this the first time
we loop through this the second time we
loop through this the third time so on
and so forth so remember that's what
line is equal to using the F gets
function so now what we want to do is we
need to take that line of data and we
need to break that up even more we need
to break it up into a date oh let me see
if I can remember this date open
high/low close the volume so on and so
forth so let's go ahead and do that
right now so we have this line of data
right here how do we separate this whoa
as we know it's separated by these
little commas hence a comma separated
file so what we can do is we can use an
explode function and it may be kind of
weird just me saying use an explode
function here like you explode a
function what the heck are you talking
about do this first make a variable
called pieces C I before E except that
for C good enough pieces or prices
however you spell it and called the
explode function now this is another
function that you can do to strings and
it's basically it takes two parameters
the first parameter is whenever you have
a string you want to separate that
string into a bunch of different pieces
and those pieces are going to be stored
in an array called this
so what we're basically doing is taking
a string of text and storing it into
breaking it into a bunch of different
pieces and storing it in an array and
that array is going to be called pieces
so you're saying okay you have a string
of text
what is the separator a comma every time
you see a comma it's like a separate
chunk so this is gonna be a piece this
is gonna be a piece
this is gonna be piece and this is gonna
be a piece so on and so forth and all of
those pieces are gonna be stored in an
array called pieces so of course it says
okay
that is what you want to separate it by
what a string of texts do you want to
break up well that line string of text
so basically what we're doing so far is
this we're gonna be looping through this
line by line and on each loop it's gonna
be taking each of these individual
elements in storing them in an array
called pieces so pieces 0 is gonna be
this pieces 1 pieces two pieces 3 so on
and so forth and it's gonna do that and
create a new array called pieces every
single time until it gets to the end of
the file so now that we have an array
called pieces what we want to do is we
want to take we pretty much are gonna
pick apart this array and store the
first piece in the database and you know
instead of me trying to explain it just
wait to the next tutorial in just
remember we have an array of you know
several different elements now we need
to store in a database so that's what
I'm gonna be teaching you guys had doing
the next store I know this is confusing
but once I code it it's gonna be crystal
clear it's gonna make a bunch of sense
so thank guys for watching and I'll see
you then</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>