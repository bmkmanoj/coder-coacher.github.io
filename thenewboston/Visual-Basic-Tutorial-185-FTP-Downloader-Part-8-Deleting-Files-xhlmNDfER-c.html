<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Visual Basic Tutorial - 185 - FTP Downloader Part 8   Deleting Files | Coder Coacher - Coaching Coders</title><meta content="Visual Basic Tutorial - 185 - FTP Downloader Part 8   Deleting Files - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Visual Basic Tutorial - 185 - FTP Downloader Part 8   Deleting Files</b></h2><h5 class="post__date">2011-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/xhlmNDfER-c" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello YouTube sam here from youtube.com
slash on live gamer for the new Boston
and in this tutorial we're going to
continue working on our FTP downloader
so what we're going to be talking about
now is deleting the a file from the FTP
server now if you want to delete upload
and download files in all the pins on
the permissions of the user for the
server so let me open up my FileZilla
server here let's see here it is so you
can see there's a whole bunch of
activity from me connecting to it
through this program if I go to my users
you see I have a tutorials and none of
the shared folders they can read write
delete and append so make sure if you
have an FTP server set up on that they
have all these permissions or if you're
connecting to one because if they don't
have these permissions then you won't be
able to use this functionality so we'll
go ahead and double click on delete and
let's make sure that they have actually
selected a file so if lists FTP files
dot selected index
does not equal negative one then we'll
go ahead and do this now negative one is
the index that is pretty much selected
if nothing on their selected and then it
starts at zero and goes down to the list
so we'll just type FTP downloader
dot delete or FTP delete and then for
the file name we're going to use list
FTP files dot selected item so you may
have remembered when we create a
download we didn't have this if
statement right here so what we need to
do is add that up here so if list FTP
files dot selected index does not equal
negative one then we're going ahead
we'll go ahead and download it so we'll
just end if right here
and if the selected index is negative
one then we just want to tell them so
we're just using else I'll type message
box show please select a file
error and then message box buttons dot
okay and then message box icon dot error
okay so let's go ahead and run this and
see what happens if they try to download
something that isn't there it says error
please select a file and you can hear it
plays that error noise so we'll go ahead
and come back down into delete and it's
a select index is equal to negative 1
then we're going to delete that so now I
need to do is add an else so if it is
then we'll just type message box top so
please select a file and since we're
using the same thing right here let's go
ahead and copy this and paste it
okay so you can see here that we've got
FTP delete and we also have an option to
FTP downloader dot delete directory now
this lets us delete a directory in the
ftp server but we're not going to worry
about that right now
right now we're just going to delete
files so in order to make it to where
they can only delete files and not whole
folders we need to add an end right here
so if the selected index is negative one
and lists FTP files that I selected item
does not contain something then we'll
does not contain a period or it does
contain a period then we want to let
them go ahead and delete it so in order
to use contains what we're gonna have to
do is create a variable
sodimm file as string and we'll set it
equal to this right here so we'll just
copy that and paste it so if the
selected index is not equal to negative
one and file dot contains
a period then go ahead and let him
delete it now we need to get rid of this
right here so we'll go ahead and run
this and we'll go ahead and update not
update so it will go to the home
directory of our server and let's delete
the jackhole copy so we'll go ahead and
click delete and you may be thinking
well it didn't work well if we go back
to the home directory you can see it's
gone so what we need to do whenever they
delete a file is we'll type
refresh lists so whenever they delete it
it's just going to update everything
that is in that list box now what you
could also do is add a message box so
that it verifies then they want to
delete the file but we're not going to
do that because if they're retarded
enough to click it and they don't want
it deleted then that's their own fault
so we'll go ahead and go to home
directory and let's go ahead and delete
this right here and you can see that
it's gone now and if we click a folder
right here and click delete it'll say
error please select a file because that
is a folder and then we can open that
folder and we can delete stuff in there
so we'll go ahead and close out of that
and so put in this code if you haven't
already make sure you change the button
download code and once you've done that
if you understand everything and you
don't have any questions move on to the
next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>