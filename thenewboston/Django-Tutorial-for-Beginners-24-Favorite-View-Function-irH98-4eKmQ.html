<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Django Tutorial for Beginners - 24 - Favorite View Function | Coder Coacher - Coaching Coders</title><meta content="Django Tutorial for Beginners - 24 - Favorite View Function - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Django Tutorial for Beginners - 24 - Favorite View Function</b></h2><h5 class="post__date">2016-03-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/irH98-4eKmQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright guys so right now whenever the
user submits this form what's going to
happen is it's going to package up all
of the data it's going to get whatever
song they selected and it's going to
send it to this URL
music favorite so what is that URL well
it's going to go look in here the URLs
directory and set all right what is the
URL or view function for views favorite
well let me hop over to views and I need
to find a function called favorite so
that is the last piece of the puzzle
that we're going to do right the
function to essentially handle all of
the form data now since we're also
working with the song model instead of
just album we need to import that right
at the top and let me just copy this so
views favorites make a function called
favorite and it takes all the same stuff
so again just like the detail view this
URL structure whenever we call this URL
it also passes in the album ID pretty
sweet so we can actually copy this line
of code to love copy and paste in now
let me give myself some more space to
work all right mate
all right so we already have the album
ID but now what we need to do is we
actually need to make sure that we have
a valid song ID so whatever song gets
passed in we're going to query at the
database and say for this song set is
favor equal to true however if that song
doesn't exist maybe they just didn't
select anything or trying to like hack
our website or something then that's
we're going to say ok instead of just
favoriting a song send back an error
message so that's all we're doing so
make a try statement and mold
we first need to get the ID of the
selected song so I'm just going to store
that in variable called selected song
instead of equal to album dot song set
dot get and PK equals
post song alright so how do we get the
ID of whatever song they selected well
whenever we made this form right here
what it did is it loop through every
single song so for each song it set the
value of it to the song ID so what we're
doing right here is we're saying get the
value of whatever song they selected so
this is going to be equal to something
like 1 to 10 14 whatever so we took the
value or ID of the song and it's now
stored and selected song as long as they
didn't do anything stupid all right so
that's all we have to do in the trice a
statement or the try block I guess is
called now we need to handle exceptions
so if you can't select the valid ID
maybe I don't know like I said they
didn't select anything or they're trying
to hack our website for it ever reason
if the ID is not valid then the error
messages that it returns is key error or
song does not exist so what do we want
to do in this case well we still want to
redirect them back to this template but
now what we want to do is we want to
include an error message so whatever we
write in the error message is going to
pop up at the top
all right so return render and we want
to copy this now just do it by hand art
recurrent return render request and just
remember we're just sending them back to
the details page but instead of just
sending them back with no information
what we want to do is this actually I
can just go ahead and copy this whole
thing I'll show you guys the easy way so
we're basically just going to send them
to that details page but instead of just
sending them album information we also
want to include an error message like
this
error message and what can we say in the
error message oh let's just say uh you
did not select any song a valid song
that might be a little bit better
alright looking good so hopefully they
don't get that but if they do then there
you go so the last chunk of the puzzle
is just L statement and this is if
everything goes fine so if we get error
then it's just kind of return the
function right now so if we get to this
part of code we know that everything is
going smoothly so do you remember how to
update the database to pretty much just
change something well what you do is you
just take selected song and change its
attribute to is favorite to true and
also remember that I said anytime you
actually want to make sure you save the
data to the database you need to
explicitly call the save function so
this just changes the attribute and this
actually stores your changes in the
database so you know what we can do is
this man way too convenient all right
so there you go if everything went
smoothly then we're just going to return
them to this page and hopefully now that
the song is favorite they're going to
see a star right next to it and check it
out so this is the form right here and
in case you guys don't know what I was
talking about this input is essentially
this button and the label is this
section of it right here so let me go
ahead and click I love bacon and hit
favorite and now we can see that we have
a star popping up and now let me click
Bucky is lucky hit favorite and now we
see that we have a star popping up and
this is actually favorited in the
database so just real quick just to
review exactly what happened is it's
going to go through and generate that
form and for each form item it's going
to link each song with a song ID now
whenever we select one such as I love my
boyfriend and we hit favorite what that
is going to do is it's going to take it
and pass that information to music
favorite so music favorite the view
function that was hooked up to that was
just this favorite so that kind of is
the process it goes gets the idea of the
song sets it's attribute is favorite to
true save it in database and redirects
you back to the same page so for the
user it just looks like they never even
left the page pretty awesome that is the
basics of form handling again this is
just one way to do it probably the
easiest way or actually it's not the
easiest way but it's the easiest to
understand so later on we're going to
take a look at some more convenient ways
to handle forms but yeah thank guys for
watching don't forget subscribe I will
see you guys next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>