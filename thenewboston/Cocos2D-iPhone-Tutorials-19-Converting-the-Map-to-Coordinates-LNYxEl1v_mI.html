<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Cocos2D iPhone Tutorials - 19 - Converting the Map to Coordinates | Coder Coacher - Coaching Coders</title><meta content="Cocos2D iPhone Tutorials - 19 - Converting the Map to Coordinates - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Cocos2D iPhone Tutorials - 19 - Converting the Map to Coordinates</b></h2><h5 class="post__date">2010-09-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/LNYxEl1v_mI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright guys now that we've got our map
imported and everything's cleaned
refreshed we're good to go so let's go
ahead and start typing some code the
first thing we need to do is have a way
to reference that layer that we just
made so let's go ahead and this is going
to be basically exactly like this
background layer CC TMX layer but
instead of BG layer name like st layer
for a special tiles layer looks good so
now let's go ahead and copy this copy
that shizz and paste it and there's
through the old copy and paste better
make sure that's right before I so there
we go all right everything looks good so
now we're done with this we don't need
to save it we'll just build it all later
and now let's go ahead and synthesize
this synthesize what was called st layer
and now let's go ahead and d alec if i
can find it and releases so self dot st
layer and set this equal to nil alright
so that takes care of all the
housekeeping stuff make sure one more
time everything's powder i don't want to
mess up there so now what we can do is
go ahead and an init we need to go ahead
and load this layer so expand in it
alright like that and might as well do
it right after we load the background
layer so when you're reading we can
visually see all our layers are loaded
at relatively the same time so what we
need to do is just like this set this
equal to a layer so self dot st layer
equals what map do you want to use the
map of course layer named and the string
for this if you remember from les story
we name this st so now st layer is
actually the st layer and we're saying
alright that's all we need to do well
actually we need to do one more thing st
layer dot
we need the set of visibility to this to
know since when we painted it with those
red blocks that was only for us to see
the game developer when they're actually
playing the game we don't want them to
see that that's only information that we
should have I mean you can have it on
there if you want but your games going
to look pretty dumb so um make sure that
this layer is invisible by the way
anytime you want to hide a layer that's
how you do it all right so now what we
need to do is we need to add a new
method to convert all the tiles to
coordinates later on what we're going to
be doing is working with tile
coordinates instead of the other
properties so we need a way to reference
these styles and retain all right what
the heck is a tile coordinate let me go
ahead and explain to you guys pretend
each of these pretend this pretty much
is our map toyota has built in a
coordinate system for referencing each
tile on your map it starts with 0 0 in
the top left and it goes for example
this one would be 10 20 30 31 32 33
pretty much like battleship if you ever
played that so a nice what we need to do
is find a way to convert our map so we
can reference it as its coordinates
because later on when we check for what
we need to collide in the stuff and I
you know basically what I'm saying we
need a way to convert this map to tiled
coordinates so let's go ahead and enough
from your in let's do it right now it's
going to return a CG points and tile
cord
for and just go ahead and we're going to
pass in a CG points position I actually
got this off of some guy on the forums
and it helped me out a lot so in order
what it's going to do is you're going to
return to us a point an x and y value so
we're going to treat x and y separately
instead of doing it all in one shebang
in order to get the x coordinate
position is very easy just go ahead and
pass in the exposition and / the map
tile size dot with so how easy is this
in order to get the x all you do is take
and take your position and divide it by
the width of a tile and this is going to
give you your x coordinate of wherever
you know whatever title you want why is
a little bit different because we need
to do the opposite of this so this
formula is kind of weird but um this is
what the guy told me to do and it works
for me so let me see if I can remember
this alright so the map the map size the
height of the map and we need a time to
spy the map the tile size the height and
this is pretty much going to give you
the entire height of the map and then
take this entire thing and minus
position dot y and let me make sure
that's right all right looks good and
then take this and divide by the map dot
tile size height just like this so let
me read this and make sure that the map
down map size
the height time is the map that tile
size that I hide my knees position and
doubt why looks good all over the map
tile size height so it looks pretty good
if I messed up your formula again I'm
talking to that guy that I stole this
from dude if I mess up your formula I'm
sorry I'll fix it later but anyways and
what we want to do eventually is
returned CCP X Y so basically all this
method does add it pretty much takes a
tile and converts it to the coordinates
that we need because later on in the
next tutorial we're going to be working
with the coordinates so that's why we
need it well like I said that's for the
next tutorial it's probably going to
take a little bit of time we got one
more method to go and then we see this
game up and running so uh thank you guys
for watching don't forget subscribe and
i'll actually copy this actually you
know what i'm going to copy this method
and post it in my forum so if you want
it you can have it because you know it
took me a bit of searching around to
figure out how to convert the tiles to
coordinates so i want to save you guys
at trouble so there you go click on the
link below and I'll take you to it so
anyways thank you guys for watching
don't forget subscribe and I'll see you
guys later</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>