<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>AJAX Chat Tutorial - 15 - Deleting and Getting New Messages | Coder Coacher - Coaching Coders</title><meta content="AJAX Chat Tutorial - 15 - Deleting and Getting New Messages - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>AJAX Chat Tutorial - 15 - Deleting and Getting New Messages</b></h2><h5 class="post__date">2013-05-24</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/OXEHHkEHwLo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Oh already mother F Oh what the f is
going on okay just working on my rap
song for a second there
but anyways welcome back to the 15th
video and hopefully we're gonna be
finishing up this chat dot PHP file so
the only other thing we have to do is we
need to talk about two other modes so
actually let me just go ahead and copy
this because I'm Way too freakin lazy so
else/if mode equals this and we'll copy
that later but anyways the next mode I
want to talk about is delete and
retrieve new and what this function is
gonna do is basically it's gonna delete
all existing messages in the database so
whenever you know you have your table
and it's full of messages and you're
like boy I wish I could delete those
messages boom let's go ahead and grab a
function that can do that alright so
let's look constructor destructor no
delete all messages mmm that one might
come in handy
so actually what we can do is just grab
this actually I'm not that lazy I can
just go ahead and do it so copy delete
all messages and basically whenever
you're in the mode delete and retrieve
messages new messages you're gonna go
ahead and call your chat delete all
messages
boom roasted that's all it does so
basically send and retrieve new messages
that's what that mode does in delete in
your treatment new messages deletes the
messages and the last mode I want to
talk about is this else if the last mode
and this is C ie ve retrieved new
hopefully I spell retrieve correctly now
what retrieve new is going to do is
whenever you're in this mode what it's
going to do is the job of this is to get
the last I or excuse me to get the ID of
the last message retrieved by the client
so how do you do to this it's very
simple
the only thing in
to do is you need to set ID equal to
post ID because remember this idea right
here what it's going to do is this going
to look at your what you're looking at
on the interface so it's gonna look at
the chatroom and it's gonna get the most
recent ID and it's gonna set ID equal to
that so basically whenever you're in
retrieve new the ID that gets set here
is the ID of the last message you're
looking at now the weird thing about
this is this could be different for
every user depending on when their
chatroom updated so for example if my
chatroom updated an hour ago I'm gonna
have a different ID as yours that just
updated and depending on what value we
sent to the database that's how the
program knows what your message is to
send you back it kind of may be
confusing right now but once you see
this program running you're gonna go aw
and you know you're gonna have all these
epiphany moments and you're probably
gonna leave your job because you're like
what am I doing with my life this ID
that's where it's at I need to go out I
need to move to Italy and find a
girlfriend what the heck am I talking
about let's just get to the tutorial so
the only other things we have to do are
just some simple housekeeping stuff the
next thing is clear the output buffer so
if Obie and I think we did this before
get length so basically is if that has
any links at all then just go ahead o be
clean and these of course are bowen
functions to clear the output buffer and
you can actually move that all on one
line might be a little bit cleaner now
after this actually wrote all these
headers in a separate file you just go
ahead and copy those and paste all these
in save me a little bit typing so like
the comment says right here headers are
sent to prevent browsers from caching
now let me give you guys a real quick
five-second or remove caching caching is
when your browser saves things to save
on loading time for example whenever you
go to a web site like
say you got a like eBay or something
well you don't need to request that logo
every time or else it would just be you
know a waste of resources
so instead your browser saves that logo
and then it just you know displays on
your computer so basically in order to
prevent this from a chatroom because we
don't want to save anything in a chat
room it's always dynamic it's always
moving you're always getting new
information in order to prevent the
problem of browsers storing things which
may make your chat room freeze up we
need to send your browser headers and
headers are just you know it's like
pieces of information that your browser
looks at so that's how you do that if
you ever have a problem with any web
application caching when you don't want
to send a header it should be good or
send it these headers and the last thing
I want to do is echo chat get actually I
can go ahead and get new messages now as
you can see it takes the parameter ID
and we want to pass it in our own ID so
of course the last thing we want to do
in our chat room is get new messages why
do we want to do that well if we look at
this what happens whenever we call this
method
man I need freaking cough drop or
something what happens when we get this
message is we say okay this is the last
message I saw if there are any new
messages after that then please display
them retrieve them from the server get
them from the database and give them to
me so again if we take a look at this
entire file it's very simple we have
basically three different things that
our chatroom can do it can send new
messages it can delete messages which of
course you need to do that unless you
want a million messages on your table
and they can just retrieve new messages
this pretty much means get any new
messages from the server so those are
the three main things it does and at the
it always gets new messages because no
matter if you just sent one deleted one
or you're just you know sitting there
and you wanna you know you don't feel
like typing you're too lazy you just
want to read other people's messages it
can do all of those things so that's why
we always end it with get new messages
and of course this is pretty much the
main interface or the main piece of the
puzzle that ties all of these individual
pieces together so now that we're done
with that we actually have to write one
more it's like a teeny little PHP file
and it's just forgetting the color so
you know you know what color to Center
right here but once we're done with that
we have to work on the like boring HTML
stuff actually it's not boring it's
actually pretty cool like the CSS file
so you know everything displays properly
the main core HTML file in the
JavaScript file because you can't have
Ajax without JavaScript and right now we
only have PHP and that's it so that's
what we have left for more actually
three more small files one more big one
it's gonna be awesome thank you guys for
watching don't forget to join Bucky's
room that comment now we'll smell you
guys later</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>