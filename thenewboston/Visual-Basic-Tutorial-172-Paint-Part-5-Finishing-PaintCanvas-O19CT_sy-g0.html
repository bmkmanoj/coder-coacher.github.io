<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Visual Basic Tutorial - 172 - Paint Part 5   Finishing PaintCanvas | Coder Coacher - Coaching Coders</title><meta content="Visual Basic Tutorial - 172 - Paint Part 5   Finishing PaintCanvas - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Visual Basic Tutorial - 172 - Paint Part 5   Finishing PaintCanvas</b></h2><h5 class="post__date">2011-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/O19CT_sy-g0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello YouTube sent him here from
youtube.com slash on live gamer for the
New Boston in this tutorial we're gonna
continue working on the paint program
and you can find this in the book
beginning Microsoft Visual Basic 2008 by
theorum Willis and by Newsome once again
I have to give credit to them for this
I'm just teaching you guys how to do it
and going through the concepts so this
is that doesn't look familiar to you
then you may want to move back and find
this tutorial that you were just at so
we stopped right here on our select case
graphics tool and we set object graphics
items equal to object graphics circle so
after we do that let's just go ahead and
end our select because we don't need
anything else it looks like it's already
there so we'll go ahead and come down
below and select so now what we need to
do is just add that object to our
ArrayList so we need to check if an item
was actually returned so if well not
return if it said equal to something
that isn't know
so if graphics items or object graphics
item is not nothing then go ahead and do
this now we're using a double negative
here so if it isn't nothing or if it is
something and not equal to null then
what we want to do is add that to our
ArrayList so graphics items dot add and
we're gonna add object graphics item
let's see here
so you can see that it tells us right
here that it is it may give us an error
at runtime but it won't because it
checks to see if it isn't nothing so
let's say a possible way of it not
equaling anything if it goes to the
Select case and we haven't used circle
pin then object graphics item it's not
going to be set equal to anything so
it'll run this if statement and check
this even isn't in if it is something
then it'll add it to the list and this
will prevent an error from happening now
we can also do this by using a try-catch
statement but this way works just as
well too so now we need to do is type me
dot invalidate you can see this as
invalidates the specified region of the
control adds it to the controls update
region which is the area that will be
repainted at the next paint operation so
basically what this means is that we're
telling the program that paint canvas
has been invalidated and that it needs
to repaint itself so it needs it says
something has changed we need to update
and repaint paint canvas because we're
in the paint canvas class right here so
we invalidate it so that it will update
our paint canvas control so now that
we've created everything let's go ahead
we'll come into our form one dot V bean
design and you can see that all we have
to do is we can right click on View code
you can see that we don't have anything
inside of class form one and we don't
need anything so we'll go ahead and run
the program here's our paint VB looks
like I was missing some stuff there so
let's come over here to our paint canvas
VB design and we need to click on the
lightning bolt to bring up some events
so the first event that we're going to
look for is mouse down so if the user
clicks their mouse down then what do we
want to do so let's see here mouse down
so when the mass is down we're going to
check to see what weight
mouse they have which button they have
clicked
so if e dot button so e is the event
args and it's a mouse event args so with
our mouse event args we can check to see
at which button has been pressed
now e can get a little confusing times
sometimes and I completely understand if
you don't fully if you haven't fully
grasped this yet but later on you'll
start to pick it up and it will come
easier to you so if a dot button equals
mouse buttons dot left then what do we
want to do well we want to call do Mouse
paint adieu Mouse paint is gonna take
some arguments so we're gonna need a
mouse event ours so you can see that
paint canvas mount down Mouse town
already has a mouse event ours in that
it has been created when you click the
mouse town so we'll just pass eetu that
so the e that we're passing to that is
this e right here that happens when the
person clicks their mouse down
so wherever their mouse clicks down it's
going to get the x position and the y
position of this ear ight here that is
in the sub paint canvas
mouse down so if they move the mouse
then we also want to paint something so
we'll go to paint canvas dot VB design
and we want the mousemove event so let's
find it here so we'll double click on
mouse move and once again we need to
create that if statement so if y dot
button is equal to mouse buttons dot
left then what do we want to do we want
to do Mouse paint and pass e to it now
he is the mouse event Arc's that happens
whenever they click down so when they
move their mouse down this ear it-- here
is going to get updated so you can
access the X and the y position of the
mouse by using the event arguments so
when they if they click down it'll paint
and if they move the
mouse it will paint as well so hopefully
everything is up and running now so now
if we try to run it you see we've got
paint not maybe okay one more thing here
we need to come into pink Kemosabe B and
we need to find the paint event so under
the paint event basically what paint
does is it runs and it repaints the
paint canvas now this is this may be a
little confusing to you but when you
have this graphics object right here or
this paint event artist and what you can
do is you can draw to your control so
whenever paint canvas is painted what we
want to do is let's use a for each loop
so for each object graphics item as
graphics item in graphics items we want
to go ahead and draw that to the control
so we'll type object graphics item dot
draw and they'll do e dot graphics now
we'll go ahead and run this and then
I'll come back and explain this to you
so here we have our paint VB you can see
that we can draw and it starts drawing
on our circles and our lines now we've
got this ugly flashing and we'll learn
how to fix that in the next tutorial so
basically what this does is we have a
for each loop so it's gonna go through
each item in our graphics items
ArrayList so for every circle that is
great and it is in this graphics items
and it has different values to it such
as the x position in the Y position that
it can use so we've got for each for
each of the objects in our
list of type graphics items what we want
to do is use object graphics items dot
draw and you can see here
and we have our draw it will fill an
ellipse at with the black brush and use
the current rectangle so it's going to
draw that and it's going to use a dot
graphics so I've got E as paint event
args and all paint event args have a
graphics that we can use to draw stuff
to the control so if you have any
questions leave them in the comments
once you've done once you're done
putting this code in go ahead and move
on to the next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>