<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Visual Basic Tutorial - 126 - More On FileStreams | Coder Coacher - Coaching Coders</title><meta content="Visual Basic Tutorial - 126 - More On FileStreams - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Visual Basic Tutorial - 126 - More On FileStreams</b></h2><h5 class="post__date">2011-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Hu0ERUEnlRg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello YouTube sam here from youtube.com
slash on live gamer for the new Boston
and this tutorial we're gonna be
learning more about file streams so
let's go ahead and create a new project
we will call it file writing we'll
select windows forms application and
we'll click OK now I'll just wait for
that to load so once it's loaded let's
go over here to our tool box we will add
a text box we will make it multi-line
make it a little bit bigger and we will
add a button so we'll set the text to
open file now for now this is just gonna
open the same file each time we're gonna
be learning about open file dialogs
later on so then we'll make another
button and we will have it's a write
file so we'll go ahead and set the names
of each one of these so button right and
button read okay so we'll go ahead and
double click on open file and what's one
here we'll just zoom in some okay so
what we need to do to use streams is
import system Daioh so system dot
input/output now let's come up here and
create a new file stream so private file
stream as file stream so now that we
have this file stream it's not set to
anything so what we need to do is set
that to a file now you can see here let
me open this up we have my file right
here which is a text document and it
currently says if this one let me drag
it it says hello so we'll go ahead and
close out of that and if you guys are
wondering what this is it's a picture of
a website that was an attack website and
I recently got a virus on my computer
and Avastin detective sorry to spend a
couple hours trying to get that off and
I just took a screenshot of it I just
wanted to clear that up in case you guys
are like oh what's that okay so we'll go
ahead minimize that so now we need to do
is we need to open that file so what
we're gonna do is we're gonna use FS to
do that so we'll set file stream is
equal to file dot open and you can see
we have open which will open a file we
got open read which will open it and let
us read it we can open the text from a
file and we can open right so what we
want to do is we want to open right so
that we can write to our file and the
argument that it takes is path as a
string so we'll just do it in the
g-drive my file dot txt now if we try to
access directly into the c drive we're
gonna get permissions error because the
application does not automatically have
access to C Drive we'd have to run it as
the admin and that's partly the reason
why why I'm using the G Drive for each
one of these so now we need to do is we
need to write some text to that file so
let's go ahead and first let's put all
of that text inside of the text box so
we'll just do text box one dot text is
going to be equal to and we'll just open
we'll just get the text from that file
so file dot read all text and we'll read
all the text from G :
back back slash my file dot txt now
let's go ahead and take this right here
and we'll cut that and let's put it
under form one load so whatever the form
unloads it's gonna go ahead and add that
to it okay so now we need to do is when
they click write file let's go ahead and
write the file so
double-click on this and we will type FS
equals file I know we want to do FS dot
right and so we're gonna need an array
of bytes so let's go ahead and come up
here and create that in right so we'll
declare an array by using the dim
keyword and let's just call it file
words and we want to make an array of
bytes now we're gonna have to set that
equal to something so we'll just use new
utf-8 encoding will type true in right
here dot now we need to do is type get
bytes so get bytes and then at the path
G : backslash backslash my file dot txt
so this is just basically going to get
everything in that text file and it's
going to write it I mean it's going to
save it in this byte array now we're
gonna have to import system dot text for
this to work so actually who we're not
going to need this right here this is
not the path this is the text we're
going to use so we'll just type text box
1 dot txt so what we want to write to
that file
is our file words and we need to add the
parentheses or not
what is offset it by zero and the count
is going to be the file words dot length
so we're gonna take this file words by
array and we're going to write it to our
file that we've opened which is gee my
file dot txt and then what we want to do
is offset it by zero which basically
we'll just put it right in after the
last character and the length that we
want to write it is pretty much
everything inside of this array which is
file words dot length now I let's make
sure everything is working so we'll go
ahead and run this okay so we'll type
hello YouTube and then we'll click write
file now let's go ahead and close out of
this and we'll open that file back up
and see if it saved our changes so you
can see here that we've got hello
YouTube inside of our text file so
obviously there's some changes that you
can make in this for the better as you
can see when they have to click read to
actually open the file to be able to
write to it we should have put that
under for more load but I just put it in
there for this tutorial and whenever
they want to write it's gonna go ahead
and get the bytes for whatever they put
in the text box one now the reason we
need to do this is because the write the
right function or method only accepts a
byte array so we just need to create
this you don't really have to know what
this means it's just UTF encoding is the
standard used for text files we want it
to be true and then we want to get the
bytes of whatever they've typed in so go
ahead practice this and once you got
that down go ahead and move on to the
next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>