<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Visual Basic Tutorial - 142 - SMTP Client Part 2   Creating The Message And Credentials | Coder Coacher - Coaching Coders</title><meta content="Visual Basic Tutorial - 142 - SMTP Client Part 2   Creating The Message And Credentials - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Visual Basic Tutorial - 142 - SMTP Client Part 2   Creating The Message And Credentials</b></h2><h5 class="post__date">2011-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/IBlEKPmsRF8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello YouTube sam here from youtube.com
slash on live gamer for the new Boston
and in this tutorial we're gonna be
continue working on the email client
that we created in the last tutorial now
all we've done so far is created the
interface for it and we created two
variables we've got a my message as a
mail message and an SMTP sender as the
SMTP client so let's go ahead and make
some subs here so we'll do private sub
create message and we're not going to
need any arguments for this because
everything is stored in our text boxes
so let's go ahead and set the name for
each one of these so we'll do text from
text pass text to subject and body so
it's hex subject text body
okay so whenever we create the message
what we want to do is use our my message
object so my message dot from says get
Sir Cecily from address address for this
email message so we're gonna have to set
that equal to whatever is in our text
from so what we're gonna do is create a
new mail address and it says represents
the address of an electronic mail sender
or recipient so what this is going to do
is it's gonna do everything for us and
all we have to do is provide the text
that contains the email address so we're
gonna create a new mail address and then
we're going to use text from dot text
dot trim
now what trim does is it removes any
blank spaces they that they have in
there so let's say they were they
started off they'd put a space and then
typed in their email well trim is going
to take that out for us so this will
prevent errors from happening okay so
now the next thing we're going to do is
get the two we're gonna use the password
later on when we actually send the email
so we're gonna do my message dot two and
now we're just going to add another
email to send it to so we're going to
set that equal to actually we're not
saying that equal to we're using an
address as string so we're gonna have to
pass a string to this so I'll just do
text to dot text and we'll go ahead and
trim that to get rid of any blank spaces
so we added another person to send it to
now we're going to need to do is add a
subject so my message that subject
equals and we're just going to do text
subject dot text so it gets the subject
that they typed in and now what we need
to do is we need to create the body so
my message dot body gets or sets the
message body we're going to set that
equal to text body dot text now we can
also set the priority of this so my
message
priority equals let's see mail priority
we can do high-low or normal and this is
an enumeration so let's just go ahead
and leave this at normal so now we've
initialized our message now let's create
a sub that will set up our SMTP client
so private sub create SMTP okay so now
that we've created this sub what we're
gonna need to do is set some attributes
of SMTP sender so SMTP sender dot you
can see that there's a whole bunch of
stuff right here so let's start off with
the credentials so what we're gonna have
to do is create a new net dot Network
credentials says provides credentials
for password-based authentication
schemes such as basic data digest anti
LM and Kerberos authentication so
basically what this means is we're gonna
give it a password and a username so the
username is going to be text from dot
txt and then we'll just trim it and then
we'll set the password to text pass text
dot trim so now that we have our
credentials for our SMTP sender so it'll
actually send it using a valid email
address let's go ahead and set some
other attributes of our SMTP sender now
we can enable SSL encryption so that
it's a little bit safer so we'll just
set that equal to true now I'll do SMTP
sender dot and what we're going to need
to do is use the host so the host for
live email address email addresses is
SMTP live.com
so this is what it's going to connect to
to send our email addresses I mean our
email - so then we'll do SMTP sender dot
port equals and we're gonna have to
supply the port that it connects to now
I believe the port is 587 we'll just
have to see if that works
okay so now I've got our create SMTP and</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>