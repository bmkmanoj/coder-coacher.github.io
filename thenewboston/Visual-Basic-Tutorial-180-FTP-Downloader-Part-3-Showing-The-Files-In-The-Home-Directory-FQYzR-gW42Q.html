<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Visual Basic Tutorial - 180 - FTP Downloader Part 3   Showing The Files In The Home Directory | Coder Coacher - Coaching Coders</title><meta content="Visual Basic Tutorial - 180 - FTP Downloader Part 3   Showing The Files In The Home Directory - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Visual Basic Tutorial - 180 - FTP Downloader Part 3   Showing The Files In The Home Directory</b></h2><h5 class="post__date">2011-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FQYzR-gW42Q" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello YouTube say I'm here from
youtube.com slash on live gamer for the
new Boston and in this tutorial we're
gonna continue working on the FTP
downloaded now while we're working on
this program we're gonna be jumping back
and forth through different things so
you may want to watch start to end these
tutorials because in each tutorial we're
going to be working maybe on one
specific thing but then we're also going
to be working on other things as well so
let's go ahead and get started we'll
come over here to FTP down letter we'll
select our form and we'll click the
lightning bolt and we need to access the
load event so whenever it loads we need
to get the username and the server and
the password and we need to store them
somewhere so let's make a variable
private and we'll just call it FTP
downloader as a new and now we're going
to have to use our class library that we
reference so we'll do it utilities dot
FTP dot FTP client which is our class
so now we have our FTP downloader which
is from our class library that we
imported so whatever the form will loads
what we want to do is let's just go
ahead and disable open folder because
there isn't a selected index in here and
they can't open a folder and it won't do
anything when they click it
so we'll do button change directory and
I know that's kind of a stupid name
because it has nothing to do with it
open your folder but that's just where I
David because it pretty much changes the
directory so we'll set button change
directory enabled equals false and now
we need to do is set the credentials for
our FTP for the username the password of
the server so FTP downloader dot
and now we're gonna have to use our
server so we'll go ahead and we need to
use the let's see hostname
yes it is the host name I don't know why
he used host name right there
it's a little confusing he should just
use server but oh well so the host name
is going to be equal to text at the FTP
server dot text dot trick so whatever we
use trim it's gonna trim any white space
and that is in here so let's say they
add some spaces before FTP or somewhere
in the middle it's gonna get rid of
those so this will prevent errors from
happening later on and we'll do that
again for each part of our form so FTP
downloader dot username is going to be
equal to text FTP user and then we're
going to use dot text dot trim and let's
go ahead let's not use trim in there in
case they need to have spaces and then
FTP downloader dot password it's going
to be equal to a text ftp password
so when the forum loads it's going to
disable this button and its potentials
for our FTP downloaded object which is a
type FTP client ok so now what we want
to do is we want to set set it to the
home directory when they click on home
directory so that we can view all of the
files in there so what we're gonna do is
type FTP downloader dot current
directory so we're gonna access the
property current directory we're gonna
set that equal to forward slash now the
root directory for all FTP servers
it's just going to be a simple forward
slash and all of the files and folders
are going to be stored under that so
after we do that we're going to have to
add all those files to the list box so
let's go ahead and we'll create an
method to do that so private sub refresh
list and whenever they were foot refresh
the list let's go ahead and clear list
FTP files and we don't want to clear
selected we want to do list FTP files
dot items dot clear now let's just go
ahead and calm this or say
really important
ads
items to list box
okay so now what we want to do is let's
use a for each loop so for each file in
and now I'm going to get the directory
of our FTP server so the way to do this
is type FTP downloader dot and now we're
going to need the directory so we're
going to use the list directory detail
so what this does is it'll get all the
files for us inside of the FTP server so
it's going to split each file into an
item and each time it goes to this for
loop file is going to be different so
we'll type list FTP files dot items dot
add and we're going to do a file dot
file name so what this is gonna do is
it's going to add each one of those to
the list box now let's just go ahead and
do a try-catch statement so in case
something happens our whole program
normal to crash so a try-catch and in
try
and we'll catch e^x as exception and
we'll do messagebox dot show e^x dot
message so let's go ahead and run this
and hopefully everything is going to
work fine so here's our form and let's
go ahead we can update the server and
let's see here let's go ahead and go
through the home directory
looks like we're getting a bit of a
problem here when I copied and pasted
over from the earlier from my my version
of this I set these two disabled
automatically so let's go ahead we'll
come in here and we'll set enabled equal
to true so we will do enabled equal to
true and true and true
and now I need to do is whenever they
click home directory we're gonna have to
call refresh list so refresh list that
was one of the problems that we had
before too so it's gonna set the
directory and then add all those items
to the list box so hopefully everything
will work fine down so we've got our
server which is FTP at localhost that I
have here the usually named image
tutorials and when I click home
directory you can see that Windows
Firewall blocks some of these features
because Windows File Firewall doesn't
really like FTP servers so we've got
application files hi and a whole bunch
of files that I created in the FTP
server directory that we can access by
using this program then you could also
see here that our open folder button has
been disabled so go ahead put this code
in if you haven't already and then once
you do that you can test it if you know
somebody who has an FTP server or if you
have one of your own you can go ahead
and connect to that so if you have any
questions leave them in the comments
below and stay tuned for the next
tutorial where we're going to continue
working on this</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>