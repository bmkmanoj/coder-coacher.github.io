<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Beginner PHP Tutorial - 125 - Creating a Database Hit Counter Part 3 | Coder Coacher - Coaching Coders</title><meta content="Beginner PHP Tutorial - 125 - Creating a Database Hit Counter Part 3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Beginner PHP Tutorial - 125 - Creating a Database Hit Counter Part 3</b></h2><h5 class="post__date">2011-04-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZKxpglN9C_8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">and so let's refresh a couple more times
two three four so now I'll count it
equal to four so we've successfully
created our function to update the count
value however what we need to do now is
we need to check whether the IP address
already exists in the table but we
haven't actually input our IP address
into the table yet so we need to do that
first so let's change this back to zero
okay so let's not call this update count
function for now now what we've got now
is a function that's going to work let's
just get rid of this if statement is not
required at all we just are updating the
query there and if it doesn't work we
are we're silencing this anyways so
because it doesn't really matter anyway
okay so we've created our function which
is update account that works and we can
use that later on to update the count
if eval if this function returns true so
if the IP address does exist
so let's term first of all up here every
time our page is run we want to store
the users own oh sorry okay
so update count is fine we've got IP
exists and we also want a function I
didn't think this through properly
obviously we need IP add and this is
going to app this is going to add an IP
address to our database so again we're
taking in IP and okay yeah so I P add so
we need to add an IP address to our
table our table is just refresh this to
blank that our table is hits IP and our
field is IP so what we want to do is we
want to first of all create a create
query and this is going to be equal to
insert in capitals insert into and our
table name is hits I hits IP insert into
IP values and we only have one value so
that's it values is the IP that we
specify in here so that can just be IP
like that now we come down and we say
query run equals of my SQL query query
okay so let's just first of all get rid
of that and and we need to call this
function so what we're doing is down
here we're calling the function we're
saying IP add and the IP that we want to
specify is the user IP so we call this
function the user IP which we've grabbed
from our session our server data is
transferred through to this function and
is added to the database because we're
taking this argument here and putting it
in here okay so user IP is added to a
database now let's check if this was
working let's go back and refresh okay
let's go into browse and you can see
that our IP address has been added okay
so we also have a problem here in the
fact that a duplicate entry might exist
so we might have two of the same IP
address in here however we're going to
do this later on in our if statements
we're only going to add an IP if it
doesn't already exist in the database
and that's what we have let's just
delete this function that's what we have
this function IP exists for now remember
we got the global user IP from here so
we're accessing this IP address from
outside the function now we need to well
I've added the IP into the IP address
and now we can check if it's there or
not so we're going to perform the check
first of all while it is in there then
we're going to perform the check after
after I've manually deleted it so IP
exists first thing we need to do is
create a query and the query is select
IP from and we can put these in there
select IP from hits IP where
and IP is equal to user IP now let's run
this function and then I'll explain a
bit about what we're doing or what we're
going to do okay so this function is
going to select an IP address which we
don't we don't need to do we could have
select its star but I've just specified
it from the hits table where we've
already got one IP address which is one
two seven dot dot dot one where the IP
equals my current IP address now what we
can do is we run the query and we can
return the amount of rows returned
now if the rows returning is equal to
one this means that we the address
already exists in the database if we
return a zero rows there's no rows then
the IP address doesn't and remember we
do this using the MySQL num rows
function</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>