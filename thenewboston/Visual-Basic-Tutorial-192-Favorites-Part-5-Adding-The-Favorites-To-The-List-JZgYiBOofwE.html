<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Visual Basic Tutorial - 192 - Favorites Part 5   Adding The Favorites To The List | Coder Coacher - Coaching Coders</title><meta content="Visual Basic Tutorial - 192 - Favorites Part 5   Adding The Favorites To The List - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Visual Basic Tutorial - 192 - Favorites Part 5   Adding The Favorites To The List</b></h2><h5 class="post__date">2011-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/JZgYiBOofwE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello YouTube say i'm here from
youtube.com slash on live gamer for the
new boston and in this tutorial we're
going to continue working on our
favorites viewer application so before
we get started I was going to give full
credit to the authors of beginning
Microsoft Visual Basic 2008 the authors
are thearon Willis and Brian Newsome now
they've made it made this great app I
only found one error in it so far but
I'm going to be using it to teach you
guys some visual basic concepts so if
you don't know where we are right now
then you may want to move back to one of
the earlier tutorials so if you remember
from the previous tutorial we added this
if statement so if the file ends with
dot URL then we want to try and get that
and use it as a favorite so we can use a
trice try-catch statement and what does
it close it in this in case any errors
happen so since the web favorites class
right here implements idisposable we can
use the using keyword so using object
web favorite which is the name that we
just created for the web favorite object
as new web favorite so we're creating an
object of the class web favorite which
just gets the favorite the favorite URL
in the name so that we can use it later
on and that's the purpose of this class
to get the name in the URL of a certain
file so with this object what we want to
do is we want to load the file
information so we'll type object web
favorite dot load and we're going to use
string file so string file is the let's
see here the file that is in the
directory that we're currently in which
is the favorites directory and it's the
file that ends with that URL so object
web favorite load so you can see here
we've got web favorite
dot load and what this does is it gets
the text from that file and it's stored
and it extracts the URL and the name so
it's going to load that file and then
we're just going to add that to the
collection of favorites so favorites
collection dot add and then we will add
object web favorite so you can see your
favorites collection is initialized to a
new web favorite collection up here and
the add method will go up and look at
that it's just going to add the web
favorite object to our list and we're
passing object web favorite to it and so
here is our end using and if we catch an
exception let's just go ahead and let
them know so we'll type messagebox.show
I x dot message ok so for the time being
we're done with creating and editing our
classes so let's go ahead and let's find
viewer dot V B so we'll double click on
the form itself to open up the load
event for it so whenever our favorites
viewer loads what do we want to do well
we want to get all of our favorites and
load them into the list so we'll just
close this in a try-catch statement in
case anything goes wrong so we're going
to be using object favorites as new
favorites now the reason we're using
using is because once we've added all
this stuff to the list there's no reason
for us to keep this object and the
object favorites or the favorites class
implements idisposable so we can use the
using keyword so while we're using
objects favorites what we want to do is
scan favorites so object favorites dot
scan favorites so we're using the
version of this method that doesn't take
any arguments so whenever we call scan
favorites is going to scan favorites
it's just going to scan our default
favorites folder so we'll go ahead and
come back in here and after we've
scanned the favorites and what this will
do is it'll add the favorite to our
collection so for each it's going to add
each of the favorites to our collection
whenever we scan the favorites so now
what we need to do is we need to go
through each of the web favorite objects
in the favorites collection so we can do
this by using a for each loop so for
each object web favorite as web favorite
in object favorites dot favorites
collection now this might be a little
confusing so i'll go ahead and explain
it so we're creating an object of type
webs fit web favorites and it's going to
be inside of object favorites favorites
collection so here's object favorites
and you can see here that we have
favorites collection which is a type web
favorite collection so favorites has a
collection that we can use to store each
one of the favorites so we're going to
go through each of those favorites
inside of this collection and what do we
want to do with those favorites well we
want to add them to our list so before
we can do that we need to declare object
list view item as new list view item now
you can see that it says represents an
item in a system dot window stop forms
that list view control so it's just
going to be an item that goes under one
of these columns so now that we created
an object of the item let's go ahead and
when you set the properties of it so
we'll type object list view item dot
text is going to be equal to object web
favorite dot name so we have object web
favorite right here and it's it'll go
through each of these object web
favorites in our collector
so it's going to get the name of that so
the name is going to be the name of the
file which is let's see right here name
and just uses this substring to get the
name of the file and leave out the stuff
that we don't need so now what we need
to do is when you sit some other values
so object list you item dot sub-items
dot add and we'll add object list view
item or not that I'm sorry about that we
want to add object web favorite dot URL
now because this URL column right here
is a sub item of our list view we're
going to use object list your items sub
items now add and we're going to add the
URL so after we've created this list
view item we're just going to have to
add it to the list so we'll type list or
list favorites dot items dot add anyone
AB this list view item so we'll just
type object list view item and we'll
close that off right there and now if
there's an exception we just want to
show that</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>