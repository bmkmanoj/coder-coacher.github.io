<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python Reverse Shell Tutorial - 13 - Creating the Threads | Coder Coacher - Coaching Coders</title><meta content="Python Reverse Shell Tutorial - 13 - Creating the Threads - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python Reverse Shell Tutorial - 13 - Creating the Threads</b></h2><h5 class="post__date">2015-12-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FsqkY32nXJs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright guys welcome back and now that
we got the majority of our code taken
care of we can now finally set up the
threading now remember in this program
we basically want to split it into two
tests that are going to run at the same
time the first thread is just gonna be
sitting waiting and handling connections
so whenever a new computer connects it
takes it and adds it to the list
now the other thread is the part where
we interactive the turtle where we can
look at all the connections and we can
select a computer and then we can send
it commands so we basically have a
program that does two things at once
so if you guys are unfamiliar with
threading in Python I'll give you guys a
really simple overview of how it works
and that will take like 20 seconds
basically each thread is like a worker
now once you have a bunch of workers you
pretty much give it a to-do list so you
can actually have 8 different threads
and have like 200 items on your to-do
list and then each worker is gonna do an
item and then go to the next one do an
item go to the next one so the more
threads you have the faster your entire
job gets done so what I would do now is
pretty much just set it up that way now
like I say you can have like 8 threads
you can have like 32 however many you
want
but for us we only need 2 we only need
two workers one of them is going to do
job number 1 which is handling
connections in the other one it's gonna
do job number 2 which allows us to
interact so I'll say create worker
threads so that's what's gonna happen
I'll say find great workers so basically
all we're going to do in this function
is create the threads create those
things that are gonna work so I'll say
for underscore in range
number of threats so you know before
what I did is I added this constant and
set it equal to two well that is because
we want to create a bunch of workers how
many do we want to create two now the
reason I like having this at the top is
because pretty much all my programs I
make using threads are the same and if
we ever want to create eight workers we
don't have to come down here and find it
again we just have to change that
constant at the top so basically all
this loop is going to do is just look
through two times so you make a thread
the same way every time so just don't
like write this code and call the
function like over and over and over
again so I'll show you guys how to make
a thread just make a variable I name it
tea instead of equal to threading dot
thread now once you make a thread you
actually need to pass in a target and
this is basically the job or work than
it needs to do so we're gonna make a
function later on call it work but for
right now that's its job so we're gonna
make a thread called tea and it's gonna
do whatever we tell it to now another
thing that I just want to specify is for
daemon set this equal to true so
whenever we do this this means that this
thread which is basically a mini program
it's going to die whenever our main
program exits if we would set this equal
to false then we can actually quit out
of our main program and have this keep
running in the background but I don't
want to do that I want to say if we ever
decide to stop this script then we don't
have any weird crap running in the
background so just keep that equal to
true and then you just start it off so
what we did is we created two threads
and they're both going to do this same
function and we'll specify the
differences in this function and then we
said okay go that's basically what we're
doing alright so now that we have the
workers actually let me go ahead and
before you make this work I want to show
you guys how to create the jobs so I'll
say each
is a new job now what we do is this I'll
say fine great drafts all right so say
for X in job number what I want to do is
I want to add it to the queue so Hugh
put X and I want to do you to join
alright so basically our jobs are this
job one and drop - oops didn't mean to
move that all right now this is just so
I can explain it and it helps me think
about threats but basically what's going
to happen is every time we create a new
thread it's going to get the next item
in the queue and this is the job queue
so this is pretty much for me but this
is what the threads actually look at so
we're gonna loop through this list and
we're gonna add one to the queue then
two to the queue so each thread is just
gonna go through that queue which is
basically a to-do list and handle it
however we tell it to so right now it's
gonna look at one and be like okay I see
job one what the heck do you want me to
do with this just you know so that is
where we need to define work and I'll
just write this so the point of work is
just do the next queue and I'll say uh
one handles connections the other sends
commands so those are the two jobs and
what we're gonna do is this so we're
just gonna say while true what we only
do is just get the next item from the
to-do list so that queue we just want to
call get so the first time this loops
through X is going to be equal to one
the next time it's going to be equal to
two because we only have two jobs so we
only need to test for those so if
X is equal to one then we just want to
create the socket bind it to the host
and start accepting connections all
right
so actually it does all right now
another thing we want to do is for the
second thread or the second job I
probably should say is all we're going
to do from here is start turtle now all
these other functions sent our commands
get target those are all called from
turtle so we don't need to list those
specifically
so whenever turtle starts it pretty much
just runs now the last thing I want to
do is you should always call tasks done
so this basically signifies to your main
thread that hey we're done taking care
of everything and that is if we decide
to ever break all the connections and
quit out of turtle then it just says hey
our main program is done um you know you
can do something else free up that
memory but basically that's all we're
doing so in the videos before this we
created all the code to handle the
connections and then we created the code
to pretty much control another computer
and in this tutorial we created two
threads and then we set thread number
one this is how you handle the
connection 3 number two this is the
function that you have to call that
allows us to actually connect to and
control another computer so right now
we're just converting the human readable
list to the thread readable queue and
boom roasted so two more lines of code
all we have to do is call creates
workers and that creates your threads
and then create jobs and ladies and
gentlemen we are done with
surfer UI so let me just clear up these
blank lines of codes all right
so we created the workers created the
jobs and once we have both of these
created then the threads are just
automatically you're gonna start working
you don't need to say like start working
now the threads are just gonna wait and
whenever they have jobs they're just
going to start doing that so there you
go we are now ready to move on to climb
dot py and we can actually run this on
the server right now and boom look at
that it's running good to go no errors
look and cool see you guys next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>