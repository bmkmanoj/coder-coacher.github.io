<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# Beginners Tutorial - 177 - Zipping Files and Folders | Coder Coacher - Coaching Coders</title><meta content="C# Beginners Tutorial - 177 - Zipping Files and Folders - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# Beginners Tutorial - 177 - Zipping Files and Folders</b></h2><h5 class="post__date">2011-09-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0haa-piN1JE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys welcome to the 177th c-sharp
tutorial that I'm making for the new
Boston and in this tutorial I'm going to
be showing you how to zip both files and
folders and unfortunately Microsoft
doesn't have a class that will allow us
to do that so we're gonna have to
download a DLL so just go on google
right here and type in all dot that zip
and then just hit the first link right
here it should say dotnet zip library
and then once this page is loaded hit
the Downloads tab and then you're just
going to want to click the first link on
this page right here it should just say
dot nadz lip library - dev kit and then
once you accept this license agreement
then it will download all the zip file
and inside the zip file you should see
something like this and you're just
going to want to go right here inside of
this tools folder and extract the
psionic dot zip DLL and then once you've
extracted it go into c-sharp and edit as
a reference so just go into the solution
Explorer right here right click on
references and head add reference then
just go to wherever you extracted your
DLL and then just hit OK alright so now
that we have added off that zip DLL to
our references we can just go over here
and create a using statement so that we
can use the code inside of that DLL so
we'll say using ionic zip alright and
for this tutorial you need to have an
open file dialog a folder browser dialog
and an if statement checking the CF when
the user actually does open the Open
File dialog that they select file so now
that we can use this zip or all these
zip classes right here we're just going
to want to create a new instance of the
zip file class I'm just going to call it
to the f3
I'm just going to call it ZF or a zip
file and set it equal to a new zip file
and inside of this these two parentheses
right here you're going to want to give
the path a zip file so we're just going
to want to create it on my desktop so
let me say C slash users users
Adam /up and then after the last one you
can just name it anything you want I'm
just going to call it my the file dot
make sure it has a zip extension on it
all right so now we can begin adding
files towards the file so just going to
say the CF dot add file and we're just
going to want to give the packs for the
file that we want to add and that's
going to be whatever file that the user
opens in the Open File dialog so we're
just going to stare it here ofd dot file
name and the second parameter that
you're going to want to pass through is
the path to the file that is the path to
where your file will be in the actual
zip file and if you want it to be in the
root of the zip file you're just going
to want to put empty string right there
all right and then we're just going to
save your zip file or create it so
you're just going to say ZF dot save and
this will basically just build or create
your zip file all right so let's debug
here and make sure that this works so if
we click this button unless is if this
document dot txt now let's go on my
desktop and you should see yep my zip
file right there we open it up and you
see that right inside of there is that
document dot txt file all right so let's
just go ahead and delete this all right
so now what if we wanted to actually add
a directory inside of our zip file well
you're gonna have to add it before you
add the file so you can specify the
directory because if we added a
directory after this and try to specify
the directory up here then the directory
wouldn't exist yet so it throw an error
so we're just going to say ZF dot add
directory by name so we're just creating
a new directory in there and I'm just
going to call it Adam and then we're
going to place this document txt file
inside of this Adam folder right here
alright so let's just do bug and open
that document dot txt file all right so
now if we go on our desktop right here
and open the zip file up we see that
there is an Adam folder and inside of
that Adam folder there should be our
document text all right now the last
thing that I'm going to show you
you is adding an actual directory to the
zip file so when you actually open or
select yourself so instead of showing
the Open File dialog here we're going to
want to show our folder browser dialog
and then we're just going to add a
directory and not a file so I'm going to
say add directory and the directory name
will just be the path to the directory
that the user opens in the dirt or the
folder browser dialog so we're just
going to say F VV dot selected path for
the path to the folder that the user
opens and not folder browser dialog and
then the second parameter just like the
file is the location in the zip file to
where your file will be saved and we're
just going to have it be in the root but
you could have it be in this atom folder
since we've created it up here but I'm
just going to delete this since we're
just going to have it in a root alright
so let's just go ahead and debug here
and make sure that this works it's going
to go ahead and zip that folder folder
and let's make sure this works we go in
there and we see that the contact codes
are the contents of this folder folder
are now stored inside of the zip file
alright so that's pretty much it for
this tutorial so see you guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>