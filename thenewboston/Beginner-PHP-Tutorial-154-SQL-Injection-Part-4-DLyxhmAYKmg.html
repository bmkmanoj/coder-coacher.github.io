<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Beginner PHP Tutorial - 154 - SQL Injection Part 4 | Coder Coacher - Coaching Coders</title><meta content="Beginner PHP Tutorial - 154 - SQL Injection Part 4 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Beginner PHP Tutorial - 154 - SQL Injection Part 4</b></h2><h5 class="post__date">2011-04-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/DLyxhmAYKmg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so if we if we type in say Alex and pass
one two three we've got Alex and pass
one two three now let's type in this
value that we typed in earlier so we've
got we've got a semi sorry we've got a
single quotation mark a space or and two
single quotation marks equals single
quotation mark let's go ahead and press
on I would put it in here as well so
there we go let's press ENTER you can
see that these values have been
transferred through literally so
nothing's changed we've transferred the
exact data that we've typed into the
form now this is the reason that our SQL
can be modified so with as it stands at
the moment if we had these uncommented
we could run a query query of our choice
so let's go ahead and uncomment this now
we've we've processed our query if
something was in here now to delete
something or modify something then this
is deadly however and I'll use a login
system we are creating an if statement
to check how many rows have been
returned because if the username
password don't equal the same thing in
this in the same record then we can't
look the user in because their credit
enters obviously don't match and we will
have an invalid username and password
combination so let's go ahead and create
this if statement let's go MySQL num
rows so we're calling this function
which is going to count the amount of
rows returned by this query here so we
can type in query run there so if the
MySQL numbers are returned from the
query are greater than or equal to one
this means that the credentials match
both the username and password so we can
echo login success usually we're going
to do this at this point in here we
would process some kind of a session to
equal the ID from the database but for
now we're just using this as an example
so otherwise invalid and username
password combination combination okay
yeah so let's go ahead and try this and
with the values that we submit so I'm
going to keep this I'm going to keep
this open and I'm going to break down
again okay so let's go back and go
straight on to our next stop PHP file
let's type in Alex and a wrong password
so past four five six now we've got Alex
Alex is the username past four five six
as the password and we've returned the
message invalid username and password
combination because nowhere in our table
do we have Alex and past four five six
as the username and password so now what
we can do is we'll go and submit some
correct data so Alex and pass one two
three these are match here so we've got
Alex of the genome and password one two
three as the password click Submit and
it says login success because we've
successfully submitted the username and
password that match inside of our table
so now let's go ahead and use this
example that we used earlier by writing
a semi single quotation mark or double
quotation mark equals double quotation
mark and what this is going to do is
it's going to structure our query as we
discussed earlier and it's just going to
put into here and the password as well
that or that equals that so that's going
to go into our query and we're going to
return at more than one row
therefore the user is automatically
logged in so let's go ahead and click
Submit okay so you can see that the
username is a is a single quotation mark
or single quotation mark single
quotation mark equals single quotation
mark and the password is also that as
well and now you can see interesting and
we've got a login success here so this
is a real problem when it comes to our
user our user login system if you like
because what we've done is now anyone
can type these values in and
unfortunately they can log in as
a user when they maybe don't have access
so how can we protect against this well
I'm going to show you three different
ways now that we can protect against
this specific error for your own queries
you might need to slightly modify this
but now I'm just going to talk about
this you we can get the general idea of
how we can start to protect now the
first pop problem we look at is the is
the single quotation marks the single
quotation marks need to be escaped in
order for them not to work so for
example if we were submitting a let's go
this if we were submitting the data like
this and escaping that that that and
that let's copy and paste that into here
and we click Submit you see that we get
an invalid username password combination
so we need some way to escape the
different characters now there's
something in PHP and something in the
PHP dot ini file which I've just opened
here if you don't know how to open this
or don't know how to edit things from it
you can find a tutorial on that as well
what we have here is we have magic
quotes GPC and you can see the comment
just above it is magic quotes for
incoming get post or cookie data what
this is going to do is it's going to
escape like I've just written here and
these automatically when you submit data
so it's not foolproof because we might
not be submitting through a post or a
get or even cookie so let's go ahead and
turn this on and in a moment we're going
to turn it off and all I'm going to show
you how you can also also include this
if it's automatically say off on your
server so let's go ahead and restart
Apache from our xampp control panel so
remember every time you make a change in
your PHP to ini file you must restart
Apache okay so let's come back to our
page and wait for localhost right okay
so our our server has been restarted and
we've turned magic quotes on so now
let's go ahead and do exactly the same
thing and click Submit
now you can see that without doing
anything we've automatically now escaped
well we did do something we change the
value in PHP dot ini but what we didn't
do is change any of our code and this is
automatically given us some sort of
protection against SQL injection</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>