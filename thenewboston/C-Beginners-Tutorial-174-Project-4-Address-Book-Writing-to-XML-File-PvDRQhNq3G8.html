<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# Beginners Tutorial - 174 - Project 4 Address Book, Writing to XML File | Coder Coacher - Coaching Coders</title><meta content="C# Beginners Tutorial - 174 - Project 4 Address Book, Writing to XML File - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# Beginners Tutorial - 174 - Project 4 Address Book, Writing to XML File</b></h2><h5 class="post__date">2011-09-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/PvDRQhNq3G8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys welcome to the 174th c-sharp
tutorial that I'm making for the new
Boston and in this tutorial we're going
to continue looking in our address book
project and basically what we're going
to be doing is writing all the people to
an XML file so the first thing that
we're going to want to do here is
actually edit the code that we use to
create our XML file initially because in
here we just basically create an empty
XML file and we can't do that because we
need to have a root element so we're
actually going to need to write a new
XML file using an XML text writer to
create that root element so we're going
to say XML text writer XW equals a new
XML text writer and in here we're gonna
have to specify the path the file that
we're going to be creating so I'm just
going to go ahead and copy this path
that we already created up there and
then we're going to need to inspect
specify the encoding we're going to be
using utf-8 encoding it's basically just
a type of format for your text or the
way it's stored kind of alright and the
next thing we have to do is create a
start element or a root element so it's
going to say xw dot right start element
and I'm just going to call it people
because after all we're just going to be
storing a bunch of people inside of our
XML file or a year and then we're just
going to write the end element to write
that slash people at the bottom so I'm
going to say right here X W or our XML
text writer and then we're just going to
say rights and elements right and
element alright and we're just going to
want to close this so that we can reopen
it with a different string so it's going
to say close right here alright so now
that we have that all taken care we can
actually begin writing the people on to
our XML file and we're just going to
want to scroll down here to the UM form
closing event and we're just going to
basically want to loop through all the
people inside of this people list right
here inside of this person list and
write them to our XML file but before we
can do that we're basically going to
want to clear all the existing people
out of there
so the
don't have duplicates so we're just
going to want to select the person or
the people element or the people node
and just delete all the persons from
there so we're going to say XML
node X node equals on X doc select
single node and we're just going to want
to select um basically all the nodes
inside of this people node so it is
going to say select this people node and
we're just going to want to delete all
the person node inside this people node
we're going to say X node dot remove all
and this will just remove all the
children nodes from this people node so
if there are like a bunch of people we
have already installed inside of this
people note I'll just clear them all out
and then we can write the existing ones
or write the ones that the user hasn't
completed yet or the view it wants to
store so now we're just going to loop
through all those people let me say for
each person P in that list so inside of
that on people list then we're basically
just want to create a new node for them
and then add them to this document so
I'm going to say XML node X pop oops pop
equals x dot dot create element and
we're just going to call this person and
then inside of this person node we're
going to have all the properties inside
of this person class so their name or
email or street address etc so now we're
just going to want to create a new node
for all of those I'm just going to say
XML node X name equals x dot create
element and then their name so name and
I actually have all this already copied
or already written out so you don't have
to watch me go ahead and write all of it
so I'm going to go ahead and paste this
over here but basically we're just going
to be creating a node for every property
inside of this person class all right
and now it's time to fill these nodes up
with the text so
the information that we want to store so
we're going to say X name dot inner text
equals and then that person's name so
just going to say P dot name and then
we're going to want to do the same for
all the other properties and I already
have that written out as well so I'm
just going to go ahead and copy all this
right here all right so now set the
email the address the notes and for the
birthday we do something special we
convert it into file time which is
basically numbers or a long and then
we're going to want to convert that into
a string and then we'll read that back
later on in the next tutorial all right
and finally we want to add on all these
to this top note to this person know so
that they're all stored inside of one
person and then we're going to want to
add that person node to the actual
document inside of those people node
right here so we are going to say um X
pop dot append child so basically just
add a new node to this X top node so
we're going to be adding the name first
so X name and then we're just going to
want to do that for all these other ones
all these other properties right here so
for the email or address the notes and
their birthday and I already have that
all written out as well so I'm just
going to go ahead and copy that and
paste it right here so now we're just
adding me name the email to address the
notes and the birthday all to this
person note and then we're going to want
to add that person node to this on
people node to the actual document
itself so we're going to say X dot dot
document element dot append child and
then we're just going to want to add
that person node to the entire document
itself so just going to say X table
all right and now that we have all this
setup inside of our for each loop once
it's done going through every person we
want to actually save the XML document
so we're just going to say X dot dot
Save and now we're just we have to
provide the path to that document we
want to say
so we can just go ahead and copy this
path that we already created up here
alright so now let's just go ahead and
test it out now if we put a name in here
at um something something official notes
whatever at the contact at another
person at the contact now let me close
out should have saved that added it to
the XML document so if we go in here
open it up you see that we have Adam and
that other person in there alright so
that's pretty much it for this tutorial
so see you guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>