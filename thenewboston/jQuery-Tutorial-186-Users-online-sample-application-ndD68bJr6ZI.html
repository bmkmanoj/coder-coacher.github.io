<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>jQuery Tutorial - 186 - Users online sample application | Coder Coacher - Coaching Coders</title><meta content="jQuery Tutorial - 186 - Users online sample application - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>jQuery Tutorial - 186 - Users online sample application</b></h2><h5 class="post__date">2011-08-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ndD68bJr6ZI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">someone watching now probably noticed
that if you notice that then yeah and
that's very good but okay so let's go
ahead and take a look at the code again
then so I'm gonna refresh the page and
then to my name now you can see my names
appeared so just that semicolon making a
whole application not working you'll
notice that we've got Alex in here and
it's relayed the data back to us so now
that that functionality is complete
let's go ahead and duplicate the tab and
enter another name okay so you can see
that now in both tabs we've got Billy
and Alex and and you know the the data
is essentially being relayed out let's
go ahead and browse our table again so
okay after much debating or trying to
find out that particular error we now
have this functionality complete the
only thing we have now left to do is the
unload so we want to remove the username
from the table so what we're essentially
doing is we're we're repeating the same
process as we did here so we use exactly
the same post request but we just
changed the action obviously we still
supply the username so the username
remembers still stored up here so we can
use that to pass again and delete that
as well so we use a post HTTP request we
send two parameters to this and that is
the first one is the file
obviously users PHP and the second is
the username and then the action so
remember the username we defined as the
variable name username and we're sending
that the username and then the action
that we're sending is left so now that
we send this on the window close or the
window unload we can go ahead in here
and define our function down here or our
or add to our if statement so at the end
of this we want to say else if action is
equal to left and if the action is equal
to left we want to call the user left
function okay so let's go up and modify
the user left function or create our
user left function so the first thing we
want to do is go ahead and again
sanitize the user name because we have
the potential for SQL injection so
that's Maya sq out real escape string
and in there we'll go use the name that
we've already passed and we want to go
ahead and apply HTML in fact we don't
really need to apply HTML entities to
this in this case because we're only
deleting from the database so the query
is going to be obviously in our MySQL
query function we want to say delete
from users where username is equal to
user underscore name no not now there is
a problem here in the fact that if two
users would have the same username they
both would be deleted because we have a
query here that deletes obviously all
users with the username that's specified
so for example if I was to go ahead and
duplicate this once again and I was good
to go ahead and type in Billy again this
is fine we've now got two Billy users
however when we close this window you'll
notice that oh okay yeah so right okay
so yeah we haven't obviously created
this functionality yet but when we do
close the window when this works
we'll be deleting this username you all
user names with the same user name so
you can go ahead and in your own time
work out how you would change this if
you want to learn a bit more about about
this and test yourself so now that we've
done that we're essentially done with
that so let's go ahead and actually call
the function so the function is user
left and we supply this a user name so
simple we're now done let's go over to
our browser and we're just going to
start by closing this and deleting all
the records in the database just so we
can start from fresh and test it so
let's delete all records in there and
let's go back to the front
ok so Alex
okay so that worked properly let's
delete them yes okay so I'm gonna go
ahead and into Alex Alex is then stored
in the database and he's displayed out
on the page so we've got Alex there I'm
then going to go ahead and duplicate
this tab and I'm gonna type in Billy so
Alex and Billy now exist in the table or
the database table I'm going to
duplicate again and type Julie so we've
now got three users that appear to
everyone that's logged into this
particular page shown online now I'm
going to go ahead and delete and close
Julie's tab and open up these and you
can see that we only have the two names
remaining now that the session that
contained the variable Julie has gone it
was deleted from the database as well
because we passed it through to be
deleted using our PHP script so now I'm
gonna go ahead and close this Billy one
and you'll see that we have just left
with Alex so overall this is a really
good concept to get to grips with with
regards to jquery's you know unload
functionality and there and the
document.ready functionality where you
can go ahead and actually use HTTP
requests again in jQuery I didn't you
know I tried not to base this too much
around PHP but we set an interval which
isn't a jQuery function but it does the
job and inside here we send data so
we're sending data in three different
instances so if you haven't ever you
know if you've felt uncomfortable with
HTTP requests in jQuery then you should
have learnt quite a bit about this we've
passed a couple of variables here one
variable here and most importantly we've
kept everything inside one users dot PHP
file which is extremely important with
regards to file handling or your file
and you know ensures that we don't have
too many files with too many requests so
we've kept it all nice and neat and tidy
and obviously using this concept you can
go ahead and expand and create something
that you know works more like a chat
system if it's database base
it's usually you know quite
straightforward like this code has been
quite straightforward and you can
usually usually achieve a really nice
effect using these combinations so that
was a quick demonstration or quite a
long demonstration of quite a basic you
know ability to store and display to
different users depending where and
where they're logged in and what they
have typed</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>