<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>AJAX Chat Tutorial - 9 - Getting Messages for New Users | Coder Coacher - Coaching Coders</title><meta content="AJAX Chat Tutorial - 9 - Getting Messages for New Users - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>AJAX Chat Tutorial - 9 - Getting Messages for New Users</b></h2><h5 class="post__date">2013-05-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Usvwj-p7XFA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right sorry guys my frickin dog was
barking and messing up my video and I
got kind of lost but anyways what I did
is I pretty much just typed out this
whole query because um it's easier for
me to explain if I just go ahead and
type it out first rather than trying to
type in explain at the same time but
anyways
whenever the user first enters the
chatroom and there's already a history
of people chatting then here is what you
want to do in everyday terms before I
talk about the code what you want to do
is you want to get the last or the most
recent 50 messages now once you get
those you want to display them to the
user so they you know have a little idea
of what the heck people were talking
about so the first thing you want to do
is you want to say okay
I want to get the most recent 50
messages so you pretty much build a
query like this one up here but you get
the most recent 50 messages by saying
okay descending which means get the
message ID which pretty much zero is the
oldest one and the higher the number is
the newest one or the most recent one so
that's why you do descending from high
to low which means most recent to hold
the last 50 so what this does this
little statement is it returns a table
with the most recent messages the 50
most recent messages so now what we're
going to do is we're going to select all
of the information that we need and
instead of saying from chat like we did
up here what we can do is we can
actually say from these results so
there's a those are two different ways
any if you guys don't know about this
then watch my MySQL tutorials and I'll
you know you'll understand what this
means so you're gonna select that as
last 50 and you're gonna order those
results ascending from new from excuse
me from old to new so whenever you get
the messages you want to get the most
recent messages but whenever you display
them just like before like in every
single chat room or instant messenger
you want your oldest ones at the top and
then your new ones are at the bottom
so that's what we're doing so basically
in every day language this is what we
did we built two queries the first query
was to retrieve only the new messages
and that's if you've been in the chat
room chatting for a while now as soon as
you enter the chat room the very first
time you want to load only the 50 most
recent messages so that's what this
query does right now so now we have two
different queries built but how do we
display it on the screen well this is
very simple
basically we execute it and I don't
I didn't mean display I mean execute it
so else what this does right here is it
executes the proper query so if you've
been chatting for a while then you're
gonna have this query if you just
entered the room you're gonna have this
query but this line executes the proper
query and you guys are thinking all
right so that's pretty cool that's how
you get new messages function complete
right not exactly because this is indeed
ajax adjacent JavaScript and XML so what
we need to do now is we need to build
the XML response because remember this
PHP file this is gonna be sitting on
your server and it's gonna be waiting
for the user to call it and whenever the
user calls it it's the job of this PHP
file to send back an XML file basically
an XML response so it's gonna be sent
back whenever the user wants to get new
messages so right after this result what
we want to do is we want to start
building the XML response and now in the
next video what we're gonna be doing is
I'm gonna show you guys how to format
the XML file to send it back to the user
and then the user is gonna interpret it
and you know pretty much pick out off
the data and display it in their chat
room but for now thank you guys for
watching don't forget to subscribe and I
will see you guys in the next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>