<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Stock Market Analyzer - 14 - Starting to Crunch the Numbers | Coder Coacher - Coaching Coders</title><meta content="PHP Stock Market Analyzer - 14 - Starting to Crunch the Numbers - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Stock Market Analyzer - 14 - Starting to Crunch the Numbers</b></h2><h5 class="post__date">2012-01-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/AEgC1_Kcojs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright guys so welcome to your
fourteenth tutorial and let's go ahead
and start crunching some numbers so like
I said what this is gonna do is
basically tell us how likely a stock is
to go up or down based on history so the
first company we're gonna be looping
through is Yahoo now say we were looking
at the last month of Yahoo's data and we
see that Yahoo went down let's say they
were like 10 days where Yahoo dropped in
price well that's a critical piece of
information but what we are worried
about is the following day what is it
likely to do so we'll say of those 10
days where it went down in price maybe
the following day it went up 8 times and
down twice so based on history the next
time Yahoo drops in price it may be a
good idea to buy it since it's 80%
likely to go up 20% likely to go down
based on historical data so you know the
saying is that the best indicator of the
future is history or something like that
you know it's a little more clever
sounding than that but you know I don't
know what exactly so let me go ahead and
stick to what I'm good at
not sayings but actually programming and
we'll make some variables we'll count
the number of days that the stock goes
up down and we'll also keep track of how
many days it doesn't change at all
so next day increase and we'll go ahead
and set this to 0 by default and I'm
just go ahead and copy this bad boy next
day decrease so basically we're gonna
loop through all the data and every time
it goes up a day we'll add one to this
every time it goes down today we'll add
1 to next day decrease so of course
they're at 0 by default and in some rare
cases it doesn't happen often but next
day no change it doesn't change at all
so equals 0
so now what we want to do is we actually
want to not only keep track of these
numbers but we want a total of all the
days so and the reason we want this is
because whenever we're trying to figure
out a verage is later on let's say over
the month a stock went up 10 days well
that's nice but is that you know 60% or
forty percent we don't know so that's
why we need to total to figure out the
averages and another thing that I want
to do is I'm gonna be keeping a sum of
all the increases and decreases and this
is just going to be used for averages
later on too so some of increases and
we'll set it equal to zero
and we also want uh some of the friggin
decreases so some of decreases it sounds
like a weird word like you're trying to
get creases out of creases out of
something if I when I'm old I'm hope
someone decreases my face get it that's
a little joke but anyways let me go
ahead and the next thing we want to do
is we want to run a query now what this
query is going to be responsible for is
we want to say okay select all of the
days where the price of the stock has
dropped well how do we do that let me
just go ahead and store it in a string
called SQL seems to be the you know
popular one around here nowadays and
what I'm gonna do is first of all put
these little things and I want to select
see the only thing we really need is we
want to select the date and the percent
change we can also do a Mount change
sorry my freaking cough coming back up
because check this out we don't need
open and close and we don't need to
figure out all that because whenever
percent change is a less than 0 then we
know that it went down we only we're not
determining how much it goes down we're
only looking for the days it went down
so it doesn't matter the amount change
as long as it's less than zero then that
means that that day and went down so
I'll show you guys what I'm talking
about so we want to select the date and
the percent change from and in order to
select it from a company just do this
for the company ticker remember we've
got this in less tutorial we want to pop
it right in there and it's going to
select it from a table because whenever
we built these the tape
were the exact same names is the company
ticker so that is why we can just say
select 8% change from company ticker and
basically all of these not our only
aren't only weird on say names of
companies but they're also table names
so that's why I did that and so how can
we phrase this where percent change is
gray or excuse me is less than zero
I was about to press o on my keyboard
and we want to order by date ASC
ascending and I already have one of
those so basically we're saying okay
select the date and percent change from
Yahoo where the price or excuse me the
percent change is less than zero in
other words in everyday terms select all
the days where the stock price went down
order by date ascending so now with that
query what we need to do is actually run
it so let me just go ahead and do that
right now I'll move this so you guys can
see a little bit easier and I'm gonna
store it in a variable called result now
in order to do this of course you need
my SQL underscore query because this is
a function that actually runs the query
what query do you want to run how about
this one right here so now with that
being said what result is gonna do is
it's going to give you true if this
query ran successfully and it's gonna
give you false if it ran and
unsuccessfully now I want to say this
before I move on because a lot of people
seem to have problems with this this
isn't going to be false if it returns a
result of 0 it's only gonna be false if
your query is messed up somehow so a
result set of 0 is a valid result set so
it would still be true in that case so
don't get a result set of 0 which means
you have no you know maybe this didn't
go down any days so my result set would
be 0
this wouldn't be false in that case it
would just be our empty result set so
remember a lot of people get that
confused I just want to mention that so
what we're gonna be doing now is test if
this result in other words this query
ran properly and if it did then we have
successfully found all of the days from
a certain company where the price
dropped so now like I said what we want
to be focused on is getting the next
day's worth of data so I'm gonna be
showing you guys whenever you have a
results set how to get the next row and
it's actually more complicated than you
guys think so stay tuned for that and
again I want to mention that I'm going
to be taking all this code and posting
it on my forum so if you guys you know
don't want to hear me babble on you just
want to jump to the code then go ahead
it's all for free so thank you guys for
watching don't forget subscribe and I'll
see you guys then</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>