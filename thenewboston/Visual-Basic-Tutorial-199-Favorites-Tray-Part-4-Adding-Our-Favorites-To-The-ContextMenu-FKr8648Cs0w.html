<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Visual Basic Tutorial - 199 - Favorites Tray Part 4   Adding Our Favorites To The ContextMenu | Coder Coacher - Coaching Coders</title><meta content="Visual Basic Tutorial - 199 - Favorites Tray Part 4   Adding Our Favorites To The ContextMenu - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Visual Basic Tutorial - 199 - Favorites Tray Part 4   Adding Our Favorites To The ContextMenu</b></h2><h5 class="post__date">2011-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FKr8648Cs0w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello YouTube sam here from youtube.com
slash on live gamer for the new Boston
and in this tutorial we're gonna be
working more on our favorites viewer for
the tray so before we get started I just
want to give full credit to the author
set of beginning Microsoft Visual Basic
2008 by fear and Willis and Brian
Newsome they created this app and I'm
using it to teach you guys how to make
it and some concepts from Visual Basic
okay so now all we need to do after
we've created our favorites and we've
scanned to the favorites and sort it in
the collection that is inside of this
favorites object and we created a
context menu which would be like this
whole menu right here so we created this
and the context menu so now I need to
process each favorite so we can use a
for each loop so for each object web
favorite as web favorite and what we
need to do is when you type internet
favorites dot web favorite and then
we're going to do in favorites dot
favorites collection so for each of the
web favorite objects that are in the
collection that are stored in this
favorite class what we want to do is
women we want to add those to the menu
so we will declare object item as a new
web favorite menu item so this is going
to create an item with the name and it
will allow us to click on that to open
the URL so for the constructor we're
going to use object web favorite because
it takes a web favorite so it's going to
use our object web favorite that is in
the list of our favorites favorite
object so it's it's going to go through
each of the web favorites in this
collection and it's going to create a
new menu item based on the web favorite
that is given so what do we want to do
with that menu item well we want to add
it to the context menu
so we'll do object menu item
for object menu dot menu items dot add
and will add object item so what this is
doing is it uses our object menu object
which is a context menu and it's gonna
add a menu item to it so dot menu items
dot and so we're telling you we're gonna
add an item and we want to add object
item so object item is a web favorite
menu item and it uses the web favorite
that is in the collection of scan
favorites now it's going to do this for
each of those favorites so each time is
going to add it with the new favorite
the new menu item based on each favorite
in the list so now what we need to do is
we need to separate it from the exit so
we'll just type object menu dot menu
items dot add and when we add this right
here it's going to add a separator in
between our each of our favorites right
here and then there's nothing under it
so what we need to do is we need to add
that so we'll type object menu dot menu
items don't add and we want to create a
new instance of our exit menu item so
instead of having to create a whole new
object for exit menu item even though
we're only gonna be using it once we can
just skip declaring it and we just
create a new exit menu item inside the
arguments of the menu items now whenever
we add a menu item to a context menu we
have to give it something that inherits
from menu item or else that will not
work so come back to form one VB and
underneath this we need to tell our tray
icon to use this context menu so that
when it's right clicked
it's going to use the menu so we'll just
say icon notify dot context menu is
going to be equal to our object menu and
so let's create a boolean and we'll call
it Valene load
called and we'll set it equal to true
right here now you can see we get an
error because that's not declared yet so
we'll come up here and we'll just say
private boo lien load calm as bullying
and we'll set it equal to false so
basically what this does is it's going
to be equal to false and then once all
of these processes are done it's going
to set it equal to true and then we'll
just type me dot hide so it'll hide the
form and it will only show the icon so
I'll come down here to this form one
visible change and what we'll do is
we'll only have a change to visible
equal to two false if all of this has
already processed
so if button load I mean if boolean load
called I'm is equal to false then we'll
just get out of the sub so if the lien
load called is equal to false then we
don't want to change anything so we'll
just type exit sub now in the book it
says to type return and that will also
work the same way so return in exit sub
will both get us out of the Sun and it
won't run any of this code right here so
we'll just use return right there so now
let's go ahead and we will run our
program and you can't see anything but
if we come down here and let's look at
my tray you can see that we have our
favorites icon and it says right click
for favorites so if I right click you
see we have Gmail the new Boston and
YouTube and this little bubble right
here
it's from my tutorial timer that I
created for each of these so we can open
one of these so let's open the new
Boston you can see here that it opens it
up in my default web browser</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>