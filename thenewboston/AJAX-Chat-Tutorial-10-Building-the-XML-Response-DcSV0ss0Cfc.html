<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>AJAX Chat Tutorial - 10 - Building the XML Response | Coder Coacher - Coaching Coders</title><meta content="AJAX Chat Tutorial - 10 - Building the XML Response - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>AJAX Chat Tutorial - 10 - Building the XML Response</b></h2><h5 class="post__date">2013-05-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/DcSV0ss0Cfc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright guys welcome to your tenth video
and in this video we are going to be
building the XML response now remember
this is the response that the server
sends back to the client so basically
your user chatting on your computer
you're gonna ask the server for any new
messages and once it you know queries
the database and gets all those messages
it's gonna format it in this XML
response and send them back to you so
what we're gonna do is we're just gonna
store everything in a variable called a
response and the first thing we want to
do is just you know do our proper
formatting so that's this question mark
XML and this is where I got to be
careful type everything version equals
1.0 and this is make some space here
this is basically what you have at the
beginning of everything
encoding equals utf-8 utf-16 and
stand-alone equals yes because I am
standing alone in my room right now I
don't have any friends so that's why you
need that and let make sure that this is
like the part I don't want to mess up
version 1.0 encoding utf-8 standalone
equals yes and of course you need a
semicolon at the end now this of course
is the very beginning but we have to
send more information so what we're
going to do is we're actually going to
use the same variable couldn't even find
the nevermind and we're gonna add a
bunch of information onto it and by the
end the variable is going to be an
entire XML file so this is the beginning
and the first thing we want to add is
that parent element
so basically everything is going to go
in between this response tag so let's go
ahead and end that now the very first
thing we want to add to this XML file
actually what we can do is I'll show you
guys how I'm going to format this now
basically we're going to be adding a
bunch of stuff into this XML file or
variable as it is right now
so it's going to start with a response
tag and it's going to end with their
response bag response bag what the hell
okay what the heck is I should more
properly say in this educational
tutorial and at the end what we're gonna
do is we're just gonna return this whole
whole not hor wow I just have dirty crap
on my mind today I guess response
variable and in between is very Paulo
the information and if you're wondering
are right what's the information the
information is basically whenever we
asked database to return all the
messages it it just doesn't return you
know ten different you know pieces of
information each message has a bunch of
information along with it for example
the message ID the username the message
itself the color of the time so what we
need to do is we need to build a loop
that's going to loop through all those
messages real quick in return each of
those as a separate element in between
this main parent response tag so let's
go ahead and give us some space and
actually before we build the loop
there's a cool little thing that I want
to show you guys and that is this if you
copy this and paste there right here
what you want to do is you want to go
ahead and add something this arrow and
we're gonna be building a quick function
that says is database should I put yeah
just put database cleared
and we're gonna be passing in the ID now
what this is going to do and of course
we didn't build this function yet but
it's basically going to give you a clear
flag and what a clear flag is I'll just
write it in plain text right now is it's
going to be tags that looks like look
like this and it's either gonna have the
value true or false it's going to be
true if the database was cleared which
basically means do you have basically um
where are the messages that you want to
start from or if the database is clear
that means that all the messages were
wiped out there that's a very simple
explanation so that's the first thing we
want to tell it and now what we can do
is we want to build a loop saying all of
the messages that we want loop through
them and add them to the XML file so the
first thing we want to do before we
start looping through messages is we
want to check is there any messages to
loop through so how do we do that well
we just make a very simple if statement
and for the condition what we want to
check is result and remember we already
have this result variable right here
which basically queried the database and
got any new messages so this is our
result now the result can either be 0 if
there are no new messages or a number
like you know one a hundred a thousand
if we have or 50 I guess if we have new
messages so let's go ahead and check for
how many rows are returned using the
built-in num rows so basically if this
is zero then it's gonna be false don't
even worry about looping through the
messages because you don't have any if
it's anything other than 0 from 1 to you
know 50 then it's going to loop through
those messages and that's what we're
gonna do right now so how do we loop
through the messages so what let me go
back
so this basically only runs if you have
new messages so let's go ahead and loop
through them so while is the best way
that we can loop through these messages
now the condition for this while loop is</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>