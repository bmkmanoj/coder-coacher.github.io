<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Visual Basic Tutorial - 153 - Game Part 9   Enemy Attacks Back | Coder Coacher - Coaching Coders</title><meta content="Visual Basic Tutorial - 153 - Game Part 9   Enemy Attacks Back - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Visual Basic Tutorial - 153 - Game Part 9   Enemy Attacks Back</b></h2><h5 class="post__date">2011-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/99lHfk2mxyM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello YouTube sam here from youtube.com
slash on live gamer for the new Boston
and in this tutorial we're going to be
continuing working on the game
so whenever the timer ticks that is used
to delay the attack what we want to do
is call enemy attack now we haven't
created this sub yet so let's go ahead
and come down here we'll type private
sub enemy attack so whenever they attack
what we want to do is type current enemy
dot attack so you may be wondering if
you already typed this code in why this
hasn't shown up well the reason is
because I went into each one of these
classes and change the attack names or
the names of the subs to just attack
instead of say zombie attack or villain
attack so go ahead
ignore the overloads that I have there
let's see so change each one of those to
attack and then come back in to form one
DB so current enemy dot attack and then
after we do that what we want to do is
update the progress bar so progress bar
Popeye dot value is going to be equal to
hero dot now you can see that we're
getting an error right here that's
because we need to reference user health
as integer so we'll just type hero
health so that we can access the
property health now all we need to do is
enclose this in a try block so we will
try to set the value to the current
health of Popeye and if it's below zero
it will throw an error and we'll be
ready to catch that error so if that
happens what we want to do is type
message box dot Show Popeye has
and then we will type here o dot health
equals 100 so it pretty much responds
him and then we need to set progress bar
pop I dot value equals 0 dot health so
we'll update the progress bar and then
after all this has done what we need to
do is stop the timer
so timer delay dot stop and then the
timer will be started back up again when
they click attack now in order for us to
use this attack method right here it may
be different for each one of the enemies
and it will be different so we've got a
default attack inside of enemy
it says attack it used to be default
attack but I changed it to attack so if
we just just leave this the way it is
it's going to always call the attack
that's used in enemy because we declared
current enemy of type enemy so what we
need to do is come into our enemy DB
class and we need to come into public
sub attack and we need to make it over
writable so now we can override the
attack sub in each one of our classes
that inherits from enemy so we'll open
up dragon and we need to type overrides
so this attack overrides to the one an
enemy and we'll do that for each one of
these so that it uses the appropriate
attack sub each time we call it whenever
the villain attacks so public overrides
and let's come down here and see what
our error is uh-huh so let's make that
usual health- equals 8 so we'll minimize
out of this let's go ahead and come into
form 1 and we will run this and
hopefully everything will work fine so
we can go ahead and attack it takes away
some health and then a second later he
attacks us we can attack again takes
away some health and then he attacks us
we can use spinach and then he attack
that's again and then each time it will
attack so we can attack one more time
he'll attack back and then the last time
it says Popeye as one and it spawns a
new enemy
now Popeye barely has any health left so
if we attack the enemy the enemy attacks
us you can see that Popeye dies and we
have created an infinite loop so what we
need to do is to find out where this is
so we'll just copy this right here and
we'll stop the timer before this has
done okay so now let's go ahead let's
make Popeye lose on the first try so
we'll come into the zombie and whenever
he eats brains Popeye will lose 50 so
we'll open this up and let's spawn an
enemy until we get a zombie so here's
our zombie we will attack the zombie and
then the autonomy I'm the autonomy the
zombie will attack back we can attack
again and let's wait until it gets the
eat brain so you can see that a whole
bunch goes away there we can attack
again and you see that Popeye loses and
Popeye responds so in order to make this
look a little bit better let's come back
into form on BB and whenever he attacks
let's go ahead and update this to zero
so before it shows the message box we
will type progress for our Popeye dot
value equals zero so that the user will
see the value and know that he is dead
so then we'll come over here to button
attack and we'll do that for this tomb
so if it's below zero then progress bar
enemy thought value equals zero so that
they know that the enemy has died so
let's go ahead and run this and let's
spawn another enemy so we got a villain
we can spawn a zombie let's fight a
dragon so we can click attack and in a
second later
is it taxed back and then we can keep
fighting this dragon and then hopefully
we will win and you see that says Popeye
has one and it spawns a new enemy so go
ahead put this code in if you have it
it'll help you learn a lot faster if
you're actually putting the code in and
editing it yourself and then once you've
done that go ahead and move on to the
next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>