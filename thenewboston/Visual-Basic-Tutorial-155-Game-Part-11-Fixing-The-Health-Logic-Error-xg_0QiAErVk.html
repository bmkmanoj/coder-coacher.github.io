<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Visual Basic Tutorial - 155 - Game Part 11   Fixing The Health Logic Error | Coder Coacher - Coaching Coders</title><meta content="Visual Basic Tutorial - 155 - Game Part 11   Fixing The Health Logic Error - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Visual Basic Tutorial - 155 - Game Part 11   Fixing The Health Logic Error</b></h2><h5 class="post__date">2011-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/xg_0QiAErVk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello youtube sam here from youtube.com
slash on live gamer for the new boston
and in this tutorial we're going to
continue working on our game now if you
remember from the previous tutorial we
added the health monitor at the bottom
so that the user can see the current
health of their enemy and popeye so that
they don't just have to rely on the
progress bar they can see a little bit
more precise amount but if you remember
if the health gets down to zero which
would technically mean that Popeye is
dead it will not say that he's dead
because Popeye I mean the value of a
progress bar can be set to zero without
an error occurring so what we can do is
whenever the enemy attacks it's going to
try to update the Popeye health so we'll
come down here to update Popeye health
and it's going to set the value to the
hero health and so what we're going to
do is we will type if he wrote health
equals zero then what we want to do we
want to throw a new exception so if it's
equal to zero we're just going to throw
our own exception because this will not
actually I'm create an exception itself
so we're going to throw our own and this
try statement is going to catch that
exception and it's going to set the
value to zero and say the popeyes lost
so the pop I cannot still be alive with
zero hell now you can see here that
whenever we set the hero health to 100
if we're actually using a number here so
if we ever wanted to go through and
change the starting health of the hero
we'd have to go and find every single
instance of 100 and change it manually
so what we can do is go into Popeye and
now these things that I'm showing you
guys they may seem like I'm
in the program but what you got to learn
is that you got to think through things
that you can make your code better or
make it easier for the user to use your
program you just got to think about
those things that be able to find them
and hopefully you guys are learning how
to do this as we go through these
tutorials so we'll come over here and
when we will create a variable so we'll
make it public and shared because it's
going to be the same for all popeyes and
we don't want to waste memory by
creating multiple instances of it and
we'll just call it start health as
integer and we'll set it equal to let's
just keep pop by 250 health because
heroes always have more health than
their enemies and then the int health
when the object when pop is created will
set into health equal to start health
okay so now we have our start health
that we created so come back into form
or not vb and we want to set here about
health to hero dot start health so it's
going to set it back to the default
starting health let's see here oh yes
and because we're using a shared
variable what we're going to need to do
is type popeye not start health because
it's shed and it's the same through all
popeye objects we're just going to use
popeye here instead of our single object
so come down here to update popeye
health let's just make sure everything's
okay so now we can do is we can do that
for the enemy now because all of these
other classes inherit from enemy we only
need to make it once so we'll come down
here and we'll say
public and I got to zoom in some so
public shared and we will do start
health as integer and we'll give our
enemies 100 health and then whenever the
constructor is created for our enemy we
can just set the int health equal to
start health so this uses in direction
so that we cannot will need to change
one value to change a whole bunch of
values in our program so let me just fix
this here it's not what I wanted we'll
put it up here in the top okay so we'll
come back to form one BB and whenever we
update the enemy health let's just make
sure everything's okay okay so under
button attack what we want to do is
we've got our spinach so progress bar
intermediate values going to be equal to
zero okay so we need to go to generate
enemy so whenever we generate the enemy
what we want to do is set the progress
bar so we've got progress of our enemy
dot value equals current animal health
so we can just set that to default
health or start health
and because we are using a shared
variable we need to make this enemy dot
start health let's see here aha we need
to import the enemy's library so that we
can use that so now that we've imported
the enemy's library we do not need this
right here so we can just go ahead and
remove that so we've got enemy dot star
health and we'll do that for each one of
these so we'll just type enemy dot start
health and then enemy dot start health
okay so see here everything seems to be
working fine so let's go ahead and run
this
and we can attack
okay sorry about right sorry about that
right there actually had an error which
was a simple fix you just need to come
over here to your form one select the
progress bar under popeye and you need
to set the maximum to 250 which is the
maximum health that pop i can have so
we'll go ahead and run this we're going
to attack you can see pop I guess attack
back we can use spinach and everything
works the way you would think and if
Popeye self gets to zero then it will
say that he's dead because it throws a
new exception go ahead put this code in
if you already haven't you can change
stuff around if you want make it look a
little better at stuff and then once
you've done that go ahead and move on to
the next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>