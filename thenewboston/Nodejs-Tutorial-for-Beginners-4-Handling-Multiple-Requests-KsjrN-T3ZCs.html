<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Node.js Tutorial for Beginners - 4 - Handling Multiple Requests | Coder Coacher - Coaching Coders</title><meta content="Node.js Tutorial for Beginners - 4 - Handling Multiple Requests - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/thenewboston/">thenewboston</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Node.js Tutorial for Beginners - 4 - Handling Multiple Requests</b></h2><h5 class="post__date">2015-03-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/KsjrN-T3ZCs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright guys listen up it is story time
and yes if you're wondering this story
is 100% true do not question it I assure
you that this all really happened all
right so a while ago I used to have a
restaurant and this restaurant was
actually really popular because I had
this Ausmus chef right here this guy
name is chef database now chef database
is awesome because he can cook an egg in
five seconds that's actually the only
thing my restaurant sold eggs again
don't question this all right so I had
two employees chef database cooking eggs
in five seconds and I also hired a
server so she was responsible for taking
orders from the customers so we opened
up our first day and pretty much this is
how it went the server was ready to take
orders and this girl first of all why
does this girl look so sad I don't know
who she uh you know maybe her boyfriend
broke something I don't know but anyway
she was like I'll take one egg please
and then my server was like okay hey
chef DB we need one egg so he waits five
seconds one two three four five and when
it's done the server brings the egg to
the customer boom you're good to go
so she got her egg she's at the door
next customer is this little boy so this
little boys like hey we take one of the
eggs and my servers like you talk funny
whatever dude all right chef need one
more egg all right that'll be five
seconds one two three four five all
right you little turd here is your egg
he's happy whatever see you later so day
two rolls around and obviously my
restaurant is getting pretty popular
because who doesn't love delicious eggs
and I realize that I need to get these
customers their orders faster you're
getting a little upset that their orders
are taking too long even though my eggs
are delicious so I'm like what the heck
am I supposed to do
my grandma's like Oh buggy why don't you
just hire some more servers my grandma
please shut up listen I sell eggs for a
living this is my restaurant do you
think I'm rich I can't afford more
servers so I need to find a better way
or a faster way to get these customers
their order so I'm like you know what
where is the flaw in my business plan
well check it out whenever a customer
places an order from the server this
server walks over tells the chef and he
starts cooking the egg now while he's
cooking the egg this server like a lazy
bum is just sitting there doing nothing
filing her nails checking her iPhone
whatever now
I come up with an idea that says you
know what why don't we manage it this
way why doesn't the server take the
orders tell the chef to start cooking
the egg and then what she can do instead
of standing around she can take another
order from say the boy and then she can
tell the chef to start cooking another
egg and boom check it out so again my
server has no point of standing here
taking one order at a time in waiting
five seconds to go back and take another
order chef doesn't need her so instead
what we start doing is that your order
okay she placed her order what about you
little boy what's your order Oh an egg
too obviously cuz it's he it's the only
thing we sell I guess I you know she
really doesn't need to be asking what
they want to eat but whatever and she
does the same thing for the priest so
she just took three orders went back
back back now the chef is cooking three
eggs at a time and instead of standing
there waiting for one egg to be done at
a time she just tells the chef hey chef
database whenever those eggs are done
just let me know just give me a heads up
and I'll come back and get them so one
two three four five yo server all the
eggs are done boom there you go so now
instead of
taking 15 seconds for three customers
she can take orders immediately and the
chef can cook all the eggs at once and
they each get their eggs in five seconds
what if I had 30 customers doesn't
matter they all get their eggs in five
seconds instead of 150 pretty cool my
server is staying busy the whole time
I don't spend extra money on extra
servers and it's a much more efficient
way of doing things now believe it or
not that story has absolutely nothing to
do with nodejs or programming just
thought it was a pretty cool story to
tell so thank you guys for watching
actually I'm kidding of course the
reason that I told you guys that story
is pretty much the reason that nodejs is
becoming so popular
as you can see whenever you're making
some kind of web app that has to deal
with a real-time data in pretty much
applications where speed is important
and B applications like social networks
where you have a lot of requests coming
in at once no js' is incredibly fast and
efficient so instead of just talking
about those eggs let's go ahead and
start learning how this is done in code
now of course whenever we're making a
website or a social network we obviously
aren't cooking eggs that time consuming
operation that five seconds it talks for
that chef to cook an egg this would be
something like querying a database now
querying a database in having the
database calculate all that stuff of
course takes some time
so if you had a bunch of people trying
to connect your website in every single
client had to wait for the other client
before them to get done obviously it
would be a horrible experience your
website would be really slow and people
would never come back so instead if we
set it up like nodejs we'll be golden
all right so I'm going to have two
functions in here my first function it's
just going to be called place and order
so this we're just going to pass in an
order number so we can keep track of
everything so this is pretty much going
to resemble a user trying to connect to
your website to I don't know like query
database gets
kind of data they want to place in order
they want to get data from your website
so inside here the first thing I'm just
going to make is little indicator so we
can see in the log that this was
actually called so I'll pull a customer
order and then we'll print out their
order number so again we're going to be
calling this function like I know it
doesn't really matter will say like six
or seven times so every time we call it
it'll say customer the heck do you hear
that there's like a random motorcycle
driving out alright so anyways every
time we call this it's going to say
customer order one customer to customer
three so on and so forth
simple enough now after we print out the
little indicator saying that this
function was called we need to call one
more function and this is going to
resemble querying the database in other
words the example we saw will say cook
and deliver food now this is going to
take one parameter called a callback and
let me just say this I'll be like
simulate a five operation alright so
this function right here would resemble
something like connecting to your dad
base some time consuming operation so
inside here I'm going to write one piece
of code and that is set timeout and of
course it takes the callback and just
have some time from like 1,000 to 10,000
if I put 5,000 here just means five
seconds so what the heck is this so
again obviously we don't really have a
data base to connect to but what's going
to happen is after five seconds it's
gonna throw your callback what the heck
is a callback you know in our example
whenever we had the server and she went
and she gave the order to the chef and
instead of just standing there like a
lazy bum like she was doing the first
she was just like hey chef call me back
whenever the eggs are ready and that way
I can go
do something out something useful
something productive so I'm going to
give you my order go do something else
just call me back whenever that's ready
much more efficient and that's what this
callback is it's a bit of code that's
going to run whenever you're 5 seconds
is up and you guys are going to see in
like half a second what's going on
alright so obviously whenever a user
places an order we're just going to
print something out and then we're going
to call cook and deliver food so cook
and a little food so the reason that I
had to explain in the last tutorial that
you can actually have functions and pass
them in as parameters to other functions
is this this callback is essentially a
bit of code that we want to run after
five seconds so we can actually put an
anonymous function in here function and
run some bit of code so after the food
is cooked and delivered we're just going
to say console dot log and we'll just
log out something like I don't know
delivered food um order and then we will
put the order number so again if you
don't quite understand exactly what's
going on then give me one second and I
promise you will by the end of this
video all right so now we have to do is
just place a whole bunch of orders and
I'll just put like a simulates a like
user's arm like web requests all right
so place an order one and just copy this
a bunch of times we'll say like five or
six times two three four five six all
right so again this is just going to
simulate five or excuse me six different
users trying to place orders trying to
connect your database or your website at
a time now let's run this and see what
happens all right all of their orders
are placed they all want data five
seconds later
look at that so check it out
querying the database takes five seconds
nothing we can do about that it's just a
database it crunches numbers some things
take time however we had a bunch of
users trying to connect to our database
and instead of taking five seconds
waiting for the next one five seconds we
could process all of the requests at the
exact same time and then send back all
of their data in five seconds so every
single user was getting the best
possible experience now at first you
might look at this program and you start
scratching your head because something
doesn't look quite right you see we know
that computer programs run top down in
other words this line of code is going
to complete and then once it's done it's
going to run this line of code once
that's done it's going to run this this
this in this so how is it that when we
run this program essentially it looks
like all of these are printing out like
a millisecond after another
because whenever user places order
here's what's happened it prints out
this as we know nothing new and then it
hops down and it pretty much starts
requesting data from the database now
this process takes five seconds alright
so if that's still going on in this line
of code didn't get done yet then why are
we able to hop down to two then three
then four then five aren't we still
waiting five seconds for the database to
be dealt with well that's what confuses
a lot of people and that's what I want
to clear up this line of code set
timeout it's not saying wait five
seconds pause the program stop the
program for five seconds and then once
you're done call back the callback
method which just says deliver food
what's happening in this set timeout
method is this what you're doing is
you're scheduling this callback or this
bit of code to run in five seconds now
just to make that schedule it doesn't
take five seconds it's instant so you're
just saying hey database do your thing
do whatever you got to do however long
it takes when you're done with that call
me back in the meantime I'm going to go
on and continue with the rest of the
program so do your thing I'm going to go
on handle some more users and then when
you're done after five seconds or
whatever long operation you take just
call back this function so again you're
not getting this line of code or point
in your program and pausing before going
on to the rest of the program you're
setting a schedule so again I know it
confuses a lot of people but hopefully I
was able to explain it if you have any
questions at all about anything or if
this seems kind of fuzzy right now I am
certain in the upcoming tutorials that
you guys are going to catch on this
concept real quick also if you have
questions about anything specific then
you can just ask me I'm gonna forum
there are a lot of people there willing
and able to help and lastly if you want
any of the source code from this
tutorial or any of my future tutorials
I'm going to be putting it on my github
for free there you go so yeah thing guys
for watching don't forget to subscribe
and I'll see you guys next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>